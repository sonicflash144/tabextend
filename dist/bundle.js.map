{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://tabextend/./node_modules/dayjs/dayjs.min.js","webpack://tabextend/./node_modules/dayjs/plugin/quarterOfYear.js","webpack://tabextend/webpack/bootstrap","webpack://tabextend/./node_modules/chrono-node/dist/esm/types.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/utils/dayjs.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/timezone.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/results.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/utils/pattern.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/calculation/years.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/constants.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/parsers/AbstractParserWithWordBoundary.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENTimeUnitWithinFormatParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENMonthNameLittleEndianParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENMonthNameMiddleEndianParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENMonthNameParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENYearMonthDayParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENSlashMonthFormatParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/parsers/AbstractTimeExpressionParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENTimeExpressionParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/utils/timeunits.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENTimeUnitAgoFormatParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENTimeUnitLaterFormatParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/abstractRefiners.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/refiners/AbstractMergeDateRangeRefiner.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/refiners/ENMergeDateRangeRefiner.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/calculation/mergingCalculation.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/refiners/AbstractMergeDateTimeRefiner.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/refiners/ENMergeDateTimeRefiner.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/refiners/ExtractTimezoneAbbrRefiner.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/refiners/ExtractTimezoneOffsetRefiner.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/refiners/OverlapRemovalRefiner.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/refiners/ForwardDateRefiner.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/refiners/UnlikelyFormatFilter.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/parsers/ISOFormatParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/refiners/MergeWeekdayComponentRefiner.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/casualReferences.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENCasualDateParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENCasualTimeParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/calculation/weekdays.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENWeekdayParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENRelativeDateFormatParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/common/parsers/SlashDateFormatParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/parsers/ENTimeUnitCasualRelativeFormatParser.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/refiners/ENMergeRelativeAfterDateRefiner.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/refiners/ENMergeRelativeFollowByDateRefiner.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/refiners/ENExtractYearSuffixRefiner.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/locales/en/configuration.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/configurations.js","webpack://tabextend/./node_modules/chrono-node/dist/esm/chrono.js","webpack://tabextend/./node_modules/emoji-picker-element/database.js","webpack://tabextend/./node_modules/emoji-picker-element/picker.js","webpack://tabextend/./newtab.js"],"sourcesContent":["!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).dayjs=e()}(this,(function(){\"use strict\";var t=1e3,e=6e4,n=36e5,r=\"millisecond\",i=\"second\",s=\"minute\",u=\"hour\",a=\"day\",o=\"week\",c=\"month\",f=\"quarter\",h=\"year\",d=\"date\",l=\"Invalid Date\",$=/^(\\d{4})[-/]?(\\d{1,2})?[-/]?(\\d{0,2})[Tt\\s]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?[.:]?(\\d+)?$/,y=/\\[([^\\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:\"en\",weekdays:\"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday\".split(\"_\"),months:\"January_February_March_April_May_June_July_August_September_October_November_December\".split(\"_\"),ordinal:function(t){var e=[\"th\",\"st\",\"nd\",\"rd\"],n=t%100;return\"[\"+t+(e[(n-20)%10]||e[n]||e[0])+\"]\"}},m=function(t,e,n){var r=String(t);return!r||r.length>=e?t:\"\"+Array(e+1-r.length).join(n)+t},v={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?\"+\":\"-\")+m(r,2,\"0\")+\":\"+m(i,2,\"0\")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,c),s=n-i<0,u=e.clone().add(r+(s?-1:1),c);return+(-(r+(n-i)/(s?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:c,y:h,w:o,d:a,D:d,h:u,m:s,s:i,ms:r,Q:f}[t]||String(t||\"\").toLowerCase().replace(/s$/,\"\")},u:function(t){return void 0===t}},g=\"en\",D={};D[g]=M;var p=\"$isDayjsObject\",S=function(t){return t instanceof _||!(!t||!t[p])},w=function t(e,n,r){var i;if(!e)return g;if(\"string\"==typeof e){var s=e.toLowerCase();D[s]&&(i=s),n&&(D[s]=n,i=s);var u=e.split(\"-\");if(!i&&u.length>1)return t(u[0])}else{var a=e.name;D[a]=e,i=a}return!r&&i&&(g=i),i||!r&&g},O=function(t,e){if(S(t))return t.clone();var n=\"object\"==typeof e?e:{};return n.date=t,n.args=arguments,new _(n)},b=v;b.l=w,b.i=S,b.w=function(t,e){return O(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var _=function(){function M(t){this.$L=w(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[p]=!0}var m=M.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(b.u(e))return new Date;if(e instanceof Date)return new Date(e);if(\"string\"==typeof e&&!/Z$/i.test(e)){var r=e.match($);if(r){var i=r[2]-1||0,s=(r[7]||\"0\").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.init()},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},m.$utils=function(){return b},m.isValid=function(){return!(this.$d.toString()===l)},m.isSame=function(t,e){var n=O(t);return this.startOf(e)<=n&&n<=this.endOf(e)},m.isAfter=function(t,e){return O(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<O(t)},m.$g=function(t,e,n){return b.u(t)?this[e]:this.set(n,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var n=this,r=!!b.u(e)||e,f=b.p(t),l=function(t,e){var i=b.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},$=function(t,e){return b.w(n.toDate()[t].apply(n.toDate(\"s\"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},y=this.$W,M=this.$M,m=this.$D,v=\"set\"+(this.$u?\"UTC\":\"\");switch(f){case h:return r?l(1,0):l(31,11);case c:return r?l(1,M):l(0,M+1);case o:var g=this.$locale().weekStart||0,D=(y<g?y+7:y)-g;return l(r?m-D:m+(6-D),M);case a:case d:return $(v+\"Hours\",0);case u:return $(v+\"Minutes\",1);case s:return $(v+\"Seconds\",2);case i:return $(v+\"Milliseconds\",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var n,o=b.p(t),f=\"set\"+(this.$u?\"UTC\":\"\"),l=(n={},n[a]=f+\"Date\",n[d]=f+\"Date\",n[c]=f+\"Month\",n[h]=f+\"FullYear\",n[u]=f+\"Hours\",n[s]=f+\"Minutes\",n[i]=f+\"Seconds\",n[r]=f+\"Milliseconds\",n)[o],$=o===a?this.$D+(e-this.$W):e;if(o===c||o===h){var y=this.clone().set(d,1);y.$d[l]($),y.init(),this.$d=y.set(d,Math.min(this.$D,y.daysInMonth())).$d}else l&&this.$d[l]($);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[b.p(t)]()},m.add=function(r,f){var d,l=this;r=Number(r);var $=b.p(f),y=function(t){var e=O(l);return b.w(e.date(e.date()+Math.round(t*r)),l)};if($===c)return this.set(c,this.$M+r);if($===h)return this.set(h,this.$y+r);if($===a)return y(1);if($===o)return y(7);var M=(d={},d[s]=e,d[u]=n,d[i]=t,d)[$]||1,m=this.$d.getTime()+r*M;return b.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||l;var r=t||\"YYYY-MM-DDTHH:mm:ssZ\",i=b.z(this),s=this.$H,u=this.$m,a=this.$M,o=n.weekdays,c=n.months,f=n.meridiem,h=function(t,n,i,s){return t&&(t[n]||t(e,r))||i[n].slice(0,s)},d=function(t){return b.s(s%12||12,t,\"0\")},$=f||function(t,e,n){var r=t<12?\"AM\":\"PM\";return n?r.toLowerCase():r};return r.replace(y,(function(t,r){return r||function(t){switch(t){case\"YY\":return String(e.$y).slice(-2);case\"YYYY\":return b.s(e.$y,4,\"0\");case\"M\":return a+1;case\"MM\":return b.s(a+1,2,\"0\");case\"MMM\":return h(n.monthsShort,a,c,3);case\"MMMM\":return h(c,a);case\"D\":return e.$D;case\"DD\":return b.s(e.$D,2,\"0\");case\"d\":return String(e.$W);case\"dd\":return h(n.weekdaysMin,e.$W,o,2);case\"ddd\":return h(n.weekdaysShort,e.$W,o,3);case\"dddd\":return o[e.$W];case\"H\":return String(s);case\"HH\":return b.s(s,2,\"0\");case\"h\":return d(1);case\"hh\":return d(2);case\"a\":return $(s,u,!0);case\"A\":return $(s,u,!1);case\"m\":return String(u);case\"mm\":return b.s(u,2,\"0\");case\"s\":return String(e.$s);case\"ss\":return b.s(e.$s,2,\"0\");case\"SSS\":return b.s(e.$ms,3,\"0\");case\"Z\":return i}return null}(t)||i.replace(\":\",\"\")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,l){var $,y=this,M=b.p(d),m=O(r),v=(m.utcOffset()-this.utcOffset())*e,g=this-m,D=function(){return b.m(y,m)};switch(M){case h:$=D()/12;break;case c:$=D();break;case f:$=D()/3;break;case o:$=(g-v)/6048e5;break;case a:$=(g-v)/864e5;break;case u:$=g/n;break;case s:$=g/e;break;case i:$=g/t;break;default:$=g}return l?$:b.a($)},m.daysInMonth=function(){return this.endOf(c).$D},m.$locale=function(){return D[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=w(t,e,!0);return r&&(n.$L=r),n},m.clone=function(){return b.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},M}(),k=_.prototype;return O.prototype=k,[[\"$ms\",r],[\"$s\",i],[\"$m\",s],[\"$H\",u],[\"$W\",a],[\"$M\",c],[\"$y\",h],[\"$D\",d]].forEach((function(t){k[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),O.extend=function(t,e){return t.$i||(t(e,_,O),t.$i=!0),O},O.locale=w,O.isDayjs=S,O.unix=function(t){return O(1e3*t)},O.en=D[g],O.Ls=D,O.p={},O}));","!function(t,n){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=n():\"function\"==typeof define&&define.amd?define(n):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).dayjs_plugin_quarterOfYear=n()}(this,(function(){\"use strict\";var t=\"month\",n=\"quarter\";return function(e,i){var r=i.prototype;r.quarter=function(t){return this.$utils().u(t)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(t-1))};var s=r.add;r.add=function(e,i){return e=Number(e),this.$utils().p(i)===n?this.add(3*e,t):s.bind(this)(e,i)};var u=r.startOf;r.startOf=function(e,i){var r=this.$utils(),s=!!r.u(i)||i;if(r.p(e)===n){var o=this.quarter()-1;return s?this.month(3*o).startOf(t).startOf(\"day\"):this.month(3*o+2).endOf(t).endOf(\"day\")}return u.bind(this)(e,i)}}}));","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","export var Meridiem;\n(function (Meridiem) {\n    Meridiem[Meridiem[\"AM\"] = 0] = \"AM\";\n    Meridiem[Meridiem[\"PM\"] = 1] = \"PM\";\n})(Meridiem || (Meridiem = {}));\nexport var Weekday;\n(function (Weekday) {\n    Weekday[Weekday[\"SUNDAY\"] = 0] = \"SUNDAY\";\n    Weekday[Weekday[\"MONDAY\"] = 1] = \"MONDAY\";\n    Weekday[Weekday[\"TUESDAY\"] = 2] = \"TUESDAY\";\n    Weekday[Weekday[\"WEDNESDAY\"] = 3] = \"WEDNESDAY\";\n    Weekday[Weekday[\"THURSDAY\"] = 4] = \"THURSDAY\";\n    Weekday[Weekday[\"FRIDAY\"] = 5] = \"FRIDAY\";\n    Weekday[Weekday[\"SATURDAY\"] = 6] = \"SATURDAY\";\n})(Weekday || (Weekday = {}));\nexport var Month;\n(function (Month) {\n    Month[Month[\"JANUARY\"] = 1] = \"JANUARY\";\n    Month[Month[\"FEBRUARY\"] = 2] = \"FEBRUARY\";\n    Month[Month[\"MARCH\"] = 3] = \"MARCH\";\n    Month[Month[\"APRIL\"] = 4] = \"APRIL\";\n    Month[Month[\"MAY\"] = 5] = \"MAY\";\n    Month[Month[\"JUNE\"] = 6] = \"JUNE\";\n    Month[Month[\"JULY\"] = 7] = \"JULY\";\n    Month[Month[\"AUGUST\"] = 8] = \"AUGUST\";\n    Month[Month[\"SEPTEMBER\"] = 9] = \"SEPTEMBER\";\n    Month[Month[\"OCTOBER\"] = 10] = \"OCTOBER\";\n    Month[Month[\"NOVEMBER\"] = 11] = \"NOVEMBER\";\n    Month[Month[\"DECEMBER\"] = 12] = \"DECEMBER\";\n})(Month || (Month = {}));\n//# sourceMappingURL=types.js.map","import { Meridiem } from \"../types.js\";\nexport function assignTheNextDay(component, targetDayJs) {\n    targetDayJs = targetDayJs.add(1, \"day\");\n    assignSimilarDate(component, targetDayJs);\n    implySimilarTime(component, targetDayJs);\n}\nexport function implyTheNextDay(component, targetDayJs) {\n    targetDayJs = targetDayJs.add(1, \"day\");\n    implySimilarDate(component, targetDayJs);\n    implySimilarTime(component, targetDayJs);\n}\nexport function assignSimilarDate(component, targetDayJs) {\n    component.assign(\"day\", targetDayJs.date());\n    component.assign(\"month\", targetDayJs.month() + 1);\n    component.assign(\"year\", targetDayJs.year());\n}\nexport function assignSimilarTime(component, targetDayJs) {\n    component.assign(\"hour\", targetDayJs.hour());\n    component.assign(\"minute\", targetDayJs.minute());\n    component.assign(\"second\", targetDayJs.second());\n    component.assign(\"millisecond\", targetDayJs.millisecond());\n    if (component.get(\"hour\") < 12) {\n        component.assign(\"meridiem\", Meridiem.AM);\n    }\n    else {\n        component.assign(\"meridiem\", Meridiem.PM);\n    }\n}\nexport function implySimilarDate(component, targetDayJs) {\n    component.imply(\"day\", targetDayJs.date());\n    component.imply(\"month\", targetDayJs.month() + 1);\n    component.imply(\"year\", targetDayJs.year());\n}\nexport function implySimilarTime(component, targetDayJs) {\n    component.imply(\"hour\", targetDayJs.hour());\n    component.imply(\"minute\", targetDayJs.minute());\n    component.imply(\"second\", targetDayJs.second());\n    component.imply(\"millisecond\", targetDayJs.millisecond());\n}\n//# sourceMappingURL=dayjs.js.map","import dayjs from \"dayjs\";\nimport { Weekday, Month } from \"./types.js\";\nexport const TIMEZONE_ABBR_MAP = {\n    ACDT: 630,\n    ACST: 570,\n    ADT: -180,\n    AEDT: 660,\n    AEST: 600,\n    AFT: 270,\n    AKDT: -480,\n    AKST: -540,\n    ALMT: 360,\n    AMST: -180,\n    AMT: -240,\n    ANAST: 720,\n    ANAT: 720,\n    AQTT: 300,\n    ART: -180,\n    AST: -240,\n    AWDT: 540,\n    AWST: 480,\n    AZOST: 0,\n    AZOT: -60,\n    AZST: 300,\n    AZT: 240,\n    BNT: 480,\n    BOT: -240,\n    BRST: -120,\n    BRT: -180,\n    BST: 60,\n    BTT: 360,\n    CAST: 480,\n    CAT: 120,\n    CCT: 390,\n    CDT: -300,\n    CEST: 120,\n    CET: {\n        timezoneOffsetDuringDst: 2 * 60,\n        timezoneOffsetNonDst: 60,\n        dstStart: (year) => getLastWeekdayOfMonth(year, Month.MARCH, Weekday.SUNDAY, 2),\n        dstEnd: (year) => getLastWeekdayOfMonth(year, Month.OCTOBER, Weekday.SUNDAY, 3),\n    },\n    CHADT: 825,\n    CHAST: 765,\n    CKT: -600,\n    CLST: -180,\n    CLT: -240,\n    COT: -300,\n    CST: -360,\n    CT: {\n        timezoneOffsetDuringDst: -5 * 60,\n        timezoneOffsetNonDst: -6 * 60,\n        dstStart: (year) => getNthWeekdayOfMonth(year, Month.MARCH, Weekday.SUNDAY, 2, 2),\n        dstEnd: (year) => getNthWeekdayOfMonth(year, Month.NOVEMBER, Weekday.SUNDAY, 1, 2),\n    },\n    CVT: -60,\n    CXT: 420,\n    ChST: 600,\n    DAVT: 420,\n    EASST: -300,\n    EAST: -360,\n    EAT: 180,\n    ECT: -300,\n    EDT: -240,\n    EEST: 180,\n    EET: 120,\n    EGST: 0,\n    EGT: -60,\n    EST: -300,\n    ET: {\n        timezoneOffsetDuringDst: -4 * 60,\n        timezoneOffsetNonDst: -5 * 60,\n        dstStart: (year) => getNthWeekdayOfMonth(year, Month.MARCH, Weekday.SUNDAY, 2, 2),\n        dstEnd: (year) => getNthWeekdayOfMonth(year, Month.NOVEMBER, Weekday.SUNDAY, 1, 2),\n    },\n    FJST: 780,\n    FJT: 720,\n    FKST: -180,\n    FKT: -240,\n    FNT: -120,\n    GALT: -360,\n    GAMT: -540,\n    GET: 240,\n    GFT: -180,\n    GILT: 720,\n    GMT: 0,\n    GST: 240,\n    GYT: -240,\n    HAA: -180,\n    HAC: -300,\n    HADT: -540,\n    HAE: -240,\n    HAP: -420,\n    HAR: -360,\n    HAST: -600,\n    HAT: -90,\n    HAY: -480,\n    HKT: 480,\n    HLV: -210,\n    HNA: -240,\n    HNC: -360,\n    HNE: -300,\n    HNP: -480,\n    HNR: -420,\n    HNT: -150,\n    HNY: -540,\n    HOVT: 420,\n    ICT: 420,\n    IDT: 180,\n    IOT: 360,\n    IRDT: 270,\n    IRKST: 540,\n    IRKT: 540,\n    IRST: 210,\n    IST: 330,\n    JST: 540,\n    KGT: 360,\n    KRAST: 480,\n    KRAT: 480,\n    KST: 540,\n    KUYT: 240,\n    LHDT: 660,\n    LHST: 630,\n    LINT: 840,\n    MAGST: 720,\n    MAGT: 720,\n    MART: -510,\n    MAWT: 300,\n    MDT: -360,\n    MESZ: 120,\n    MEZ: 60,\n    MHT: 720,\n    MMT: 390,\n    MSD: 240,\n    MSK: 180,\n    MST: -420,\n    MT: {\n        timezoneOffsetDuringDst: -6 * 60,\n        timezoneOffsetNonDst: -7 * 60,\n        dstStart: (year) => getNthWeekdayOfMonth(year, Month.MARCH, Weekday.SUNDAY, 2, 2),\n        dstEnd: (year) => getNthWeekdayOfMonth(year, Month.NOVEMBER, Weekday.SUNDAY, 1, 2),\n    },\n    MUT: 240,\n    MVT: 300,\n    MYT: 480,\n    NCT: 660,\n    NDT: -90,\n    NFT: 690,\n    NOVST: 420,\n    NOVT: 360,\n    NPT: 345,\n    NST: -150,\n    NUT: -660,\n    NZDT: 780,\n    NZST: 720,\n    OMSST: 420,\n    OMST: 420,\n    PDT: -420,\n    PET: -300,\n    PETST: 720,\n    PETT: 720,\n    PGT: 600,\n    PHOT: 780,\n    PHT: 480,\n    PKT: 300,\n    PMDT: -120,\n    PMST: -180,\n    PONT: 660,\n    PST: -480,\n    PT: {\n        timezoneOffsetDuringDst: -7 * 60,\n        timezoneOffsetNonDst: -8 * 60,\n        dstStart: (year) => getNthWeekdayOfMonth(year, Month.MARCH, Weekday.SUNDAY, 2, 2),\n        dstEnd: (year) => getNthWeekdayOfMonth(year, Month.NOVEMBER, Weekday.SUNDAY, 1, 2),\n    },\n    PWT: 540,\n    PYST: -180,\n    PYT: -240,\n    RET: 240,\n    SAMT: 240,\n    SAST: 120,\n    SBT: 660,\n    SCT: 240,\n    SGT: 480,\n    SRT: -180,\n    SST: -660,\n    TAHT: -600,\n    TFT: 300,\n    TJT: 300,\n    TKT: 780,\n    TLT: 540,\n    TMT: 300,\n    TVT: 720,\n    ULAT: 480,\n    UTC: 0,\n    UYST: -120,\n    UYT: -180,\n    UZT: 300,\n    VET: -210,\n    VLAST: 660,\n    VLAT: 660,\n    VUT: 660,\n    WAST: 120,\n    WAT: 60,\n    WEST: 60,\n    WESZ: 60,\n    WET: 0,\n    WEZ: 0,\n    WFT: 720,\n    WGST: -120,\n    WGT: -180,\n    WIB: 420,\n    WIT: 540,\n    WITA: 480,\n    WST: 780,\n    WT: 0,\n    YAKST: 600,\n    YAKT: 600,\n    YAPT: 600,\n    YEKST: 360,\n    YEKT: 360,\n};\nexport function getNthWeekdayOfMonth(year, month, weekday, n, hour = 0) {\n    let dayOfMonth = 0;\n    let i = 0;\n    while (i < n) {\n        dayOfMonth++;\n        const date = new Date(year, month - 1, dayOfMonth);\n        if (date.getDay() === weekday)\n            i++;\n    }\n    return new Date(year, month - 1, dayOfMonth, hour);\n}\nexport function getLastWeekdayOfMonth(year, month, weekday, hour = 0) {\n    const oneIndexedWeekday = weekday === 0 ? 7 : weekday;\n    const date = new Date(year, month - 1 + 1, 1, 12);\n    const firstWeekdayNextMonth = date.getDay() === 0 ? 7 : date.getDay();\n    let dayDiff;\n    if (firstWeekdayNextMonth === oneIndexedWeekday)\n        dayDiff = 7;\n    else if (firstWeekdayNextMonth < oneIndexedWeekday)\n        dayDiff = 7 + firstWeekdayNextMonth - oneIndexedWeekday;\n    else\n        dayDiff = firstWeekdayNextMonth - oneIndexedWeekday;\n    date.setDate(date.getDate() - dayDiff);\n    return new Date(year, month - 1, date.getDate(), hour);\n}\nexport function toTimezoneOffset(timezoneInput, date, timezoneOverrides = {}) {\n    if (timezoneInput == null) {\n        return null;\n    }\n    if (typeof timezoneInput === \"number\") {\n        return timezoneInput;\n    }\n    const matchedTimezone = timezoneOverrides[timezoneInput] ?? TIMEZONE_ABBR_MAP[timezoneInput];\n    if (matchedTimezone == null) {\n        return null;\n    }\n    if (typeof matchedTimezone == \"number\") {\n        return matchedTimezone;\n    }\n    if (date == null) {\n        return null;\n    }\n    if (dayjs(date).isAfter(matchedTimezone.dstStart(date.getFullYear())) &&\n        !dayjs(date).isAfter(matchedTimezone.dstEnd(date.getFullYear()))) {\n        return matchedTimezone.timezoneOffsetDuringDst;\n    }\n    return matchedTimezone.timezoneOffsetNonDst;\n}\n//# sourceMappingURL=timezone.js.map","import quarterOfYear from \"dayjs/plugin/quarterOfYear.js\";\nimport dayjs from \"dayjs\";\nimport { assignSimilarDate, assignSimilarTime, implySimilarTime } from \"./utils/dayjs.js\";\nimport { toTimezoneOffset } from \"./timezone.js\";\ndayjs.extend(quarterOfYear);\nexport class ReferenceWithTimezone {\n    constructor(input) {\n        input = input ?? new Date();\n        if (input instanceof Date) {\n            this.instant = input;\n        }\n        else {\n            this.instant = input.instant ?? new Date();\n            this.timezoneOffset = toTimezoneOffset(input.timezone, this.instant);\n        }\n    }\n    getDateWithAdjustedTimezone() {\n        return new Date(this.instant.getTime() + this.getSystemTimezoneAdjustmentMinute(this.instant) * 60000);\n    }\n    getSystemTimezoneAdjustmentMinute(date, overrideTimezoneOffset) {\n        if (!date || date.getTime() < 0) {\n            date = new Date();\n        }\n        const currentTimezoneOffset = -date.getTimezoneOffset();\n        const targetTimezoneOffset = overrideTimezoneOffset ?? this.timezoneOffset ?? currentTimezoneOffset;\n        return currentTimezoneOffset - targetTimezoneOffset;\n    }\n}\nexport class ParsingComponents {\n    constructor(reference, knownComponents) {\n        this._tags = new Set();\n        this.reference = reference;\n        this.knownValues = {};\n        this.impliedValues = {};\n        if (knownComponents) {\n            for (const key in knownComponents) {\n                this.knownValues[key] = knownComponents[key];\n            }\n        }\n        const refDayJs = dayjs(reference.instant);\n        this.imply(\"day\", refDayJs.date());\n        this.imply(\"month\", refDayJs.month() + 1);\n        this.imply(\"year\", refDayJs.year());\n        this.imply(\"hour\", 12);\n        this.imply(\"minute\", 0);\n        this.imply(\"second\", 0);\n        this.imply(\"millisecond\", 0);\n    }\n    get(component) {\n        if (component in this.knownValues) {\n            return this.knownValues[component];\n        }\n        if (component in this.impliedValues) {\n            return this.impliedValues[component];\n        }\n        return null;\n    }\n    isCertain(component) {\n        return component in this.knownValues;\n    }\n    getCertainComponents() {\n        return Object.keys(this.knownValues);\n    }\n    imply(component, value) {\n        if (component in this.knownValues) {\n            return this;\n        }\n        this.impliedValues[component] = value;\n        return this;\n    }\n    assign(component, value) {\n        this.knownValues[component] = value;\n        delete this.impliedValues[component];\n        return this;\n    }\n    delete(component) {\n        delete this.knownValues[component];\n        delete this.impliedValues[component];\n    }\n    clone() {\n        const component = new ParsingComponents(this.reference);\n        component.knownValues = {};\n        component.impliedValues = {};\n        for (const key in this.knownValues) {\n            component.knownValues[key] = this.knownValues[key];\n        }\n        for (const key in this.impliedValues) {\n            component.impliedValues[key] = this.impliedValues[key];\n        }\n        return component;\n    }\n    isOnlyDate() {\n        return !this.isCertain(\"hour\") && !this.isCertain(\"minute\") && !this.isCertain(\"second\");\n    }\n    isOnlyTime() {\n        return (!this.isCertain(\"weekday\") && !this.isCertain(\"day\") && !this.isCertain(\"month\") && !this.isCertain(\"year\"));\n    }\n    isOnlyWeekdayComponent() {\n        return this.isCertain(\"weekday\") && !this.isCertain(\"day\") && !this.isCertain(\"month\");\n    }\n    isDateWithUnknownYear() {\n        return this.isCertain(\"month\") && !this.isCertain(\"year\");\n    }\n    isValidDate() {\n        const date = this.dateWithoutTimezoneAdjustment();\n        if (date.getFullYear() !== this.get(\"year\"))\n            return false;\n        if (date.getMonth() !== this.get(\"month\") - 1)\n            return false;\n        if (date.getDate() !== this.get(\"day\"))\n            return false;\n        if (this.get(\"hour\") != null && date.getHours() != this.get(\"hour\"))\n            return false;\n        if (this.get(\"minute\") != null && date.getMinutes() != this.get(\"minute\"))\n            return false;\n        return true;\n    }\n    toString() {\n        return `[ParsingComponents {\n            tags: ${JSON.stringify(Array.from(this._tags).sort())}, \n            knownValues: ${JSON.stringify(this.knownValues)}, \n            impliedValues: ${JSON.stringify(this.impliedValues)}}, \n            reference: ${JSON.stringify(this.reference)}]`;\n    }\n    dayjs() {\n        return dayjs(this.date());\n    }\n    date() {\n        const date = this.dateWithoutTimezoneAdjustment();\n        const timezoneAdjustment = this.reference.getSystemTimezoneAdjustmentMinute(date, this.get(\"timezoneOffset\"));\n        return new Date(date.getTime() + timezoneAdjustment * 60000);\n    }\n    addTag(tag) {\n        this._tags.add(tag);\n        return this;\n    }\n    addTags(tags) {\n        for (const tag of tags) {\n            this._tags.add(tag);\n        }\n        return this;\n    }\n    tags() {\n        return new Set(this._tags);\n    }\n    dateWithoutTimezoneAdjustment() {\n        const date = new Date(this.get(\"year\"), this.get(\"month\") - 1, this.get(\"day\"), this.get(\"hour\"), this.get(\"minute\"), this.get(\"second\"), this.get(\"millisecond\"));\n        date.setFullYear(this.get(\"year\"));\n        return date;\n    }\n    static createRelativeFromReference(reference, fragments) {\n        let date = dayjs(reference.instant);\n        for (const key in fragments) {\n            date = date.add(fragments[key], key);\n        }\n        const components = new ParsingComponents(reference);\n        if (fragments[\"hour\"] || fragments[\"minute\"] || fragments[\"second\"]) {\n            assignSimilarTime(components, date);\n            assignSimilarDate(components, date);\n            if (reference.timezoneOffset !== null) {\n                components.assign(\"timezoneOffset\", -reference.instant.getTimezoneOffset());\n            }\n        }\n        else {\n            implySimilarTime(components, date);\n            if (reference.timezoneOffset !== null) {\n                components.imply(\"timezoneOffset\", -reference.instant.getTimezoneOffset());\n            }\n            if (fragments[\"d\"]) {\n                components.assign(\"day\", date.date());\n                components.assign(\"month\", date.month() + 1);\n                components.assign(\"year\", date.year());\n            }\n            else if (fragments[\"week\"]) {\n                components.assign(\"day\", date.date());\n                components.assign(\"month\", date.month() + 1);\n                components.assign(\"year\", date.year());\n                components.imply(\"weekday\", date.day());\n            }\n            else {\n                components.imply(\"day\", date.date());\n                if (fragments[\"month\"]) {\n                    components.assign(\"month\", date.month() + 1);\n                    components.assign(\"year\", date.year());\n                }\n                else {\n                    components.imply(\"month\", date.month() + 1);\n                    if (fragments[\"year\"]) {\n                        components.assign(\"year\", date.year());\n                    }\n                    else {\n                        components.imply(\"year\", date.year());\n                    }\n                }\n            }\n        }\n        return components;\n    }\n}\nexport class ParsingResult {\n    constructor(reference, index, text, start, end) {\n        this.reference = reference;\n        this.refDate = reference.instant;\n        this.index = index;\n        this.text = text;\n        this.start = start || new ParsingComponents(reference);\n        this.end = end;\n    }\n    clone() {\n        const result = new ParsingResult(this.reference, this.index, this.text);\n        result.start = this.start ? this.start.clone() : null;\n        result.end = this.end ? this.end.clone() : null;\n        return result;\n    }\n    date() {\n        return this.start.date();\n    }\n    tags() {\n        const combinedTags = new Set(this.start.tags());\n        if (this.end) {\n            for (const tag of this.end.tags()) {\n                combinedTags.add(tag);\n            }\n        }\n        return combinedTags;\n    }\n    toString() {\n        const tags = Array.from(this.tags()).sort();\n        return `[ParsingResult {index: ${this.index}, text: '${this.text}', tags: ${JSON.stringify(tags)} ...}]`;\n    }\n}\n//# sourceMappingURL=results.js.map","export function repeatedTimeunitPattern(prefix, singleTimeunitPattern, connectorPattern = \"\\\\s{0,5},?\\\\s{0,5}\") {\n    const singleTimeunitPatternNoCapture = singleTimeunitPattern.replace(/\\((?!\\?)/g, \"(?:\");\n    return `${prefix}${singleTimeunitPatternNoCapture}(?:${connectorPattern}${singleTimeunitPatternNoCapture}){0,10}`;\n}\nexport function extractTerms(dictionary) {\n    let keys;\n    if (dictionary instanceof Array) {\n        keys = [...dictionary];\n    }\n    else if (dictionary instanceof Map) {\n        keys = Array.from(dictionary.keys());\n    }\n    else {\n        keys = Object.keys(dictionary);\n    }\n    return keys;\n}\nexport function matchAnyPattern(dictionary) {\n    const joinedTerms = extractTerms(dictionary)\n        .sort((a, b) => b.length - a.length)\n        .join(\"|\")\n        .replace(/\\./g, \"\\\\.\");\n    return `(?:${joinedTerms})`;\n}\n//# sourceMappingURL=pattern.js.map","import dayjs from \"dayjs\";\nexport function findMostLikelyADYear(yearNumber) {\n    if (yearNumber < 100) {\n        if (yearNumber > 50) {\n            yearNumber = yearNumber + 1900;\n        }\n        else {\n            yearNumber = yearNumber + 2000;\n        }\n    }\n    return yearNumber;\n}\nexport function findYearClosestToRef(refDate, day, month) {\n    const refMoment = dayjs(refDate);\n    let dateMoment = refMoment;\n    dateMoment = dateMoment.month(month - 1);\n    dateMoment = dateMoment.date(day);\n    dateMoment = dateMoment.year(refMoment.year());\n    const nextYear = dateMoment.add(1, \"y\");\n    const lastYear = dateMoment.add(-1, \"y\");\n    if (Math.abs(nextYear.diff(refMoment)) < Math.abs(dateMoment.diff(refMoment))) {\n        dateMoment = nextYear;\n    }\n    else if (Math.abs(lastYear.diff(refMoment)) < Math.abs(dateMoment.diff(refMoment))) {\n        dateMoment = lastYear;\n    }\n    return dateMoment.year();\n}\n//# sourceMappingURL=years.js.map","import { matchAnyPattern, repeatedTimeunitPattern } from \"../../utils/pattern.js\";\nimport { findMostLikelyADYear } from \"../../calculation/years.js\";\nexport const WEEKDAY_DICTIONARY = {\n    sunday: 0,\n    sun: 0,\n    \"sun.\": 0,\n    monday: 1,\n    mon: 1,\n    \"mon.\": 1,\n    tuesday: 2,\n    tue: 2,\n    \"tue.\": 2,\n    wednesday: 3,\n    wed: 3,\n    \"wed.\": 3,\n    thursday: 4,\n    thurs: 4,\n    \"thurs.\": 4,\n    thur: 4,\n    \"thur.\": 4,\n    thu: 4,\n    \"thu.\": 4,\n    friday: 5,\n    fri: 5,\n    \"fri.\": 5,\n    saturday: 6,\n    sat: 6,\n    \"sat.\": 6,\n};\nexport const FULL_MONTH_NAME_DICTIONARY = {\n    january: 1,\n    february: 2,\n    march: 3,\n    april: 4,\n    may: 5,\n    june: 6,\n    july: 7,\n    august: 8,\n    september: 9,\n    october: 10,\n    november: 11,\n    december: 12,\n};\nexport const MONTH_DICTIONARY = {\n    ...FULL_MONTH_NAME_DICTIONARY,\n    jan: 1,\n    \"jan.\": 1,\n    feb: 2,\n    \"feb.\": 2,\n    mar: 3,\n    \"mar.\": 3,\n    apr: 4,\n    \"apr.\": 4,\n    jun: 6,\n    \"jun.\": 6,\n    jul: 7,\n    \"jul.\": 7,\n    aug: 8,\n    \"aug.\": 8,\n    sep: 9,\n    \"sep.\": 9,\n    sept: 9,\n    \"sept.\": 9,\n    oct: 10,\n    \"oct.\": 10,\n    nov: 11,\n    \"nov.\": 11,\n    dec: 12,\n    \"dec.\": 12,\n};\nexport const INTEGER_WORD_DICTIONARY = {\n    one: 1,\n    two: 2,\n    three: 3,\n    four: 4,\n    five: 5,\n    six: 6,\n    seven: 7,\n    eight: 8,\n    nine: 9,\n    ten: 10,\n    eleven: 11,\n    twelve: 12,\n};\nexport const ORDINAL_WORD_DICTIONARY = {\n    first: 1,\n    second: 2,\n    third: 3,\n    fourth: 4,\n    fifth: 5,\n    sixth: 6,\n    seventh: 7,\n    eighth: 8,\n    ninth: 9,\n    tenth: 10,\n    eleventh: 11,\n    twelfth: 12,\n    thirteenth: 13,\n    fourteenth: 14,\n    fifteenth: 15,\n    sixteenth: 16,\n    seventeenth: 17,\n    eighteenth: 18,\n    nineteenth: 19,\n    twentieth: 20,\n    \"twenty first\": 21,\n    \"twenty-first\": 21,\n    \"twenty second\": 22,\n    \"twenty-second\": 22,\n    \"twenty third\": 23,\n    \"twenty-third\": 23,\n    \"twenty fourth\": 24,\n    \"twenty-fourth\": 24,\n    \"twenty fifth\": 25,\n    \"twenty-fifth\": 25,\n    \"twenty sixth\": 26,\n    \"twenty-sixth\": 26,\n    \"twenty seventh\": 27,\n    \"twenty-seventh\": 27,\n    \"twenty eighth\": 28,\n    \"twenty-eighth\": 28,\n    \"twenty ninth\": 29,\n    \"twenty-ninth\": 29,\n    \"thirtieth\": 30,\n    \"thirty first\": 31,\n    \"thirty-first\": 31,\n};\nexport const TIME_UNIT_DICTIONARY_NO_ABBR = {\n    second: \"second\",\n    seconds: \"second\",\n    minute: \"minute\",\n    minutes: \"minute\",\n    hour: \"hour\",\n    hours: \"hour\",\n    day: \"d\",\n    days: \"d\",\n    week: \"week\",\n    weeks: \"week\",\n    month: \"month\",\n    months: \"month\",\n    quarter: \"quarter\",\n    quarters: \"quarter\",\n    year: \"year\",\n    years: \"year\",\n};\nexport const TIME_UNIT_DICTIONARY = {\n    s: \"second\",\n    sec: \"second\",\n    second: \"second\",\n    seconds: \"second\",\n    m: \"minute\",\n    min: \"minute\",\n    mins: \"minute\",\n    minute: \"minute\",\n    minutes: \"minute\",\n    h: \"hour\",\n    hr: \"hour\",\n    hrs: \"hour\",\n    hour: \"hour\",\n    hours: \"hour\",\n    d: \"d\",\n    day: \"d\",\n    days: \"d\",\n    w: \"w\",\n    week: \"week\",\n    weeks: \"week\",\n    mo: \"month\",\n    mon: \"month\",\n    mos: \"month\",\n    month: \"month\",\n    months: \"month\",\n    qtr: \"quarter\",\n    quarter: \"quarter\",\n    quarters: \"quarter\",\n    y: \"year\",\n    yr: \"year\",\n    year: \"year\",\n    years: \"year\",\n    ...TIME_UNIT_DICTIONARY_NO_ABBR,\n};\nexport const NUMBER_PATTERN = `(?:${matchAnyPattern(INTEGER_WORD_DICTIONARY)}|[0-9]+|[0-9]+\\\\.[0-9]+|half(?:\\\\s{0,2}an?)?|an?\\\\b(?:\\\\s{0,2}few)?|few|several|the|a?\\\\s{0,2}couple\\\\s{0,2}(?:of)?)`;\nexport function parseNumberPattern(match) {\n    const num = match.toLowerCase();\n    if (INTEGER_WORD_DICTIONARY[num] !== undefined) {\n        return INTEGER_WORD_DICTIONARY[num];\n    }\n    else if (num === \"a\" || num === \"an\" || num == \"the\") {\n        return 1;\n    }\n    else if (num.match(/few/)) {\n        return 3;\n    }\n    else if (num.match(/half/)) {\n        return 0.5;\n    }\n    else if (num.match(/couple/)) {\n        return 2;\n    }\n    else if (num.match(/several/)) {\n        return 7;\n    }\n    return parseFloat(num);\n}\nexport const ORDINAL_NUMBER_PATTERN = `(?:${matchAnyPattern(ORDINAL_WORD_DICTIONARY)}|[0-9]{1,2}(?:st|nd|rd|th)?)`;\nexport function parseOrdinalNumberPattern(match) {\n    let num = match.toLowerCase();\n    if (ORDINAL_WORD_DICTIONARY[num] !== undefined) {\n        return ORDINAL_WORD_DICTIONARY[num];\n    }\n    num = num.replace(/(?:st|nd|rd|th)$/i, \"\");\n    return parseInt(num);\n}\nexport const YEAR_PATTERN = `(?:[1-9][0-9]{0,3}\\\\s{0,2}(?:BE|AD|BC|BCE|CE)|[1-2][0-9]{3}|[5-9][0-9]|2[0-5])`;\nexport function parseYear(match) {\n    if (/BE/i.test(match)) {\n        match = match.replace(/BE/i, \"\");\n        return parseInt(match) - 543;\n    }\n    if (/BCE?/i.test(match)) {\n        match = match.replace(/BCE?/i, \"\");\n        return -parseInt(match);\n    }\n    if (/(AD|CE)/i.test(match)) {\n        match = match.replace(/(AD|CE)/i, \"\");\n        return parseInt(match);\n    }\n    const rawYearNumber = parseInt(match);\n    return findMostLikelyADYear(rawYearNumber);\n}\nconst SINGLE_TIME_UNIT_PATTERN = `(${NUMBER_PATTERN})\\\\s{0,3}(${matchAnyPattern(TIME_UNIT_DICTIONARY)})`;\nconst SINGLE_TIME_UNIT_REGEX = new RegExp(SINGLE_TIME_UNIT_PATTERN, \"i\");\nconst SINGLE_TIME_UNIT_NO_ABBR_PATTERN = `(${NUMBER_PATTERN})\\\\s{0,3}(${matchAnyPattern(TIME_UNIT_DICTIONARY_NO_ABBR)})`;\nconst TIME_UNIT_CONNECTOR_PATTERN = `\\\\s{0,5},?(?:\\\\s*and)?\\\\s{0,5}`;\nexport const TIME_UNITS_PATTERN = repeatedTimeunitPattern(`(?:(?:about|around)\\\\s{0,3})?`, SINGLE_TIME_UNIT_PATTERN, TIME_UNIT_CONNECTOR_PATTERN);\nexport const TIME_UNITS_NO_ABBR_PATTERN = repeatedTimeunitPattern(`(?:(?:about|around)\\\\s{0,3})?`, SINGLE_TIME_UNIT_NO_ABBR_PATTERN, TIME_UNIT_CONNECTOR_PATTERN);\nexport function parseTimeUnits(timeunitText) {\n    const fragments = {};\n    let remainingText = timeunitText;\n    let match = SINGLE_TIME_UNIT_REGEX.exec(remainingText);\n    while (match) {\n        collectDateTimeFragment(fragments, match);\n        remainingText = remainingText.substring(match[0].length).trim();\n        match = SINGLE_TIME_UNIT_REGEX.exec(remainingText);\n    }\n    if (Object.keys(fragments).length == 0) {\n        return null;\n    }\n    return fragments;\n}\nfunction collectDateTimeFragment(fragments, match) {\n    if (match[0].match(/^[a-zA-Z]+$/)) {\n        return;\n    }\n    const num = parseNumberPattern(match[1]);\n    const unit = TIME_UNIT_DICTIONARY[match[2].toLowerCase()];\n    fragments[unit] = num;\n}\n//# sourceMappingURL=constants.js.map","export class AbstractParserWithWordBoundaryChecking {\n    constructor() {\n        this.cachedInnerPattern = null;\n        this.cachedPattern = null;\n    }\n    innerPatternHasChange(context, currentInnerPattern) {\n        return this.innerPattern(context) !== currentInnerPattern;\n    }\n    patternLeftBoundary() {\n        return `(\\\\W|^)`;\n    }\n    pattern(context) {\n        if (this.cachedInnerPattern) {\n            if (!this.innerPatternHasChange(context, this.cachedInnerPattern)) {\n                return this.cachedPattern;\n            }\n        }\n        this.cachedInnerPattern = this.innerPattern(context);\n        this.cachedPattern = new RegExp(`${this.patternLeftBoundary()}${this.cachedInnerPattern.source}`, this.cachedInnerPattern.flags);\n        return this.cachedPattern;\n    }\n    extract(context, match) {\n        const header = match[1] ?? \"\";\n        match.index = match.index + header.length;\n        match[0] = match[0].substring(header.length);\n        for (let i = 2; i < match.length; i++) {\n            match[i - 1] = match[i];\n        }\n        return this.innerExtract(context, match);\n    }\n}\n//# sourceMappingURL=AbstractParserWithWordBoundary.js.map","import { TIME_UNITS_PATTERN, parseTimeUnits, TIME_UNITS_NO_ABBR_PATTERN } from \"../constants.js\";\nimport { ParsingComponents } from \"../../../results.js\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nconst PATTERN_WITH_OPTIONAL_PREFIX = new RegExp(`(?:(?:within|in|for)\\\\s*)?` +\n    `(?:(?:about|around|roughly|approximately|just)\\\\s*(?:~\\\\s*)?)?(${TIME_UNITS_PATTERN})(?=\\\\W|$)`, \"i\");\nconst PATTERN_WITH_PREFIX = new RegExp(`(?:within|in|for)\\\\s*` +\n    `(?:(?:about|around|roughly|approximately|just)\\\\s*(?:~\\\\s*)?)?(${TIME_UNITS_PATTERN})(?=\\\\W|$)`, \"i\");\nconst PATTERN_WITH_PREFIX_STRICT = new RegExp(`(?:within|in|for)\\\\s*` +\n    `(?:(?:about|around|roughly|approximately|just)\\\\s*(?:~\\\\s*)?)?(${TIME_UNITS_NO_ABBR_PATTERN})(?=\\\\W|$)`, \"i\");\nexport default class ENTimeUnitWithinFormatParser extends AbstractParserWithWordBoundaryChecking {\n    constructor(strictMode) {\n        super();\n        this.strictMode = strictMode;\n    }\n    innerPattern(context) {\n        if (this.strictMode) {\n            return PATTERN_WITH_PREFIX_STRICT;\n        }\n        return context.option.forwardDate ? PATTERN_WITH_OPTIONAL_PREFIX : PATTERN_WITH_PREFIX;\n    }\n    innerExtract(context, match) {\n        if (match[0].match(/^for\\s*the\\s*\\w+/)) {\n            return null;\n        }\n        const timeUnits = parseTimeUnits(match[1]);\n        if (!timeUnits) {\n            return null;\n        }\n        return ParsingComponents.createRelativeFromReference(context.reference, timeUnits);\n    }\n}\n//# sourceMappingURL=ENTimeUnitWithinFormatParser.js.map","import { findYearClosestToRef } from \"../../../calculation/years.js\";\nimport { MONTH_DICTIONARY } from \"../constants.js\";\nimport { YEAR_PATTERN, parseYear } from \"../constants.js\";\nimport { ORDINAL_NUMBER_PATTERN, parseOrdinalNumberPattern } from \"../constants.js\";\nimport { matchAnyPattern } from \"../../../utils/pattern.js\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nconst PATTERN = new RegExp(`(?:on\\\\s{0,3})?` +\n    `(${ORDINAL_NUMBER_PATTERN})` +\n    `(?:` +\n    `\\\\s{0,3}(?:to|\\\\-|\\\\–|until|through|till)?\\\\s{0,3}` +\n    `(${ORDINAL_NUMBER_PATTERN})` +\n    \")?\" +\n    `(?:-|/|\\\\s{0,3}(?:of)?\\\\s{0,3})` +\n    `(${matchAnyPattern(MONTH_DICTIONARY)})` +\n    \"(?:\" +\n    `(?:-|/|,?\\\\s{0,3})` +\n    `(${YEAR_PATTERN}(?!\\\\w))` +\n    \")?\" +\n    \"(?=\\\\W|$)\", \"i\");\nconst DATE_GROUP = 1;\nconst DATE_TO_GROUP = 2;\nconst MONTH_NAME_GROUP = 3;\nconst YEAR_GROUP = 4;\nexport default class ENMonthNameLittleEndianParser extends AbstractParserWithWordBoundaryChecking {\n    innerPattern() {\n        return PATTERN;\n    }\n    innerExtract(context, match) {\n        const result = context.createParsingResult(match.index, match[0]);\n        const month = MONTH_DICTIONARY[match[MONTH_NAME_GROUP].toLowerCase()];\n        const day = parseOrdinalNumberPattern(match[DATE_GROUP]);\n        if (day > 31) {\n            match.index = match.index + match[DATE_GROUP].length;\n            return null;\n        }\n        result.start.assign(\"month\", month);\n        result.start.assign(\"day\", day);\n        if (match[YEAR_GROUP]) {\n            const yearNumber = parseYear(match[YEAR_GROUP]);\n            result.start.assign(\"year\", yearNumber);\n        }\n        else {\n            const year = findYearClosestToRef(context.refDate, day, month);\n            result.start.imply(\"year\", year);\n        }\n        if (match[DATE_TO_GROUP]) {\n            const endDate = parseOrdinalNumberPattern(match[DATE_TO_GROUP]);\n            result.end = result.start.clone();\n            result.end.assign(\"day\", endDate);\n        }\n        return result;\n    }\n}\n//# sourceMappingURL=ENMonthNameLittleEndianParser.js.map","import { findYearClosestToRef } from \"../../../calculation/years.js\";\nimport { MONTH_DICTIONARY } from \"../constants.js\";\nimport { ORDINAL_NUMBER_PATTERN, parseOrdinalNumberPattern } from \"../constants.js\";\nimport { YEAR_PATTERN, parseYear } from \"../constants.js\";\nimport { matchAnyPattern } from \"../../../utils/pattern.js\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nconst PATTERN = new RegExp(`(${matchAnyPattern(MONTH_DICTIONARY)})` +\n    \"(?:-|/|\\\\s*,?\\\\s*)\" +\n    `(${ORDINAL_NUMBER_PATTERN})(?!\\\\s*(?:am|pm))\\\\s*` +\n    \"(?:\" +\n    \"(?:to|\\\\-)\\\\s*\" +\n    `(${ORDINAL_NUMBER_PATTERN})\\\\s*` +\n    \")?\" +\n    \"(?:\" +\n    `(?:-|/|\\\\s*,\\\\s*|\\\\s+)` +\n    `(${YEAR_PATTERN})` +\n    \")?\" +\n    \"(?=\\\\W|$)(?!\\\\:\\\\d)\", \"i\");\nconst MONTH_NAME_GROUP = 1;\nconst DATE_GROUP = 2;\nconst DATE_TO_GROUP = 3;\nconst YEAR_GROUP = 4;\nexport default class ENMonthNameMiddleEndianParser extends AbstractParserWithWordBoundaryChecking {\n    constructor(shouldSkipYearLikeDate) {\n        super();\n        this.shouldSkipYearLikeDate = shouldSkipYearLikeDate;\n    }\n    innerPattern() {\n        return PATTERN;\n    }\n    innerExtract(context, match) {\n        const month = MONTH_DICTIONARY[match[MONTH_NAME_GROUP].toLowerCase()];\n        const day = parseOrdinalNumberPattern(match[DATE_GROUP]);\n        if (day > 31) {\n            return null;\n        }\n        if (this.shouldSkipYearLikeDate) {\n            if (!match[DATE_TO_GROUP] && !match[YEAR_GROUP] && match[DATE_GROUP].match(/^2[0-5]$/)) {\n                return null;\n            }\n        }\n        const components = context\n            .createParsingComponents({\n            day: day,\n            month: month,\n        })\n            .addTag(\"parser/ENMonthNameMiddleEndianParser\");\n        if (match[YEAR_GROUP]) {\n            const year = parseYear(match[YEAR_GROUP]);\n            components.assign(\"year\", year);\n        }\n        else {\n            const year = findYearClosestToRef(context.refDate, day, month);\n            components.imply(\"year\", year);\n        }\n        if (!match[DATE_TO_GROUP]) {\n            return components;\n        }\n        const endDate = parseOrdinalNumberPattern(match[DATE_TO_GROUP]);\n        const result = context.createParsingResult(match.index, match[0]);\n        result.start = components;\n        result.end = components.clone();\n        result.end.assign(\"day\", endDate);\n        return result;\n    }\n}\n//# sourceMappingURL=ENMonthNameMiddleEndianParser.js.map","import { FULL_MONTH_NAME_DICTIONARY, MONTH_DICTIONARY } from \"../constants.js\";\nimport { findYearClosestToRef } from \"../../../calculation/years.js\";\nimport { matchAnyPattern } from \"../../../utils/pattern.js\";\nimport { YEAR_PATTERN, parseYear } from \"../constants.js\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nconst PATTERN = new RegExp(`((?:in)\\\\s*)?` +\n    `(${matchAnyPattern(MONTH_DICTIONARY)})` +\n    `\\\\s*` +\n    `(?:` +\n    `[,-]?\\\\s*(${YEAR_PATTERN})?` +\n    \")?\" +\n    \"(?=[^\\\\s\\\\w]|\\\\s+[^0-9]|\\\\s+$|$)\", \"i\");\nconst PREFIX_GROUP = 1;\nconst MONTH_NAME_GROUP = 2;\nconst YEAR_GROUP = 3;\nexport default class ENMonthNameParser extends AbstractParserWithWordBoundaryChecking {\n    innerPattern() {\n        return PATTERN;\n    }\n    innerExtract(context, match) {\n        const monthName = match[MONTH_NAME_GROUP].toLowerCase();\n        if (match[0].length <= 3 && !FULL_MONTH_NAME_DICTIONARY[monthName]) {\n            return null;\n        }\n        const result = context.createParsingResult(match.index + (match[PREFIX_GROUP] || \"\").length, match.index + match[0].length);\n        result.start.imply(\"day\", 1);\n        result.start.addTag(\"parser/ENMonthNameParser\");\n        const month = MONTH_DICTIONARY[monthName];\n        result.start.assign(\"month\", month);\n        if (match[YEAR_GROUP]) {\n            const year = parseYear(match[YEAR_GROUP]);\n            result.start.assign(\"year\", year);\n        }\n        else {\n            const year = findYearClosestToRef(context.refDate, 1, month);\n            result.start.imply(\"year\", year);\n        }\n        return result;\n    }\n}\n//# sourceMappingURL=ENMonthNameParser.js.map","import { MONTH_DICTIONARY } from \"../constants.js\";\nimport { matchAnyPattern } from \"../../../utils/pattern.js\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nconst PATTERN = new RegExp(`([0-9]{4})[-\\\\.\\\\/\\\\s]` +\n    `(?:(${matchAnyPattern(MONTH_DICTIONARY)})|([0-9]{1,2}))[-\\\\.\\\\/\\\\s]` +\n    `([0-9]{1,2})` +\n    \"(?=\\\\W|$)\", \"i\");\nconst YEAR_NUMBER_GROUP = 1;\nconst MONTH_NAME_GROUP = 2;\nconst MONTH_NUMBER_GROUP = 3;\nconst DATE_NUMBER_GROUP = 4;\nexport default class ENYearMonthDayParser extends AbstractParserWithWordBoundaryChecking {\n    constructor(strictMonthDateOrder) {\n        super();\n        this.strictMonthDateOrder = strictMonthDateOrder;\n    }\n    innerPattern() {\n        return PATTERN;\n    }\n    innerExtract(context, match) {\n        const year = parseInt(match[YEAR_NUMBER_GROUP]);\n        let day = parseInt(match[DATE_NUMBER_GROUP]);\n        let month = match[MONTH_NUMBER_GROUP]\n            ? parseInt(match[MONTH_NUMBER_GROUP])\n            : MONTH_DICTIONARY[match[MONTH_NAME_GROUP].toLowerCase()];\n        if (month < 1 || month > 12) {\n            if (this.strictMonthDateOrder) {\n                return null;\n            }\n            if (day >= 1 && day <= 12) {\n                [month, day] = [day, month];\n            }\n        }\n        if (day < 1 || day > 31) {\n            return null;\n        }\n        return {\n            day: day,\n            month: month,\n            year: year,\n        };\n    }\n}\n//# sourceMappingURL=ENYearMonthDayParser.js.map","import { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nconst PATTERN = new RegExp(\"([0-9]|0[1-9]|1[012])/([0-9]{4})\" + \"\", \"i\");\nconst MONTH_GROUP = 1;\nconst YEAR_GROUP = 2;\nexport default class ENSlashMonthFormatParser extends AbstractParserWithWordBoundaryChecking {\n    innerPattern() {\n        return PATTERN;\n    }\n    innerExtract(context, match) {\n        const year = parseInt(match[YEAR_GROUP]);\n        const month = parseInt(match[MONTH_GROUP]);\n        return context.createParsingComponents().imply(\"day\", 1).assign(\"month\", month).assign(\"year\", year);\n    }\n}\n//# sourceMappingURL=ENSlashMonthFormatParser.js.map","import { Meridiem } from \"../../types.js\";\nfunction primaryTimePattern(leftBoundary, primaryPrefix, primarySuffix, flags) {\n    return new RegExp(`${leftBoundary}` +\n        `${primaryPrefix}` +\n        `(\\\\d{1,4})` +\n        `(?:` +\n        `(?:\\\\.|:|：)` +\n        `(\\\\d{1,2})` +\n        `(?:` +\n        `(?::|：)` +\n        `(\\\\d{2})` +\n        `(?:\\\\.(\\\\d{1,6}))?` +\n        `)?` +\n        `)?` +\n        `(?:\\\\s*(a\\\\.m\\\\.|p\\\\.m\\\\.|am?|pm?))?` +\n        `${primarySuffix}`, flags);\n}\nfunction followingTimePatten(followingPhase, followingSuffix) {\n    return new RegExp(`^(${followingPhase})` +\n        `(\\\\d{1,4})` +\n        `(?:` +\n        `(?:\\\\.|\\\\:|\\\\：)` +\n        `(\\\\d{1,2})` +\n        `(?:` +\n        `(?:\\\\.|\\\\:|\\\\：)` +\n        `(\\\\d{1,2})(?:\\\\.(\\\\d{1,6}))?` +\n        `)?` +\n        `)?` +\n        `(?:\\\\s*(a\\\\.m\\\\.|p\\\\.m\\\\.|am?|pm?))?` +\n        `${followingSuffix}`, \"i\");\n}\nconst HOUR_GROUP = 2;\nconst MINUTE_GROUP = 3;\nconst SECOND_GROUP = 4;\nconst MILLI_SECOND_GROUP = 5;\nconst AM_PM_HOUR_GROUP = 6;\nexport class AbstractTimeExpressionParser {\n    constructor(strictMode = false) {\n        this.cachedPrimaryPrefix = null;\n        this.cachedPrimarySuffix = null;\n        this.cachedPrimaryTimePattern = null;\n        this.cachedFollowingPhase = null;\n        this.cachedFollowingSuffix = null;\n        this.cachedFollowingTimePatten = null;\n        this.strictMode = strictMode;\n    }\n    patternFlags() {\n        return \"i\";\n    }\n    primaryPatternLeftBoundary() {\n        return `(^|\\\\s|T|\\\\b)`;\n    }\n    primarySuffix() {\n        return `(?!/)(?=\\\\W|$)`;\n    }\n    followingSuffix() {\n        return `(?!/)(?=\\\\W|$)`;\n    }\n    pattern(context) {\n        return this.getPrimaryTimePatternThroughCache();\n    }\n    extract(context, match) {\n        const startComponents = this.extractPrimaryTimeComponents(context, match);\n        if (!startComponents) {\n            if (match[0].match(/^\\d{4}/)) {\n                match.index += 4;\n                return null;\n            }\n            match.index += match[0].length;\n            return null;\n        }\n        const index = match.index + match[1].length;\n        const text = match[0].substring(match[1].length);\n        const result = context.createParsingResult(index, text, startComponents);\n        match.index += match[0].length;\n        const remainingText = context.text.substring(match.index);\n        const followingPattern = this.getFollowingTimePatternThroughCache();\n        const followingMatch = followingPattern.exec(remainingText);\n        if (text.match(/^\\d{3,4}/) && followingMatch) {\n            if (followingMatch[0].match(/^\\s*([+-])\\s*\\d{2,4}$/)) {\n                return null;\n            }\n            if (followingMatch[0].match(/^\\s*([+-])\\s*\\d{2}\\W\\d{2}/)) {\n                return null;\n            }\n        }\n        if (!followingMatch ||\n            followingMatch[0].match(/^\\s*([+-])\\s*\\d{3,4}$/)) {\n            return this.checkAndReturnWithoutFollowingPattern(result);\n        }\n        result.end = this.extractFollowingTimeComponents(context, followingMatch, result);\n        if (result.end) {\n            result.text += followingMatch[0];\n        }\n        return this.checkAndReturnWithFollowingPattern(result);\n    }\n    extractPrimaryTimeComponents(context, match, strict = false) {\n        const components = context.createParsingComponents();\n        let minute = 0;\n        let meridiem = null;\n        let hour = parseInt(match[HOUR_GROUP]);\n        if (hour > 100) {\n            if (this.strictMode || match[MINUTE_GROUP] != null) {\n                return null;\n            }\n            minute = hour % 100;\n            hour = Math.floor(hour / 100);\n        }\n        if (hour > 24) {\n            return null;\n        }\n        if (match[MINUTE_GROUP] != null) {\n            if (match[MINUTE_GROUP].length == 1 && !match[AM_PM_HOUR_GROUP]) {\n                return null;\n            }\n            minute = parseInt(match[MINUTE_GROUP]);\n        }\n        if (minute >= 60) {\n            return null;\n        }\n        if (hour > 12) {\n            meridiem = Meridiem.PM;\n        }\n        if (match[AM_PM_HOUR_GROUP] != null) {\n            if (hour > 12)\n                return null;\n            const ampm = match[AM_PM_HOUR_GROUP][0].toLowerCase();\n            if (ampm == \"a\") {\n                meridiem = Meridiem.AM;\n                if (hour == 12) {\n                    hour = 0;\n                }\n            }\n            if (ampm == \"p\") {\n                meridiem = Meridiem.PM;\n                if (hour != 12) {\n                    hour += 12;\n                }\n            }\n        }\n        components.assign(\"hour\", hour);\n        components.assign(\"minute\", minute);\n        if (meridiem !== null) {\n            components.assign(\"meridiem\", meridiem);\n        }\n        else {\n            if (hour < 12) {\n                components.imply(\"meridiem\", Meridiem.AM);\n            }\n            else {\n                components.imply(\"meridiem\", Meridiem.PM);\n            }\n        }\n        if (match[MILLI_SECOND_GROUP] != null) {\n            const millisecond = parseInt(match[MILLI_SECOND_GROUP].substring(0, 3));\n            if (millisecond >= 1000)\n                return null;\n            components.assign(\"millisecond\", millisecond);\n        }\n        if (match[SECOND_GROUP] != null) {\n            const second = parseInt(match[SECOND_GROUP]);\n            if (second >= 60)\n                return null;\n            components.assign(\"second\", second);\n        }\n        return components;\n    }\n    extractFollowingTimeComponents(context, match, result) {\n        const components = context.createParsingComponents();\n        if (match[MILLI_SECOND_GROUP] != null) {\n            const millisecond = parseInt(match[MILLI_SECOND_GROUP].substring(0, 3));\n            if (millisecond >= 1000)\n                return null;\n            components.assign(\"millisecond\", millisecond);\n        }\n        if (match[SECOND_GROUP] != null) {\n            const second = parseInt(match[SECOND_GROUP]);\n            if (second >= 60)\n                return null;\n            components.assign(\"second\", second);\n        }\n        let hour = parseInt(match[HOUR_GROUP]);\n        let minute = 0;\n        let meridiem = -1;\n        if (match[MINUTE_GROUP] != null) {\n            minute = parseInt(match[MINUTE_GROUP]);\n        }\n        else if (hour > 100) {\n            minute = hour % 100;\n            hour = Math.floor(hour / 100);\n        }\n        if (minute >= 60 || hour > 24) {\n            return null;\n        }\n        if (hour >= 12) {\n            meridiem = Meridiem.PM;\n        }\n        if (match[AM_PM_HOUR_GROUP] != null) {\n            if (hour > 12) {\n                return null;\n            }\n            const ampm = match[AM_PM_HOUR_GROUP][0].toLowerCase();\n            if (ampm == \"a\") {\n                meridiem = Meridiem.AM;\n                if (hour == 12) {\n                    hour = 0;\n                    if (!components.isCertain(\"day\")) {\n                        components.imply(\"day\", components.get(\"day\") + 1);\n                    }\n                }\n            }\n            if (ampm == \"p\") {\n                meridiem = Meridiem.PM;\n                if (hour != 12)\n                    hour += 12;\n            }\n            if (!result.start.isCertain(\"meridiem\")) {\n                if (meridiem == Meridiem.AM) {\n                    result.start.imply(\"meridiem\", Meridiem.AM);\n                    if (result.start.get(\"hour\") == 12) {\n                        result.start.assign(\"hour\", 0);\n                    }\n                }\n                else {\n                    result.start.imply(\"meridiem\", Meridiem.PM);\n                    if (result.start.get(\"hour\") != 12) {\n                        result.start.assign(\"hour\", result.start.get(\"hour\") + 12);\n                    }\n                }\n            }\n        }\n        components.assign(\"hour\", hour);\n        components.assign(\"minute\", minute);\n        if (meridiem >= 0) {\n            components.assign(\"meridiem\", meridiem);\n        }\n        else {\n            const startAtPM = result.start.isCertain(\"meridiem\") && result.start.get(\"hour\") > 12;\n            if (startAtPM) {\n                if (result.start.get(\"hour\") - 12 > hour) {\n                    components.imply(\"meridiem\", Meridiem.AM);\n                }\n                else if (hour <= 12) {\n                    components.assign(\"hour\", hour + 12);\n                    components.assign(\"meridiem\", Meridiem.PM);\n                }\n            }\n            else if (hour > 12) {\n                components.imply(\"meridiem\", Meridiem.PM);\n            }\n            else if (hour <= 12) {\n                components.imply(\"meridiem\", Meridiem.AM);\n            }\n        }\n        if (components.date().getTime() < result.start.date().getTime()) {\n            components.imply(\"day\", components.get(\"day\") + 1);\n        }\n        return components;\n    }\n    checkAndReturnWithoutFollowingPattern(result) {\n        if (result.text.match(/^\\d$/)) {\n            return null;\n        }\n        if (result.text.match(/^\\d\\d\\d+$/)) {\n            return null;\n        }\n        if (result.text.match(/\\d[apAP]$/)) {\n            return null;\n        }\n        const endingWithNumbers = result.text.match(/[^\\d:.](\\d[\\d.]+)$/);\n        if (endingWithNumbers) {\n            const endingNumbers = endingWithNumbers[1];\n            if (this.strictMode) {\n                return null;\n            }\n            if (endingNumbers.includes(\".\") && !endingNumbers.match(/\\d(\\.\\d{2})+$/)) {\n                return null;\n            }\n            const endingNumberVal = parseInt(endingNumbers);\n            if (endingNumberVal > 24) {\n                return null;\n            }\n        }\n        return result;\n    }\n    checkAndReturnWithFollowingPattern(result) {\n        if (result.text.match(/^\\d+-\\d+$/)) {\n            return null;\n        }\n        const endingWithNumbers = result.text.match(/[^\\d:.](\\d[\\d.]+)\\s*-\\s*(\\d[\\d.]+)$/);\n        if (endingWithNumbers) {\n            if (this.strictMode) {\n                return null;\n            }\n            const startingNumbers = endingWithNumbers[1];\n            const endingNumbers = endingWithNumbers[2];\n            if (endingNumbers.includes(\".\") && !endingNumbers.match(/\\d(\\.\\d{2})+$/)) {\n                return null;\n            }\n            const endingNumberVal = parseInt(endingNumbers);\n            const startingNumberVal = parseInt(startingNumbers);\n            if (endingNumberVal > 24 || startingNumberVal > 24) {\n                return null;\n            }\n        }\n        return result;\n    }\n    getPrimaryTimePatternThroughCache() {\n        const primaryPrefix = this.primaryPrefix();\n        const primarySuffix = this.primarySuffix();\n        if (this.cachedPrimaryPrefix === primaryPrefix && this.cachedPrimarySuffix === primarySuffix) {\n            return this.cachedPrimaryTimePattern;\n        }\n        this.cachedPrimaryTimePattern = primaryTimePattern(this.primaryPatternLeftBoundary(), primaryPrefix, primarySuffix, this.patternFlags());\n        this.cachedPrimaryPrefix = primaryPrefix;\n        this.cachedPrimarySuffix = primarySuffix;\n        return this.cachedPrimaryTimePattern;\n    }\n    getFollowingTimePatternThroughCache() {\n        const followingPhase = this.followingPhase();\n        const followingSuffix = this.followingSuffix();\n        if (this.cachedFollowingPhase === followingPhase && this.cachedFollowingSuffix === followingSuffix) {\n            return this.cachedFollowingTimePatten;\n        }\n        this.cachedFollowingTimePatten = followingTimePatten(followingPhase, followingSuffix);\n        this.cachedFollowingPhase = followingPhase;\n        this.cachedFollowingSuffix = followingSuffix;\n        return this.cachedFollowingTimePatten;\n    }\n}\n//# sourceMappingURL=AbstractTimeExpressionParser.js.map","import { Meridiem } from \"../../../types.js\";\nimport { AbstractTimeExpressionParser } from \"../../../common/parsers/AbstractTimeExpressionParser.js\";\nexport default class ENTimeExpressionParser extends AbstractTimeExpressionParser {\n    constructor(strictMode) {\n        super(strictMode);\n    }\n    followingPhase() {\n        return \"\\\\s*(?:\\\\-|\\\\–|\\\\~|\\\\〜|to|until|through|till|\\\\?)\\\\s*\";\n    }\n    primaryPrefix() {\n        return \"(?:(?:at|from)\\\\s*)??\";\n    }\n    primarySuffix() {\n        return \"(?:\\\\s*(?:o\\\\W*clock|at\\\\s*night|in\\\\s*the\\\\s*(?:morning|afternoon)))?(?!/)(?=\\\\W|$)\";\n    }\n    extractPrimaryTimeComponents(context, match) {\n        const components = super.extractPrimaryTimeComponents(context, match);\n        if (!components) {\n            return components;\n        }\n        if (match[0].endsWith(\"night\")) {\n            const hour = components.get(\"hour\");\n            if (hour >= 6 && hour < 12) {\n                components.assign(\"hour\", components.get(\"hour\") + 12);\n                components.assign(\"meridiem\", Meridiem.PM);\n            }\n            else if (hour < 6) {\n                components.assign(\"meridiem\", Meridiem.AM);\n            }\n        }\n        if (match[0].endsWith(\"afternoon\")) {\n            components.assign(\"meridiem\", Meridiem.PM);\n            const hour = components.get(\"hour\");\n            if (hour >= 0 && hour <= 6) {\n                components.assign(\"hour\", components.get(\"hour\") + 12);\n            }\n        }\n        if (match[0].endsWith(\"morning\")) {\n            components.assign(\"meridiem\", Meridiem.AM);\n            const hour = components.get(\"hour\");\n            if (hour < 12) {\n                components.assign(\"hour\", components.get(\"hour\"));\n            }\n        }\n        return components.addTag(\"parser/ENTimeExpressionParser\");\n    }\n}\n//# sourceMappingURL=ENTimeExpressionParser.js.map","export function reverseTimeUnits(timeUnits) {\n    const reversed = {};\n    for (const key in timeUnits) {\n        reversed[key] = -timeUnits[key];\n    }\n    return reversed;\n}\nexport function addImpliedTimeUnits(components, timeUnits) {\n    const output = components.clone();\n    let date = components.dayjs();\n    for (const key in timeUnits) {\n        date = date.add(timeUnits[key], key);\n    }\n    if (\"day\" in timeUnits || \"d\" in timeUnits || \"week\" in timeUnits || \"month\" in timeUnits || \"year\" in timeUnits) {\n        output.imply(\"day\", date.date());\n        output.imply(\"month\", date.month() + 1);\n        output.imply(\"year\", date.year());\n    }\n    if (\"second\" in timeUnits || \"minute\" in timeUnits || \"hour\" in timeUnits) {\n        output.imply(\"second\", date.second());\n        output.imply(\"minute\", date.minute());\n        output.imply(\"hour\", date.hour());\n    }\n    return output;\n}\n//# sourceMappingURL=timeunits.js.map","import { parseTimeUnits, TIME_UNITS_NO_ABBR_PATTERN, TIME_UNITS_PATTERN } from \"../constants.js\";\nimport { ParsingComponents } from \"../../../results.js\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nimport { reverseTimeUnits } from \"../../../utils/timeunits.js\";\nconst PATTERN = new RegExp(`(${TIME_UNITS_PATTERN})\\\\s{0,5}(?:ago|before|earlier)(?=\\\\W|$)`, \"i\");\nconst STRICT_PATTERN = new RegExp(`(${TIME_UNITS_NO_ABBR_PATTERN})\\\\s{0,5}(?:ago|before|earlier)(?=\\\\W|$)`, \"i\");\nexport default class ENTimeUnitAgoFormatParser extends AbstractParserWithWordBoundaryChecking {\n    constructor(strictMode) {\n        super();\n        this.strictMode = strictMode;\n    }\n    innerPattern() {\n        return this.strictMode ? STRICT_PATTERN : PATTERN;\n    }\n    innerExtract(context, match) {\n        const timeUnits = parseTimeUnits(match[1]);\n        if (!timeUnits) {\n            return null;\n        }\n        const outputTimeUnits = reverseTimeUnits(timeUnits);\n        return ParsingComponents.createRelativeFromReference(context.reference, outputTimeUnits);\n    }\n}\n//# sourceMappingURL=ENTimeUnitAgoFormatParser.js.map","import { parseTimeUnits, TIME_UNITS_NO_ABBR_PATTERN, TIME_UNITS_PATTERN } from \"../constants.js\";\nimport { ParsingComponents } from \"../../../results.js\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nconst PATTERN = new RegExp(`(${TIME_UNITS_PATTERN})\\\\s{0,5}(?:later|after|from now|henceforth|forward|out)` + \"(?=(?:\\\\W|$))\", \"i\");\nconst STRICT_PATTERN = new RegExp(`(${TIME_UNITS_NO_ABBR_PATTERN})\\\\s{0,5}(later|after|from now)(?=\\\\W|$)`, \"i\");\nconst GROUP_NUM_TIMEUNITS = 1;\nexport default class ENTimeUnitLaterFormatParser extends AbstractParserWithWordBoundaryChecking {\n    constructor(strictMode) {\n        super();\n        this.strictMode = strictMode;\n    }\n    innerPattern() {\n        return this.strictMode ? STRICT_PATTERN : PATTERN;\n    }\n    innerExtract(context, match) {\n        const timeUnits = parseTimeUnits(match[GROUP_NUM_TIMEUNITS]);\n        if (!timeUnits) {\n            return null;\n        }\n        return ParsingComponents.createRelativeFromReference(context.reference, timeUnits);\n    }\n}\n//# sourceMappingURL=ENTimeUnitLaterFormatParser.js.map","export class Filter {\n    refine(context, results) {\n        return results.filter((r) => this.isValid(context, r));\n    }\n}\nexport class MergingRefiner {\n    refine(context, results) {\n        if (results.length < 2) {\n            return results;\n        }\n        const mergedResults = [];\n        let curResult = results[0];\n        let nextResult = null;\n        for (let i = 1; i < results.length; i++) {\n            nextResult = results[i];\n            const textBetween = context.text.substring(curResult.index + curResult.text.length, nextResult.index);\n            if (!this.shouldMergeResults(textBetween, curResult, nextResult, context)) {\n                mergedResults.push(curResult);\n                curResult = nextResult;\n            }\n            else {\n                const left = curResult;\n                const right = nextResult;\n                const mergedResult = this.mergeResults(textBetween, left, right, context);\n                context.debug(() => {\n                    console.log(`${this.constructor.name} merged ${left} and ${right} into ${mergedResult}`);\n                });\n                curResult = mergedResult;\n            }\n        }\n        if (curResult != null) {\n            mergedResults.push(curResult);\n        }\n        return mergedResults;\n    }\n}\n//# sourceMappingURL=abstractRefiners.js.map","import { MergingRefiner } from \"../abstractRefiners.js\";\nexport default class AbstractMergeDateRangeRefiner extends MergingRefiner {\n    shouldMergeResults(textBetween, currentResult, nextResult) {\n        return !currentResult.end && !nextResult.end && textBetween.match(this.patternBetween()) != null;\n    }\n    mergeResults(textBetween, fromResult, toResult) {\n        if (!fromResult.start.isOnlyWeekdayComponent() && !toResult.start.isOnlyWeekdayComponent()) {\n            toResult.start.getCertainComponents().forEach((key) => {\n                if (!fromResult.start.isCertain(key)) {\n                    fromResult.start.imply(key, toResult.start.get(key));\n                }\n            });\n            fromResult.start.getCertainComponents().forEach((key) => {\n                if (!toResult.start.isCertain(key)) {\n                    toResult.start.imply(key, fromResult.start.get(key));\n                }\n            });\n        }\n        if (fromResult.start.date().getTime() > toResult.start.date().getTime()) {\n            let fromMoment = fromResult.start.dayjs();\n            let toMoment = toResult.start.dayjs();\n            if (toResult.start.isOnlyWeekdayComponent() && toMoment.add(7, \"days\").isAfter(fromMoment)) {\n                toMoment = toMoment.add(7, \"days\");\n                toResult.start.imply(\"day\", toMoment.date());\n                toResult.start.imply(\"month\", toMoment.month() + 1);\n                toResult.start.imply(\"year\", toMoment.year());\n            }\n            else if (fromResult.start.isOnlyWeekdayComponent() && fromMoment.add(-7, \"days\").isBefore(toMoment)) {\n                fromMoment = fromMoment.add(-7, \"days\");\n                fromResult.start.imply(\"day\", fromMoment.date());\n                fromResult.start.imply(\"month\", fromMoment.month() + 1);\n                fromResult.start.imply(\"year\", fromMoment.year());\n            }\n            else if (toResult.start.isDateWithUnknownYear() && toMoment.add(1, \"years\").isAfter(fromMoment)) {\n                toMoment = toMoment.add(1, \"years\");\n                toResult.start.imply(\"year\", toMoment.year());\n            }\n            else if (fromResult.start.isDateWithUnknownYear() && fromMoment.add(-1, \"years\").isBefore(toMoment)) {\n                fromMoment = fromMoment.add(-1, \"years\");\n                fromResult.start.imply(\"year\", fromMoment.year());\n            }\n            else {\n                [toResult, fromResult] = [fromResult, toResult];\n            }\n        }\n        const result = fromResult.clone();\n        result.start = fromResult.start;\n        result.end = toResult.start;\n        result.index = Math.min(fromResult.index, toResult.index);\n        if (fromResult.index < toResult.index) {\n            result.text = fromResult.text + textBetween + toResult.text;\n        }\n        else {\n            result.text = toResult.text + textBetween + fromResult.text;\n        }\n        return result;\n    }\n}\n//# sourceMappingURL=AbstractMergeDateRangeRefiner.js.map","import AbstractMergeDateRangeRefiner from \"../../../common/refiners/AbstractMergeDateRangeRefiner.js\";\nexport default class ENMergeDateRangeRefiner extends AbstractMergeDateRangeRefiner {\n    patternBetween() {\n        return /^\\s*(to|-|–|until|through|till)\\s*$/i;\n    }\n}\n//# sourceMappingURL=ENMergeDateRangeRefiner.js.map","import { Meridiem } from \"../types.js\";\nimport { assignSimilarDate, implySimilarDate } from \"../utils/dayjs.js\";\nexport function mergeDateTimeResult(dateResult, timeResult) {\n    const result = dateResult.clone();\n    const beginDate = dateResult.start;\n    const beginTime = timeResult.start;\n    result.start = mergeDateTimeComponent(beginDate, beginTime);\n    if (dateResult.end != null || timeResult.end != null) {\n        const endDate = dateResult.end == null ? dateResult.start : dateResult.end;\n        const endTime = timeResult.end == null ? timeResult.start : timeResult.end;\n        const endDateTime = mergeDateTimeComponent(endDate, endTime);\n        if (dateResult.end == null && endDateTime.date().getTime() < result.start.date().getTime()) {\n            const nextDayJs = endDateTime.dayjs().add(1, \"day\");\n            if (endDateTime.isCertain(\"day\")) {\n                assignSimilarDate(endDateTime, nextDayJs);\n            }\n            else {\n                implySimilarDate(endDateTime, nextDayJs);\n            }\n        }\n        result.end = endDateTime;\n    }\n    return result;\n}\nexport function mergeDateTimeComponent(dateComponent, timeComponent) {\n    const dateTimeComponent = dateComponent.clone();\n    if (timeComponent.isCertain(\"hour\")) {\n        dateTimeComponent.assign(\"hour\", timeComponent.get(\"hour\"));\n        dateTimeComponent.assign(\"minute\", timeComponent.get(\"minute\"));\n        if (timeComponent.isCertain(\"second\")) {\n            dateTimeComponent.assign(\"second\", timeComponent.get(\"second\"));\n            if (timeComponent.isCertain(\"millisecond\")) {\n                dateTimeComponent.assign(\"millisecond\", timeComponent.get(\"millisecond\"));\n            }\n            else {\n                dateTimeComponent.imply(\"millisecond\", timeComponent.get(\"millisecond\"));\n            }\n        }\n        else {\n            dateTimeComponent.imply(\"second\", timeComponent.get(\"second\"));\n            dateTimeComponent.imply(\"millisecond\", timeComponent.get(\"millisecond\"));\n        }\n    }\n    else {\n        dateTimeComponent.imply(\"hour\", timeComponent.get(\"hour\"));\n        dateTimeComponent.imply(\"minute\", timeComponent.get(\"minute\"));\n        dateTimeComponent.imply(\"second\", timeComponent.get(\"second\"));\n        dateTimeComponent.imply(\"millisecond\", timeComponent.get(\"millisecond\"));\n    }\n    if (timeComponent.isCertain(\"timezoneOffset\")) {\n        dateTimeComponent.assign(\"timezoneOffset\", timeComponent.get(\"timezoneOffset\"));\n    }\n    if (timeComponent.isCertain(\"meridiem\")) {\n        dateTimeComponent.assign(\"meridiem\", timeComponent.get(\"meridiem\"));\n    }\n    else if (timeComponent.get(\"meridiem\") != null && dateTimeComponent.get(\"meridiem\") == null) {\n        dateTimeComponent.imply(\"meridiem\", timeComponent.get(\"meridiem\"));\n    }\n    if (dateTimeComponent.get(\"meridiem\") == Meridiem.PM && dateTimeComponent.get(\"hour\") < 12) {\n        if (timeComponent.isCertain(\"hour\")) {\n            dateTimeComponent.assign(\"hour\", dateTimeComponent.get(\"hour\") + 12);\n        }\n        else {\n            dateTimeComponent.imply(\"hour\", dateTimeComponent.get(\"hour\") + 12);\n        }\n    }\n    dateTimeComponent.addTags(dateComponent.tags());\n    dateTimeComponent.addTags(timeComponent.tags());\n    return dateTimeComponent;\n}\n//# sourceMappingURL=mergingCalculation.js.map","import { MergingRefiner } from \"../abstractRefiners.js\";\nimport { mergeDateTimeResult } from \"../../calculation/mergingCalculation.js\";\nexport default class AbstractMergeDateTimeRefiner extends MergingRefiner {\n    shouldMergeResults(textBetween, currentResult, nextResult) {\n        return (((currentResult.start.isOnlyDate() && nextResult.start.isOnlyTime()) ||\n            (nextResult.start.isOnlyDate() && currentResult.start.isOnlyTime())) &&\n            textBetween.match(this.patternBetween()) != null);\n    }\n    mergeResults(textBetween, currentResult, nextResult) {\n        const result = currentResult.start.isOnlyDate()\n            ? mergeDateTimeResult(currentResult, nextResult)\n            : mergeDateTimeResult(nextResult, currentResult);\n        result.index = currentResult.index;\n        result.text = currentResult.text + textBetween + nextResult.text;\n        return result;\n    }\n}\n//# sourceMappingURL=AbstractMergeDateTimeRefiner.js.map","import AbstractMergeDateTimeRefiner from \"../../../common/refiners/AbstractMergeDateTimeRefiner.js\";\nexport default class ENMergeDateTimeRefiner extends AbstractMergeDateTimeRefiner {\n    patternBetween() {\n        return new RegExp(\"^\\\\s*(T|at|after|before|on|of|,|-|\\\\.|∙|:)?\\\\s*$\");\n    }\n}\n//# sourceMappingURL=ENMergeDateTimeRefiner.js.map","import { toTimezoneOffset } from \"../../timezone.js\";\nconst TIMEZONE_NAME_PATTERN = new RegExp(\"^\\\\s*,?\\\\s*\\\\(?([A-Z]{2,4})\\\\)?(?=\\\\W|$)\", \"i\");\nexport default class ExtractTimezoneAbbrRefiner {\n    constructor(timezoneOverrides) {\n        this.timezoneOverrides = timezoneOverrides;\n    }\n    refine(context, results) {\n        const timezoneOverrides = context.option.timezones ?? {};\n        results.forEach((result) => {\n            const suffix = context.text.substring(result.index + result.text.length);\n            const match = TIMEZONE_NAME_PATTERN.exec(suffix);\n            if (!match) {\n                return;\n            }\n            const timezoneAbbr = match[1].toUpperCase();\n            const refDate = result.start.date() ?? result.refDate ?? new Date();\n            const tzOverrides = { ...this.timezoneOverrides, ...timezoneOverrides };\n            const extractedTimezoneOffset = toTimezoneOffset(timezoneAbbr, refDate, tzOverrides);\n            if (extractedTimezoneOffset == null) {\n                return;\n            }\n            context.debug(() => {\n                console.log(`Extracting timezone: '${timezoneAbbr}' into: ${extractedTimezoneOffset} for: ${result.start}`);\n            });\n            const currentTimezoneOffset = result.start.get(\"timezoneOffset\");\n            if (currentTimezoneOffset !== null && extractedTimezoneOffset != currentTimezoneOffset) {\n                if (result.start.isCertain(\"timezoneOffset\")) {\n                    return;\n                }\n                if (timezoneAbbr != match[1]) {\n                    return;\n                }\n            }\n            if (result.start.isOnlyDate()) {\n                if (timezoneAbbr != match[1]) {\n                    return;\n                }\n            }\n            result.text += match[0];\n            if (!result.start.isCertain(\"timezoneOffset\")) {\n                result.start.assign(\"timezoneOffset\", extractedTimezoneOffset);\n            }\n            if (result.end != null && !result.end.isCertain(\"timezoneOffset\")) {\n                result.end.assign(\"timezoneOffset\", extractedTimezoneOffset);\n            }\n        });\n        return results;\n    }\n}\n//# sourceMappingURL=ExtractTimezoneAbbrRefiner.js.map","const TIMEZONE_OFFSET_PATTERN = new RegExp(\"^\\\\s*(?:\\\\(?(?:GMT|UTC)\\\\s?)?([+-])(\\\\d{1,2})(?::?(\\\\d{2}))?\\\\)?\", \"i\");\nconst TIMEZONE_OFFSET_SIGN_GROUP = 1;\nconst TIMEZONE_OFFSET_HOUR_OFFSET_GROUP = 2;\nconst TIMEZONE_OFFSET_MINUTE_OFFSET_GROUP = 3;\nexport default class ExtractTimezoneOffsetRefiner {\n    refine(context, results) {\n        results.forEach(function (result) {\n            if (result.start.isCertain(\"timezoneOffset\")) {\n                return;\n            }\n            const suffix = context.text.substring(result.index + result.text.length);\n            const match = TIMEZONE_OFFSET_PATTERN.exec(suffix);\n            if (!match) {\n                return;\n            }\n            context.debug(() => {\n                console.log(`Extracting timezone: '${match[0]}' into : ${result}`);\n            });\n            const hourOffset = parseInt(match[TIMEZONE_OFFSET_HOUR_OFFSET_GROUP]);\n            const minuteOffset = parseInt(match[TIMEZONE_OFFSET_MINUTE_OFFSET_GROUP] || \"0\");\n            let timezoneOffset = hourOffset * 60 + minuteOffset;\n            if (timezoneOffset > 14 * 60) {\n                return;\n            }\n            if (match[TIMEZONE_OFFSET_SIGN_GROUP] === \"-\") {\n                timezoneOffset = -timezoneOffset;\n            }\n            if (result.end != null) {\n                result.end.assign(\"timezoneOffset\", timezoneOffset);\n            }\n            result.start.assign(\"timezoneOffset\", timezoneOffset);\n            result.text += match[0];\n        });\n        return results;\n    }\n}\n//# sourceMappingURL=ExtractTimezoneOffsetRefiner.js.map","export default class OverlapRemovalRefiner {\n    refine(context, results) {\n        if (results.length < 2) {\n            return results;\n        }\n        const filteredResults = [];\n        let prevResult = results[0];\n        for (let i = 1; i < results.length; i++) {\n            const result = results[i];\n            if (result.index >= prevResult.index + prevResult.text.length) {\n                filteredResults.push(prevResult);\n                prevResult = result;\n                continue;\n            }\n            let kept = null;\n            let removed = null;\n            if (result.text.length > prevResult.text.length) {\n                kept = result;\n                removed = prevResult;\n            }\n            else {\n                kept = prevResult;\n                removed = result;\n            }\n            context.debug(() => {\n                console.log(`${this.constructor.name} remove ${removed} by ${kept}`);\n            });\n            prevResult = kept;\n        }\n        if (prevResult != null) {\n            filteredResults.push(prevResult);\n        }\n        return filteredResults;\n    }\n}\n//# sourceMappingURL=OverlapRemovalRefiner.js.map","import dayjs from \"dayjs\";\nimport { implySimilarDate } from \"../../utils/dayjs.js\";\nexport default class ForwardDateRefiner {\n    refine(context, results) {\n        if (!context.option.forwardDate) {\n            return results;\n        }\n        results.forEach((result) => {\n            let refMoment = dayjs(context.refDate);\n            if (result.start.isOnlyTime() && refMoment.isAfter(result.start.dayjs())) {\n                refMoment = refMoment.add(1, \"day\");\n                implySimilarDate(result.start, refMoment);\n                if (result.end && result.end.isOnlyTime()) {\n                    implySimilarDate(result.end, refMoment);\n                    if (result.start.dayjs().isAfter(result.end.dayjs())) {\n                        refMoment = refMoment.add(1, \"day\");\n                        implySimilarDate(result.end, refMoment);\n                    }\n                }\n                context.debug(() => {\n                    console.log(`${this.constructor.name} adjusted ${result} time result (${result.start})`);\n                });\n            }\n            if (result.start.isOnlyWeekdayComponent() && refMoment.isAfter(result.start.dayjs())) {\n                if (refMoment.day() >= result.start.get(\"weekday\")) {\n                    refMoment = refMoment.day(result.start.get(\"weekday\") + 7);\n                }\n                else {\n                    refMoment = refMoment.day(result.start.get(\"weekday\"));\n                }\n                result.start.imply(\"day\", refMoment.date());\n                result.start.imply(\"month\", refMoment.month() + 1);\n                result.start.imply(\"year\", refMoment.year());\n                context.debug(() => {\n                    console.log(`${this.constructor.name} adjusted ${result} weekday (${result.start})`);\n                });\n                if (result.end && result.end.isOnlyWeekdayComponent()) {\n                    if (refMoment.day() > result.end.get(\"weekday\")) {\n                        refMoment = refMoment.day(result.end.get(\"weekday\") + 7);\n                    }\n                    else {\n                        refMoment = refMoment.day(result.end.get(\"weekday\"));\n                    }\n                    result.end.imply(\"day\", refMoment.date());\n                    result.end.imply(\"month\", refMoment.month() + 1);\n                    result.end.imply(\"year\", refMoment.year());\n                    context.debug(() => {\n                        console.log(`${this.constructor.name} adjusted ${result} weekday (${result.end})`);\n                    });\n                }\n            }\n            if (result.start.isDateWithUnknownYear() && refMoment.isAfter(result.start.dayjs())) {\n                for (let i = 0; i < 3 && refMoment.isAfter(result.start.dayjs()); i++) {\n                    result.start.imply(\"year\", result.start.get(\"year\") + 1);\n                    context.debug(() => {\n                        console.log(`${this.constructor.name} adjusted ${result} year (${result.start})`);\n                    });\n                    if (result.end && !result.end.isCertain(\"year\")) {\n                        result.end.imply(\"year\", result.end.get(\"year\") + 1);\n                        context.debug(() => {\n                            console.log(`${this.constructor.name} adjusted ${result} month (${result.start})`);\n                        });\n                    }\n                }\n            }\n        });\n        return results;\n    }\n}\n//# sourceMappingURL=ForwardDateRefiner.js.map","import { Filter } from \"../abstractRefiners.js\";\nexport default class UnlikelyFormatFilter extends Filter {\n    constructor(strictMode) {\n        super();\n        this.strictMode = strictMode;\n    }\n    isValid(context, result) {\n        if (result.text.replace(\" \", \"\").match(/^\\d*(\\.\\d*)?$/)) {\n            context.debug(() => {\n                console.log(`Removing unlikely result '${result.text}'`);\n            });\n            return false;\n        }\n        if (!result.start.isValidDate()) {\n            context.debug(() => {\n                console.log(`Removing invalid result: ${result} (${result.start})`);\n            });\n            return false;\n        }\n        if (result.end && !result.end.isValidDate()) {\n            context.debug(() => {\n                console.log(`Removing invalid result: ${result} (${result.end})`);\n            });\n            return false;\n        }\n        if (this.strictMode) {\n            return this.isStrictModeValid(context, result);\n        }\n        return true;\n    }\n    isStrictModeValid(context, result) {\n        if (result.start.isOnlyWeekdayComponent()) {\n            context.debug(() => {\n                console.log(`(Strict) Removing weekday only component: ${result} (${result.end})`);\n            });\n            return false;\n        }\n        if (result.start.isOnlyTime() && (!result.start.isCertain(\"hour\") || !result.start.isCertain(\"minute\"))) {\n            context.debug(() => {\n                console.log(`(Strict) Removing uncertain time component: ${result} (${result.end})`);\n            });\n            return false;\n        }\n        return true;\n    }\n}\n//# sourceMappingURL=UnlikelyFormatFilter.js.map","import { AbstractParserWithWordBoundaryChecking } from \"./AbstractParserWithWordBoundary.js\";\nconst PATTERN = new RegExp(\"([0-9]{4})\\\\-([0-9]{1,2})\\\\-([0-9]{1,2})\" +\n    \"(?:T\" +\n    \"([0-9]{1,2}):([0-9]{1,2})\" +\n    \"(?:\" +\n    \":([0-9]{1,2})(?:\\\\.(\\\\d{1,4}))?\" +\n    \")?\" +\n    \"(\" +\n    \"Z|([+-]\\\\d{2}):?(\\\\d{2})?\" +\n    \")?\" +\n    \")?\" +\n    \"(?=\\\\W|$)\", \"i\");\nconst YEAR_NUMBER_GROUP = 1;\nconst MONTH_NUMBER_GROUP = 2;\nconst DATE_NUMBER_GROUP = 3;\nconst HOUR_NUMBER_GROUP = 4;\nconst MINUTE_NUMBER_GROUP = 5;\nconst SECOND_NUMBER_GROUP = 6;\nconst MILLISECOND_NUMBER_GROUP = 7;\nconst TZD_GROUP = 8;\nconst TZD_HOUR_OFFSET_GROUP = 9;\nconst TZD_MINUTE_OFFSET_GROUP = 10;\nexport default class ISOFormatParser extends AbstractParserWithWordBoundaryChecking {\n    innerPattern() {\n        return PATTERN;\n    }\n    innerExtract(context, match) {\n        const components = context.createParsingComponents({\n            \"year\": parseInt(match[YEAR_NUMBER_GROUP]),\n            \"month\": parseInt(match[MONTH_NUMBER_GROUP]),\n            \"day\": parseInt(match[DATE_NUMBER_GROUP]),\n        });\n        if (match[HOUR_NUMBER_GROUP] != null) {\n            components.assign(\"hour\", parseInt(match[HOUR_NUMBER_GROUP]));\n            components.assign(\"minute\", parseInt(match[MINUTE_NUMBER_GROUP]));\n            if (match[SECOND_NUMBER_GROUP] != null) {\n                components.assign(\"second\", parseInt(match[SECOND_NUMBER_GROUP]));\n            }\n            if (match[MILLISECOND_NUMBER_GROUP] != null) {\n                components.assign(\"millisecond\", parseInt(match[MILLISECOND_NUMBER_GROUP]));\n            }\n            if (match[TZD_GROUP] != null) {\n                let offset = 0;\n                if (match[TZD_HOUR_OFFSET_GROUP]) {\n                    const hourOffset = parseInt(match[TZD_HOUR_OFFSET_GROUP]);\n                    let minuteOffset = 0;\n                    if (match[TZD_MINUTE_OFFSET_GROUP] != null) {\n                        minuteOffset = parseInt(match[TZD_MINUTE_OFFSET_GROUP]);\n                    }\n                    offset = hourOffset * 60;\n                    if (offset < 0) {\n                        offset -= minuteOffset;\n                    }\n                    else {\n                        offset += minuteOffset;\n                    }\n                }\n                components.assign(\"timezoneOffset\", offset);\n            }\n        }\n        return components.addTag(\"parser/ISOFormatParser\");\n    }\n}\n//# sourceMappingURL=ISOFormatParser.js.map","import { MergingRefiner } from \"../abstractRefiners.js\";\nexport default class MergeWeekdayComponentRefiner extends MergingRefiner {\n    mergeResults(textBetween, currentResult, nextResult) {\n        const newResult = nextResult.clone();\n        newResult.index = currentResult.index;\n        newResult.text = currentResult.text + textBetween + newResult.text;\n        newResult.start.assign(\"weekday\", currentResult.start.get(\"weekday\"));\n        if (newResult.end) {\n            newResult.end.assign(\"weekday\", currentResult.start.get(\"weekday\"));\n        }\n        return newResult;\n    }\n    shouldMergeResults(textBetween, currentResult, nextResult) {\n        const weekdayThenNormalDate = currentResult.start.isOnlyWeekdayComponent() &&\n            !currentResult.start.isCertain(\"hour\") &&\n            nextResult.start.isCertain(\"day\");\n        return weekdayThenNormalDate && textBetween.match(/^,?\\s*$/) != null;\n    }\n}\n//# sourceMappingURL=MergeWeekdayComponentRefiner.js.map","import { ParsingComponents } from \"../results.js\";\nimport dayjs from \"dayjs\";\nimport { assignSimilarDate, assignSimilarTime, implySimilarTime, implyTheNextDay, } from \"../utils/dayjs.js\";\nimport { Meridiem } from \"../types.js\";\nexport function now(reference) {\n    const targetDate = dayjs(reference.instant);\n    const component = new ParsingComponents(reference, {});\n    assignSimilarDate(component, targetDate);\n    assignSimilarTime(component, targetDate);\n    if (reference.timezoneOffset !== null) {\n        component.assign(\"timezoneOffset\", targetDate.utcOffset());\n    }\n    component.addTag(\"casualReference/now\");\n    return component;\n}\nexport function today(reference) {\n    const targetDate = dayjs(reference.instant);\n    const component = new ParsingComponents(reference, {});\n    assignSimilarDate(component, targetDate);\n    implySimilarTime(component, targetDate);\n    component.addTag(\"casualReference/today\");\n    return component;\n}\nexport function yesterday(reference) {\n    return theDayBefore(reference, 1).addTag(\"casualReference/yesterday\");\n}\nexport function theDayBefore(reference, numDay) {\n    return theDayAfter(reference, -numDay);\n}\nexport function tomorrow(reference) {\n    return theDayAfter(reference, 1).addTag(\"casualReference/tomorrow\");\n}\nexport function theDayAfter(reference, nDays) {\n    let targetDate = dayjs(reference.instant);\n    const component = new ParsingComponents(reference, {});\n    targetDate = targetDate.add(nDays, \"day\");\n    assignSimilarDate(component, targetDate);\n    implySimilarTime(component, targetDate);\n    return component;\n}\nexport function tonight(reference, implyHour = 22) {\n    const targetDate = dayjs(reference.instant);\n    const component = new ParsingComponents(reference, {});\n    assignSimilarDate(component, targetDate);\n    component.imply(\"hour\", implyHour);\n    component.imply(\"meridiem\", Meridiem.PM);\n    component.addTag(\"casualReference/tonight\");\n    return component;\n}\nexport function lastNight(reference, implyHour = 0) {\n    let targetDate = dayjs(reference.instant);\n    const component = new ParsingComponents(reference, {});\n    if (targetDate.hour() < 6) {\n        targetDate = targetDate.add(-1, \"day\");\n    }\n    assignSimilarDate(component, targetDate);\n    component.imply(\"hour\", implyHour);\n    return component;\n}\nexport function evening(reference, implyHour = 20) {\n    const component = new ParsingComponents(reference, {});\n    component.imply(\"meridiem\", Meridiem.PM);\n    component.imply(\"hour\", implyHour);\n    component.addTag(\"casualReference/evening\");\n    return component;\n}\nexport function yesterdayEvening(reference, implyHour = 20) {\n    let targetDate = dayjs(reference.instant);\n    const component = new ParsingComponents(reference, {});\n    targetDate = targetDate.add(-1, \"day\");\n    assignSimilarDate(component, targetDate);\n    component.imply(\"hour\", implyHour);\n    component.imply(\"meridiem\", Meridiem.PM);\n    component.addTag(\"casualReference/yesterday\");\n    component.addTag(\"casualReference/evening\");\n    return component;\n}\nexport function midnight(reference) {\n    const component = new ParsingComponents(reference, {});\n    const targetDate = dayjs(reference.instant);\n    if (targetDate.hour() > 2) {\n        implyTheNextDay(component, targetDate);\n    }\n    component.assign(\"hour\", 0);\n    component.imply(\"minute\", 0);\n    component.imply(\"second\", 0);\n    component.imply(\"millisecond\", 0);\n    component.addTag(\"casualReference/midnight\");\n    return component;\n}\nexport function morning(reference, implyHour = 6) {\n    const component = new ParsingComponents(reference, {});\n    component.imply(\"meridiem\", Meridiem.AM);\n    component.imply(\"hour\", implyHour);\n    component.imply(\"minute\", 0);\n    component.imply(\"second\", 0);\n    component.imply(\"millisecond\", 0);\n    component.addTag(\"casualReference/morning\");\n    return component;\n}\nexport function afternoon(reference, implyHour = 15) {\n    const component = new ParsingComponents(reference, {});\n    component.imply(\"meridiem\", Meridiem.PM);\n    component.imply(\"hour\", implyHour);\n    component.imply(\"minute\", 0);\n    component.imply(\"second\", 0);\n    component.imply(\"millisecond\", 0);\n    component.addTag(\"casualReference/afternoon\");\n    return component;\n}\nexport function noon(reference) {\n    const component = new ParsingComponents(reference, {});\n    component.imply(\"meridiem\", Meridiem.AM);\n    component.imply(\"hour\", 12);\n    component.imply(\"minute\", 0);\n    component.imply(\"second\", 0);\n    component.imply(\"millisecond\", 0);\n    component.addTag(\"casualReference/noon\");\n    return component;\n}\n//# sourceMappingURL=casualReferences.js.map","import dayjs from \"dayjs\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nimport { assignSimilarDate } from \"../../../utils/dayjs.js\";\nimport * as references from \"../../../common/casualReferences.js\";\nconst PATTERN = /(now|today|tonight|tomorrow|tmr|tmrw|yesterday|last\\s*night)(?=\\W|$)/i;\nexport default class ENCasualDateParser extends AbstractParserWithWordBoundaryChecking {\n    innerPattern(context) {\n        return PATTERN;\n    }\n    innerExtract(context, match) {\n        let targetDate = dayjs(context.refDate);\n        const lowerText = match[0].toLowerCase();\n        let component = context.createParsingComponents();\n        switch (lowerText) {\n            case \"now\":\n                component = references.now(context.reference);\n                break;\n            case \"today\":\n                component = references.today(context.reference);\n                break;\n            case \"yesterday\":\n                component = references.yesterday(context.reference);\n                break;\n            case \"tomorrow\":\n            case \"tmr\":\n            case \"tmrw\":\n                component = references.tomorrow(context.reference);\n                break;\n            case \"tonight\":\n                component = references.tonight(context.reference);\n                break;\n            default:\n                if (lowerText.match(/last\\s*night/)) {\n                    if (targetDate.hour() > 6) {\n                        targetDate = targetDate.add(-1, \"day\");\n                    }\n                    assignSimilarDate(component, targetDate);\n                    component.imply(\"hour\", 0);\n                }\n                break;\n        }\n        component.addTag(\"parser/ENCasualDateParser\");\n        return component;\n    }\n}\n//# sourceMappingURL=ENCasualDateParser.js.map","import { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nimport * as casualReferences from \"../../../common/casualReferences.js\";\nconst PATTERN = /(?:this)?\\s{0,3}(morning|afternoon|evening|night|midnight|midday|noon)(?=\\W|$)/i;\nexport default class ENCasualTimeParser extends AbstractParserWithWordBoundaryChecking {\n    innerPattern() {\n        return PATTERN;\n    }\n    innerExtract(context, match) {\n        let component = null;\n        switch (match[1].toLowerCase()) {\n            case \"afternoon\":\n                component = casualReferences.afternoon(context.reference);\n                break;\n            case \"evening\":\n            case \"night\":\n                component = casualReferences.evening(context.reference);\n                break;\n            case \"midnight\":\n                component = casualReferences.midnight(context.reference);\n                break;\n            case \"morning\":\n                component = casualReferences.morning(context.reference);\n                break;\n            case \"noon\":\n            case \"midday\":\n                component = casualReferences.noon(context.reference);\n                break;\n        }\n        if (component) {\n            component.addTag(\"parser/ENCasualTimeParser\");\n        }\n        return component;\n    }\n}\n//# sourceMappingURL=ENCasualTimeParser.js.map","import { Weekday } from \"../../types.js\";\nimport { ParsingComponents } from \"../../results.js\";\nimport { addImpliedTimeUnits } from \"../../utils/timeunits.js\";\nexport function createParsingComponentsAtWeekday(reference, weekday, modifier) {\n    const refDate = reference.getDateWithAdjustedTimezone();\n    const daysToWeekday = getDaysToWeekday(refDate, weekday, modifier);\n    let components = new ParsingComponents(reference);\n    components = addImpliedTimeUnits(components, { \"day\": daysToWeekday });\n    components.assign(\"weekday\", weekday);\n    return components;\n}\nexport function getDaysToWeekday(refDate, weekday, modifier) {\n    const refWeekday = refDate.getDay();\n    switch (modifier) {\n        case \"this\":\n            return getDaysForwardToWeekday(refDate, weekday);\n        case \"last\":\n            return getBackwardDaysToWeekday(refDate, weekday);\n        case \"next\":\n            if (refWeekday == Weekday.SUNDAY) {\n                return weekday == Weekday.SUNDAY ? 7 : weekday;\n            }\n            if (refWeekday == Weekday.SATURDAY) {\n                if (weekday == Weekday.SATURDAY)\n                    return 7;\n                if (weekday == Weekday.SUNDAY)\n                    return 8;\n                return 1 + weekday;\n            }\n            if (weekday < refWeekday && weekday != Weekday.SUNDAY) {\n                return getDaysForwardToWeekday(refDate, weekday);\n            }\n            else {\n                return getDaysForwardToWeekday(refDate, weekday) + 7;\n            }\n    }\n    return getDaysToWeekdayClosest(refDate, weekday);\n}\nexport function getDaysToWeekdayClosest(refDate, weekday) {\n    const backward = getBackwardDaysToWeekday(refDate, weekday);\n    const forward = getDaysForwardToWeekday(refDate, weekday);\n    return forward < -backward ? forward : backward;\n}\nexport function getDaysForwardToWeekday(refDate, weekday) {\n    const refWeekday = refDate.getDay();\n    let forwardCount = weekday - refWeekday;\n    if (forwardCount < 0) {\n        forwardCount += 7;\n    }\n    return forwardCount;\n}\nexport function getBackwardDaysToWeekday(refDate, weekday) {\n    const refWeekday = refDate.getDay();\n    let backwardCount = weekday - refWeekday;\n    if (backwardCount >= 0) {\n        backwardCount -= 7;\n    }\n    return backwardCount;\n}\n//# sourceMappingURL=weekdays.js.map","import { WEEKDAY_DICTIONARY } from \"../constants.js\";\nimport { matchAnyPattern } from \"../../../utils/pattern.js\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nimport { createParsingComponentsAtWeekday } from \"../../../common/calculation/weekdays.js\";\nconst PATTERN = new RegExp(\"(?:(?:\\\\,|\\\\(|\\\\（)\\\\s*)?\" +\n    \"(?:on\\\\s*?)?\" +\n    \"(?:(this|last|past|next)\\\\s*)?\" +\n    `(${matchAnyPattern(WEEKDAY_DICTIONARY)})` +\n    \"(?:\\\\s*(?:\\\\,|\\\\)|\\\\）))?\" +\n    \"(?:\\\\s*(this|last|past|next)\\\\s*week)?\" +\n    \"(?=\\\\W|$)\", \"i\");\nconst PREFIX_GROUP = 1;\nconst WEEKDAY_GROUP = 2;\nconst POSTFIX_GROUP = 3;\nexport default class ENWeekdayParser extends AbstractParserWithWordBoundaryChecking {\n    innerPattern() {\n        return PATTERN;\n    }\n    innerExtract(context, match) {\n        const dayOfWeek = match[WEEKDAY_GROUP].toLowerCase();\n        const weekday = WEEKDAY_DICTIONARY[dayOfWeek];\n        const prefix = match[PREFIX_GROUP];\n        const postfix = match[POSTFIX_GROUP];\n        let modifierWord = prefix || postfix;\n        modifierWord = modifierWord || \"\";\n        modifierWord = modifierWord.toLowerCase();\n        let modifier = null;\n        if (modifierWord == \"last\" || modifierWord == \"past\") {\n            modifier = \"last\";\n        }\n        else if (modifierWord == \"next\") {\n            modifier = \"next\";\n        }\n        else if (modifierWord == \"this\") {\n            modifier = \"this\";\n        }\n        return createParsingComponentsAtWeekday(context.reference, weekday, modifier);\n    }\n}\n//# sourceMappingURL=ENWeekdayParser.js.map","import { TIME_UNIT_DICTIONARY } from \"../constants.js\";\nimport { ParsingComponents } from \"../../../results.js\";\nimport dayjs from \"dayjs\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nimport { matchAnyPattern } from \"../../../utils/pattern.js\";\nconst PATTERN = new RegExp(`(this|last|past|next|after\\\\s*this)\\\\s*(${matchAnyPattern(TIME_UNIT_DICTIONARY)})(?=\\\\s*)` + \"(?=\\\\W|$)\", \"i\");\nconst MODIFIER_WORD_GROUP = 1;\nconst RELATIVE_WORD_GROUP = 2;\nexport default class ENRelativeDateFormatParser extends AbstractParserWithWordBoundaryChecking {\n    innerPattern() {\n        return PATTERN;\n    }\n    innerExtract(context, match) {\n        const modifier = match[MODIFIER_WORD_GROUP].toLowerCase();\n        const unitWord = match[RELATIVE_WORD_GROUP].toLowerCase();\n        const timeunit = TIME_UNIT_DICTIONARY[unitWord];\n        if (modifier == \"next\" || modifier.startsWith(\"after\")) {\n            const timeUnits = {};\n            timeUnits[timeunit] = 1;\n            return ParsingComponents.createRelativeFromReference(context.reference, timeUnits);\n        }\n        if (modifier == \"last\" || modifier == \"past\") {\n            const timeUnits = {};\n            timeUnits[timeunit] = -1;\n            return ParsingComponents.createRelativeFromReference(context.reference, timeUnits);\n        }\n        const components = context.createParsingComponents();\n        let date = dayjs(context.reference.instant);\n        if (unitWord.match(/week/i)) {\n            date = date.add(-date.get(\"d\"), \"d\");\n            components.imply(\"day\", date.date());\n            components.imply(\"month\", date.month() + 1);\n            components.imply(\"year\", date.year());\n        }\n        else if (unitWord.match(/month/i)) {\n            date = date.add(-date.date() + 1, \"d\");\n            components.imply(\"day\", date.date());\n            components.assign(\"year\", date.year());\n            components.assign(\"month\", date.month() + 1);\n        }\n        else if (unitWord.match(/year/i)) {\n            date = date.add(-date.date() + 1, \"d\");\n            date = date.add(-date.month(), \"month\");\n            components.imply(\"day\", date.date());\n            components.imply(\"month\", date.month() + 1);\n            components.assign(\"year\", date.year());\n        }\n        return components;\n    }\n}\n//# sourceMappingURL=ENRelativeDateFormatParser.js.map","import { findMostLikelyADYear, findYearClosestToRef } from \"../../calculation/years.js\";\nconst PATTERN = new RegExp(\"([^\\\\d]|^)\" +\n    \"([0-3]{0,1}[0-9]{1})[\\\\/\\\\.\\\\-]([0-3]{0,1}[0-9]{1})\" +\n    \"(?:[\\\\/\\\\.\\\\-]([0-9]{4}|[0-9]{2}))?\" +\n    \"(\\\\W|$)\", \"i\");\nconst OPENING_GROUP = 1;\nconst ENDING_GROUP = 5;\nconst FIRST_NUMBERS_GROUP = 2;\nconst SECOND_NUMBERS_GROUP = 3;\nconst YEAR_GROUP = 4;\nexport default class SlashDateFormatParser {\n    constructor(littleEndian) {\n        this.groupNumberMonth = littleEndian ? SECOND_NUMBERS_GROUP : FIRST_NUMBERS_GROUP;\n        this.groupNumberDay = littleEndian ? FIRST_NUMBERS_GROUP : SECOND_NUMBERS_GROUP;\n    }\n    pattern() {\n        return PATTERN;\n    }\n    extract(context, match) {\n        const index = match.index + match[OPENING_GROUP].length;\n        const indexEnd = match.index + match[0].length - match[ENDING_GROUP].length;\n        if (index > 0) {\n            const textBefore = context.text.substring(0, index);\n            if (textBefore.match(\"\\\\d/?$\")) {\n                return;\n            }\n        }\n        if (indexEnd < context.text.length) {\n            const textAfter = context.text.substring(indexEnd);\n            if (textAfter.match(\"^/?\\\\d\")) {\n                return;\n            }\n        }\n        const text = context.text.substring(index, indexEnd);\n        if (text.match(/^\\d\\.\\d$/) || text.match(/^\\d\\.\\d{1,2}\\.\\d{1,2}\\s*$/)) {\n            return;\n        }\n        if (!match[YEAR_GROUP] && text.indexOf(\"/\") < 0) {\n            return;\n        }\n        const result = context.createParsingResult(index, text);\n        let month = parseInt(match[this.groupNumberMonth]);\n        let day = parseInt(match[this.groupNumberDay]);\n        if (month < 1 || month > 12) {\n            if (month > 12) {\n                if (day >= 1 && day <= 12 && month <= 31) {\n                    [day, month] = [month, day];\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n        if (day < 1 || day > 31) {\n            return null;\n        }\n        result.start.assign(\"day\", day);\n        result.start.assign(\"month\", month);\n        if (match[YEAR_GROUP]) {\n            const rawYearNumber = parseInt(match[YEAR_GROUP]);\n            const year = findMostLikelyADYear(rawYearNumber);\n            result.start.assign(\"year\", year);\n        }\n        else {\n            const year = findYearClosestToRef(context.refDate, day, month);\n            result.start.imply(\"year\", year);\n        }\n        return result;\n    }\n}\n//# sourceMappingURL=SlashDateFormatParser.js.map","import { TIME_UNITS_PATTERN, parseTimeUnits, TIME_UNITS_NO_ABBR_PATTERN } from \"../constants.js\";\nimport { ParsingComponents } from \"../../../results.js\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../common/parsers/AbstractParserWithWordBoundary.js\";\nimport { reverseTimeUnits } from \"../../../utils/timeunits.js\";\nconst PATTERN = new RegExp(`(this|last|past|next|after|\\\\+|-)\\\\s*(${TIME_UNITS_PATTERN})(?=\\\\W|$)`, \"i\");\nconst PATTERN_NO_ABBR = new RegExp(`(this|last|past|next|after|\\\\+|-)\\\\s*(${TIME_UNITS_NO_ABBR_PATTERN})(?=\\\\W|$)`, \"i\");\nexport default class ENTimeUnitCasualRelativeFormatParser extends AbstractParserWithWordBoundaryChecking {\n    constructor(allowAbbreviations = true) {\n        super();\n        this.allowAbbreviations = allowAbbreviations;\n    }\n    innerPattern() {\n        return this.allowAbbreviations ? PATTERN : PATTERN_NO_ABBR;\n    }\n    innerExtract(context, match) {\n        const prefix = match[1].toLowerCase();\n        let timeUnits = parseTimeUnits(match[2]);\n        if (!timeUnits) {\n            return null;\n        }\n        switch (prefix) {\n            case \"last\":\n            case \"past\":\n            case \"-\":\n                timeUnits = reverseTimeUnits(timeUnits);\n                break;\n        }\n        return ParsingComponents.createRelativeFromReference(context.reference, timeUnits);\n    }\n}\n//# sourceMappingURL=ENTimeUnitCasualRelativeFormatParser.js.map","import { MergingRefiner } from \"../../../common/abstractRefiners.js\";\nimport { ParsingComponents, ParsingResult, ReferenceWithTimezone } from \"../../../results.js\";\nimport { parseTimeUnits } from \"../constants.js\";\nimport { reverseTimeUnits } from \"../../../utils/timeunits.js\";\nfunction IsPositiveFollowingReference(result) {\n    return result.text.match(/^[+-]/i) != null;\n}\nfunction IsNegativeFollowingReference(result) {\n    return result.text.match(/^-/i) != null;\n}\nexport default class ENMergeRelativeAfterDateRefiner extends MergingRefiner {\n    shouldMergeResults(textBetween, currentResult, nextResult) {\n        if (!textBetween.match(/^\\s*$/i)) {\n            return false;\n        }\n        return IsPositiveFollowingReference(nextResult) || IsNegativeFollowingReference(nextResult);\n    }\n    mergeResults(textBetween, currentResult, nextResult, context) {\n        let timeUnits = parseTimeUnits(nextResult.text);\n        if (IsNegativeFollowingReference(nextResult)) {\n            timeUnits = reverseTimeUnits(timeUnits);\n        }\n        const components = ParsingComponents.createRelativeFromReference(new ReferenceWithTimezone(currentResult.start.date()), timeUnits);\n        return new ParsingResult(currentResult.reference, currentResult.index, `${currentResult.text}${textBetween}${nextResult.text}`, components);\n    }\n}\n//# sourceMappingURL=ENMergeRelativeAfterDateRefiner.js.map","import { MergingRefiner } from \"../../../common/abstractRefiners.js\";\nimport { ParsingComponents, ParsingResult, ReferenceWithTimezone } from \"../../../results.js\";\nimport { parseTimeUnits } from \"../constants.js\";\nimport { reverseTimeUnits } from \"../../../utils/timeunits.js\";\nfunction hasImpliedEarlierReferenceDate(result) {\n    return result.text.match(/\\s+(before|from)$/i) != null;\n}\nfunction hasImpliedLaterReferenceDate(result) {\n    return result.text.match(/\\s+(after|since)$/i) != null;\n}\nexport default class ENMergeRelativeFollowByDateRefiner extends MergingRefiner {\n    patternBetween() {\n        return /^\\s*$/i;\n    }\n    shouldMergeResults(textBetween, currentResult, nextResult) {\n        if (!textBetween.match(this.patternBetween())) {\n            return false;\n        }\n        if (!hasImpliedEarlierReferenceDate(currentResult) && !hasImpliedLaterReferenceDate(currentResult)) {\n            return false;\n        }\n        return !!nextResult.start.get(\"day\") && !!nextResult.start.get(\"month\") && !!nextResult.start.get(\"year\");\n    }\n    mergeResults(textBetween, currentResult, nextResult) {\n        let timeUnits = parseTimeUnits(currentResult.text);\n        if (hasImpliedEarlierReferenceDate(currentResult)) {\n            timeUnits = reverseTimeUnits(timeUnits);\n        }\n        const components = ParsingComponents.createRelativeFromReference(new ReferenceWithTimezone(nextResult.start.date()), timeUnits);\n        return new ParsingResult(nextResult.reference, currentResult.index, `${currentResult.text}${textBetween}${nextResult.text}`, components);\n    }\n}\n//# sourceMappingURL=ENMergeRelativeFollowByDateRefiner.js.map","import { YEAR_PATTERN, parseYear } from \"../constants.js\";\nconst YEAR_SUFFIX_PATTERN = new RegExp(`^\\\\s*(${YEAR_PATTERN})`, \"i\");\nconst YEAR_GROUP = 1;\nexport default class ENExtractYearSuffixRefiner {\n    refine(context, results) {\n        results.forEach(function (result) {\n            if (!result.start.isDateWithUnknownYear()) {\n                return;\n            }\n            const suffix = context.text.substring(result.index + result.text.length);\n            const match = YEAR_SUFFIX_PATTERN.exec(suffix);\n            if (!match) {\n                return;\n            }\n            context.debug(() => {\n                console.log(`Extracting year: '${match[0]}' into : ${result}`);\n            });\n            const year = parseYear(match[YEAR_GROUP]);\n            if (result.end != null) {\n                result.end.assign(\"year\", year);\n            }\n            result.start.assign(\"year\", year);\n            result.text += match[0];\n        });\n        return results;\n    }\n}\n//# sourceMappingURL=ENExtractYearSuffixRefiner.js.map","import ENTimeUnitWithinFormatParser from \"./parsers/ENTimeUnitWithinFormatParser.js\";\nimport ENMonthNameLittleEndianParser from \"./parsers/ENMonthNameLittleEndianParser.js\";\nimport ENMonthNameMiddleEndianParser from \"./parsers/ENMonthNameMiddleEndianParser.js\";\nimport ENMonthNameParser from \"./parsers/ENMonthNameParser.js\";\nimport ENYearMonthDayParser from \"./parsers/ENYearMonthDayParser.js\";\nimport ENSlashMonthFormatParser from \"./parsers/ENSlashMonthFormatParser.js\";\nimport ENTimeExpressionParser from \"./parsers/ENTimeExpressionParser.js\";\nimport ENTimeUnitAgoFormatParser from \"./parsers/ENTimeUnitAgoFormatParser.js\";\nimport ENTimeUnitLaterFormatParser from \"./parsers/ENTimeUnitLaterFormatParser.js\";\nimport ENMergeDateRangeRefiner from \"./refiners/ENMergeDateRangeRefiner.js\";\nimport ENMergeDateTimeRefiner from \"./refiners/ENMergeDateTimeRefiner.js\";\nimport { includeCommonConfiguration } from \"../../configurations.js\";\nimport ENCasualDateParser from \"./parsers/ENCasualDateParser.js\";\nimport ENCasualTimeParser from \"./parsers/ENCasualTimeParser.js\";\nimport ENWeekdayParser from \"./parsers/ENWeekdayParser.js\";\nimport ENRelativeDateFormatParser from \"./parsers/ENRelativeDateFormatParser.js\";\nimport SlashDateFormatParser from \"../../common/parsers/SlashDateFormatParser.js\";\nimport ENTimeUnitCasualRelativeFormatParser from \"./parsers/ENTimeUnitCasualRelativeFormatParser.js\";\nimport ENMergeRelativeAfterDateRefiner from \"./refiners/ENMergeRelativeAfterDateRefiner.js\";\nimport ENMergeRelativeFollowByDateRefiner from \"./refiners/ENMergeRelativeFollowByDateRefiner.js\";\nimport OverlapRemovalRefiner from \"../../common/refiners/OverlapRemovalRefiner.js\";\nimport ENExtractYearSuffixRefiner from \"./refiners/ENExtractYearSuffixRefiner.js\";\nexport default class ENDefaultConfiguration {\n    createCasualConfiguration(littleEndian = false) {\n        const option = this.createConfiguration(false, littleEndian);\n        option.parsers.push(new ENCasualDateParser());\n        option.parsers.push(new ENCasualTimeParser());\n        option.parsers.push(new ENMonthNameParser());\n        option.parsers.push(new ENRelativeDateFormatParser());\n        option.parsers.push(new ENTimeUnitCasualRelativeFormatParser());\n        return option;\n    }\n    createConfiguration(strictMode = true, littleEndian = false) {\n        const options = includeCommonConfiguration({\n            parsers: [\n                new SlashDateFormatParser(littleEndian),\n                new ENTimeUnitWithinFormatParser(strictMode),\n                new ENMonthNameLittleEndianParser(),\n                new ENMonthNameMiddleEndianParser(littleEndian),\n                new ENWeekdayParser(),\n                new ENSlashMonthFormatParser(),\n                new ENTimeExpressionParser(strictMode),\n                new ENTimeUnitAgoFormatParser(strictMode),\n                new ENTimeUnitLaterFormatParser(strictMode),\n            ],\n            refiners: [new ENMergeDateTimeRefiner()],\n        }, strictMode);\n        options.parsers.unshift(new ENYearMonthDayParser(strictMode));\n        options.refiners.unshift(new ENMergeRelativeFollowByDateRefiner());\n        options.refiners.unshift(new ENMergeRelativeAfterDateRefiner());\n        options.refiners.unshift(new OverlapRemovalRefiner());\n        options.refiners.push(new ENMergeDateTimeRefiner());\n        options.refiners.push(new ENExtractYearSuffixRefiner());\n        options.refiners.push(new ENMergeDateRangeRefiner());\n        return options;\n    }\n}\n//# sourceMappingURL=configuration.js.map","import ExtractTimezoneAbbrRefiner from \"./common/refiners/ExtractTimezoneAbbrRefiner.js\";\nimport ExtractTimezoneOffsetRefiner from \"./common/refiners/ExtractTimezoneOffsetRefiner.js\";\nimport OverlapRemovalRefiner from \"./common/refiners/OverlapRemovalRefiner.js\";\nimport ForwardDateRefiner from \"./common/refiners/ForwardDateRefiner.js\";\nimport UnlikelyFormatFilter from \"./common/refiners/UnlikelyFormatFilter.js\";\nimport ISOFormatParser from \"./common/parsers/ISOFormatParser.js\";\nimport MergeWeekdayComponentRefiner from \"./common/refiners/MergeWeekdayComponentRefiner.js\";\nexport function includeCommonConfiguration(configuration, strictMode = false) {\n    configuration.parsers.unshift(new ISOFormatParser());\n    configuration.refiners.unshift(new MergeWeekdayComponentRefiner());\n    configuration.refiners.unshift(new ExtractTimezoneOffsetRefiner());\n    configuration.refiners.unshift(new OverlapRemovalRefiner());\n    configuration.refiners.push(new ExtractTimezoneAbbrRefiner());\n    configuration.refiners.push(new OverlapRemovalRefiner());\n    configuration.refiners.push(new ForwardDateRefiner());\n    configuration.refiners.push(new UnlikelyFormatFilter(strictMode));\n    return configuration;\n}\n//# sourceMappingURL=configurations.js.map","import { ReferenceWithTimezone, ParsingComponents, ParsingResult } from \"./results.js\";\nimport ENDefaultConfiguration from \"./locales/en/configuration.js\";\nexport class Chrono {\n    constructor(configuration) {\n        this.defaultConfig = new ENDefaultConfiguration();\n        configuration = configuration || this.defaultConfig.createCasualConfiguration();\n        this.parsers = [...configuration.parsers];\n        this.refiners = [...configuration.refiners];\n    }\n    clone() {\n        return new Chrono({\n            parsers: [...this.parsers],\n            refiners: [...this.refiners],\n        });\n    }\n    parseDate(text, referenceDate, option) {\n        const results = this.parse(text, referenceDate, option);\n        return results.length > 0 ? results[0].start.date() : null;\n    }\n    parse(text, referenceDate, option) {\n        const context = new ParsingContext(text, referenceDate, option);\n        let results = [];\n        this.parsers.forEach((parser) => {\n            const parsedResults = Chrono.executeParser(context, parser);\n            results = results.concat(parsedResults);\n        });\n        results.sort((a, b) => {\n            return a.index - b.index;\n        });\n        this.refiners.forEach(function (refiner) {\n            results = refiner.refine(context, results);\n        });\n        return results;\n    }\n    static executeParser(context, parser) {\n        const results = [];\n        const pattern = parser.pattern(context);\n        const originalText = context.text;\n        let remainingText = context.text;\n        let match = pattern.exec(remainingText);\n        while (match) {\n            const index = match.index + originalText.length - remainingText.length;\n            match.index = index;\n            const result = parser.extract(context, match);\n            if (!result) {\n                remainingText = originalText.substring(match.index + 1);\n                match = pattern.exec(remainingText);\n                continue;\n            }\n            let parsedResult = null;\n            if (result instanceof ParsingResult) {\n                parsedResult = result;\n            }\n            else if (result instanceof ParsingComponents) {\n                parsedResult = context.createParsingResult(match.index, match[0]);\n                parsedResult.start = result;\n            }\n            else {\n                parsedResult = context.createParsingResult(match.index, match[0], result);\n            }\n            const parsedIndex = parsedResult.index;\n            const parsedText = parsedResult.text;\n            context.debug(() => console.log(`${parser.constructor.name} extracted (at index=${parsedIndex}) '${parsedText}'`));\n            results.push(parsedResult);\n            remainingText = originalText.substring(parsedIndex + parsedText.length);\n            match = pattern.exec(remainingText);\n        }\n        return results;\n    }\n}\nexport class ParsingContext {\n    constructor(text, refDate, option) {\n        this.text = text;\n        this.reference = new ReferenceWithTimezone(refDate);\n        this.option = option ?? {};\n        this.refDate = this.reference.instant;\n    }\n    createParsingComponents(components) {\n        if (components instanceof ParsingComponents) {\n            return components;\n        }\n        return new ParsingComponents(this.reference, components);\n    }\n    createParsingResult(index, textOrEndIndex, startComponents, endComponents) {\n        const text = typeof textOrEndIndex === \"string\" ? textOrEndIndex : this.text.substring(index, textOrEndIndex);\n        const start = startComponents ? this.createParsingComponents(startComponents) : null;\n        const end = endComponents ? this.createParsingComponents(endComponents) : null;\n        return new ParsingResult(this.reference, index, text, start, end);\n    }\n    debug(block) {\n        if (this.option.debug) {\n            if (this.option.debug instanceof Function) {\n                this.option.debug(block);\n            }\n            else {\n                const handler = this.option.debug;\n                handler.debug(block);\n            }\n        }\n    }\n}\n//# sourceMappingURL=chrono.js.map","function assertNonEmptyString (str) {\n  if (typeof str !== 'string' || !str) {\n    throw new Error('expected a non-empty string, got: ' + str)\n  }\n}\n\nfunction assertNumber (number) {\n  if (typeof number !== 'number') {\n    throw new Error('expected a number, got: ' + number)\n  }\n}\n\nconst DB_VERSION_CURRENT = 1;\nconst DB_VERSION_INITIAL = 1;\nconst STORE_EMOJI = 'emoji';\nconst STORE_KEYVALUE = 'keyvalue';\nconst STORE_FAVORITES = 'favorites';\nconst FIELD_TOKENS = 'tokens';\nconst INDEX_TOKENS = 'tokens';\nconst FIELD_UNICODE = 'unicode';\nconst INDEX_COUNT = 'count';\nconst FIELD_GROUP = 'group';\nconst FIELD_ORDER = 'order';\nconst INDEX_GROUP_AND_ORDER = 'group-order';\nconst KEY_ETAG = 'eTag';\nconst KEY_URL = 'url';\nconst KEY_PREFERRED_SKINTONE = 'skinTone';\nconst MODE_READONLY = 'readonly';\nconst MODE_READWRITE = 'readwrite';\nconst INDEX_SKIN_UNICODE = 'skinUnicodes';\nconst FIELD_SKIN_UNICODE = 'skinUnicodes';\n\nconst DEFAULT_DATA_SOURCE = 'https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json';\nconst DEFAULT_LOCALE = 'en';\n\n// like lodash's uniqBy but much smaller\nfunction uniqBy (arr, func) {\n  const set = new Set();\n  const res = [];\n  for (const item of arr) {\n    const key = func(item);\n    if (!set.has(key)) {\n      set.add(key);\n      res.push(item);\n    }\n  }\n  return res\n}\n\nfunction uniqEmoji (emojis) {\n  return uniqBy(emojis, _ => _.unicode)\n}\n\nfunction initialMigration (db) {\n  function createObjectStore (name, keyPath, indexes) {\n    const store = keyPath\n      ? db.createObjectStore(name, { keyPath })\n      : db.createObjectStore(name);\n    if (indexes) {\n      for (const [indexName, [keyPath, multiEntry]] of Object.entries(indexes)) {\n        store.createIndex(indexName, keyPath, { multiEntry });\n      }\n    }\n    return store\n  }\n\n  createObjectStore(STORE_KEYVALUE);\n  createObjectStore(STORE_EMOJI, /* keyPath */ FIELD_UNICODE, {\n    [INDEX_TOKENS]: [FIELD_TOKENS, /* multiEntry */ true],\n    [INDEX_GROUP_AND_ORDER]: [[FIELD_GROUP, FIELD_ORDER]],\n    [INDEX_SKIN_UNICODE]: [FIELD_SKIN_UNICODE, /* multiEntry */ true]\n  });\n  createObjectStore(STORE_FAVORITES, undefined, {\n    [INDEX_COUNT]: ['']\n  });\n}\n\nconst openIndexedDBRequests = {};\nconst databaseCache = {};\nconst onCloseListeners = {};\n\nfunction handleOpenOrDeleteReq (resolve, reject, req) {\n  // These things are almost impossible to test with fakeIndexedDB sadly\n  /* istanbul ignore next */\n  req.onerror = () => reject(req.error);\n  /* istanbul ignore next */\n  req.onblocked = () => reject(new Error('IDB blocked'));\n  req.onsuccess = () => resolve(req.result);\n}\n\nasync function createDatabase (dbName) {\n  const db = await new Promise((resolve, reject) => {\n    const req = indexedDB.open(dbName, DB_VERSION_CURRENT);\n    openIndexedDBRequests[dbName] = req;\n    req.onupgradeneeded = e => {\n      // Technically there is only one version, so we don't need this `if` check\n      // But if an old version of the JS is in another browser tab\n      // and it gets upgraded in the future and we have a new DB version, well...\n      // better safe than sorry.\n      /* istanbul ignore else */\n      if (e.oldVersion < DB_VERSION_INITIAL) {\n        initialMigration(req.result);\n      }\n    };\n    handleOpenOrDeleteReq(resolve, reject, req);\n  });\n  // Handle abnormal closes, e.g. \"delete database\" in chrome dev tools.\n  // No need for removeEventListener, because once the DB can no longer\n  // fire \"close\" events, it will auto-GC.\n  // Unfortunately cannot test in fakeIndexedDB: https://github.com/dumbmatter/fakeIndexedDB/issues/50\n  /* istanbul ignore next */\n  db.onclose = () => closeDatabase(dbName);\n  return db\n}\n\nfunction openDatabase (dbName) {\n  if (!databaseCache[dbName]) {\n    databaseCache[dbName] = createDatabase(dbName);\n  }\n  return databaseCache[dbName]\n}\n\nfunction dbPromise (db, storeName, readOnlyOrReadWrite, cb) {\n  return new Promise((resolve, reject) => {\n    // Use relaxed durability because neither the emoji data nor the favorites/preferred skin tone\n    // are really irreplaceable data. IndexedDB is just a cache in this case.\n    const txn = db.transaction(storeName, readOnlyOrReadWrite, { durability: 'relaxed' });\n    const store = typeof storeName === 'string'\n      ? txn.objectStore(storeName)\n      : storeName.map(name => txn.objectStore(name));\n    let res;\n    cb(store, txn, (result) => {\n      res = result;\n    });\n\n    txn.oncomplete = () => resolve(res);\n    /* istanbul ignore next */\n    txn.onerror = () => reject(txn.error);\n  })\n}\n\nfunction closeDatabase (dbName) {\n  // close any open requests\n  const req = openIndexedDBRequests[dbName];\n  const db = req && req.result;\n  if (db) {\n    db.close();\n    const listeners = onCloseListeners[dbName];\n    /* istanbul ignore else */\n    if (listeners) {\n      for (const listener of listeners) {\n        listener();\n      }\n    }\n  }\n  delete openIndexedDBRequests[dbName];\n  delete databaseCache[dbName];\n  delete onCloseListeners[dbName];\n}\n\nfunction deleteDatabase (dbName) {\n  return new Promise((resolve, reject) => {\n    // close any open requests\n    closeDatabase(dbName);\n    const req = indexedDB.deleteDatabase(dbName);\n    handleOpenOrDeleteReq(resolve, reject, req);\n  })\n}\n\n// The \"close\" event occurs during an abnormal shutdown, e.g. a user clearing their browser data.\n// However, it doesn't occur with the normal \"close\" event, so we handle that separately.\n// https://www.w3.org/TR/IndexedDB/#close-a-database-connection\nfunction addOnCloseListener (dbName, listener) {\n  let listeners = onCloseListeners[dbName];\n  if (!listeners) {\n    listeners = onCloseListeners[dbName] = [];\n  }\n  listeners.push(listener);\n}\n\n// list of emoticons that don't match a simple \\W+ regex\n// extracted using:\n// require('emoji-picker-element-data/en/emojibase/data.json').map(_ => _.emoticon).filter(Boolean).filter(_ => !/^\\W+$/.test(_))\nconst irregularEmoticons = new Set([\n  ':D', 'XD', \":'D\", 'O:)',\n  ':X', ':P', ';P', 'XP',\n  ':L', ':Z', ':j', '8D',\n  'XO', '8)', ':B', ':O',\n  ':S', \":'o\", 'Dx', 'X(',\n  'D:', ':C', '>0)', ':3',\n  '</3', '<3', '\\\\M/', ':E',\n  '8#'\n]);\n\nfunction extractTokens (str) {\n  return str\n    .split(/[\\s_]+/)\n    .map(word => {\n      if (!word.match(/\\w/) || irregularEmoticons.has(word)) {\n        // for pure emoticons like :) or :-), just leave them as-is\n        return word.toLowerCase()\n      }\n\n      return word\n        .replace(/[)(:,]/g, '')\n        .replace(/’/g, \"'\")\n        .toLowerCase()\n    }).filter(Boolean)\n}\n\nconst MIN_SEARCH_TEXT_LENGTH = 2;\n\n// This is an extra step in addition to extractTokens(). The difference here is that we expect\n// the input to have already been run through extractTokens(). This is useful for cases like\n// emoticons, where we don't want to do any tokenization (because it makes no sense to split up\n// \">:)\" by the colon) but we do want to lowercase it to have consistent search results, so that\n// the user can type ':P' or ':p' and still get the same result.\nfunction normalizeTokens (str) {\n  return str\n    .filter(Boolean)\n    .map(_ => _.toLowerCase())\n    .filter(_ => _.length >= MIN_SEARCH_TEXT_LENGTH)\n}\n\n// Transform emoji data for storage in IDB\nfunction transformEmojiData (emojiData) {\n  const res = emojiData.map(({ annotation, emoticon, group, order, shortcodes, skins, tags, emoji, version }) => {\n    const tokens = [...new Set(\n      normalizeTokens([\n        ...(shortcodes || []).map(extractTokens).flat(),\n        ...(tags || []).map(extractTokens).flat(),\n        ...extractTokens(annotation),\n        emoticon\n      ])\n    )].sort();\n    const res = {\n      annotation,\n      group,\n      order,\n      tags,\n      tokens,\n      unicode: emoji,\n      version\n    };\n    if (emoticon) {\n      res.emoticon = emoticon;\n    }\n    if (shortcodes) {\n      res.shortcodes = shortcodes;\n    }\n    if (skins) {\n      res.skinTones = [];\n      res.skinUnicodes = [];\n      res.skinVersions = [];\n      for (const { tone, emoji, version } of skins) {\n        res.skinTones.push(tone);\n        res.skinUnicodes.push(emoji);\n        res.skinVersions.push(version);\n      }\n    }\n    return res\n  });\n  return res\n}\n\n// helper functions that help compress the code better\n\nfunction callStore (store, method, key, cb) {\n  store[method](key).onsuccess = e => (cb && cb(e.target.result));\n}\n\nfunction getIDB (store, key, cb) {\n  callStore(store, 'get', key, cb);\n}\n\nfunction getAllIDB (store, key, cb) {\n  callStore(store, 'getAll', key, cb);\n}\n\nfunction commit (txn) {\n  /* istanbul ignore else */\n  if (txn.commit) {\n    txn.commit();\n  }\n}\n\n// like lodash's minBy\nfunction minBy (array, func) {\n  let minItem = array[0];\n  for (let i = 1; i < array.length; i++) {\n    const item = array[i];\n    if (func(minItem) > func(item)) {\n      minItem = item;\n    }\n  }\n  return minItem\n}\n\n// return an array of results representing all items that are found in each one of the arrays\n//\n\nfunction findCommonMembers (arrays, uniqByFunc) {\n  const shortestArray = minBy(arrays, _ => _.length);\n  const results = [];\n  for (const item of shortestArray) {\n    // if this item is included in every array in the intermediate results, add it to the final results\n    if (!arrays.some(array => array.findIndex(_ => uniqByFunc(_) === uniqByFunc(item)) === -1)) {\n      results.push(item);\n    }\n  }\n  return results\n}\n\nasync function isEmpty (db) {\n  return !(await get(db, STORE_KEYVALUE, KEY_URL))\n}\n\nasync function hasData (db, url, eTag) {\n  const [oldETag, oldUrl] = await Promise.all([KEY_ETAG, KEY_URL]\n    .map(key => get(db, STORE_KEYVALUE, key)));\n  return (oldETag === eTag && oldUrl === url)\n}\n\nasync function doFullDatabaseScanForSingleResult (db, predicate) {\n  // This batching algorithm is just a perf improvement over a basic\n  // cursor. The BATCH_SIZE is an estimate of what would give the best\n  // perf for doing a full DB scan (worst case).\n  //\n  // Mini-benchmark for determining the best batch size:\n  //\n  // PERF=1 pnpm build:rollup && pnpm test:adhoc\n  //\n  // (async () => {\n  //   performance.mark('start')\n  //   await $('emoji-picker').database.getEmojiByShortcode('doesnotexist')\n  //   performance.measure('total', 'start')\n  //   console.log(performance.getEntriesByName('total').slice(-1)[0].duration)\n  // })()\n  const BATCH_SIZE = 50; // Typically around 150ms for 6x slowdown in Chrome for above benchmark\n  return dbPromise(db, STORE_EMOJI, MODE_READONLY, (emojiStore, txn, cb) => {\n    let lastKey;\n\n    const processNextBatch = () => {\n      emojiStore.getAll(lastKey && IDBKeyRange.lowerBound(lastKey, true), BATCH_SIZE).onsuccess = e => {\n        const results = e.target.result;\n        for (const result of results) {\n          lastKey = result.unicode;\n          if (predicate(result)) {\n            return cb(result)\n          }\n        }\n        if (results.length < BATCH_SIZE) {\n          return cb()\n        }\n        processNextBatch();\n      };\n    };\n    processNextBatch();\n  })\n}\n\nasync function loadData (db, emojiData, url, eTag) {\n  try {\n    const transformedData = transformEmojiData(emojiData);\n    await dbPromise(db, [STORE_EMOJI, STORE_KEYVALUE], MODE_READWRITE, ([emojiStore, metaStore], txn) => {\n      let oldETag;\n      let oldUrl;\n      let todo = 0;\n\n      function checkFetched () {\n        if (++todo === 2) { // 2 requests made\n          onFetched();\n        }\n      }\n\n      function onFetched () {\n        if (oldETag === eTag && oldUrl === url) {\n          // check again within the transaction to guard against concurrency, e.g. multiple browser tabs\n          return\n        }\n        // delete old data\n        emojiStore.clear();\n        // insert new data\n        for (const data of transformedData) {\n          emojiStore.put(data);\n        }\n        metaStore.put(eTag, KEY_ETAG);\n        metaStore.put(url, KEY_URL);\n        commit(txn);\n      }\n\n      getIDB(metaStore, KEY_ETAG, result => {\n        oldETag = result;\n        checkFetched();\n      });\n\n      getIDB(metaStore, KEY_URL, result => {\n        oldUrl = result;\n        checkFetched();\n      });\n    });\n  } finally {\n  }\n}\n\nasync function getEmojiByGroup (db, group) {\n  return dbPromise(db, STORE_EMOJI, MODE_READONLY, (emojiStore, txn, cb) => {\n    const range = IDBKeyRange.bound([group, 0], [group + 1, 0], false, true);\n    getAllIDB(emojiStore.index(INDEX_GROUP_AND_ORDER), range, cb);\n  })\n}\n\nasync function getEmojiBySearchQuery (db, query) {\n  const tokens = normalizeTokens(extractTokens(query));\n\n  if (!tokens.length) {\n    return []\n  }\n\n  return dbPromise(db, STORE_EMOJI, MODE_READONLY, (emojiStore, txn, cb) => {\n    // get all results that contain all tokens (i.e. an AND query)\n    const intermediateResults = [];\n\n    const checkDone = () => {\n      if (intermediateResults.length === tokens.length) {\n        onDone();\n      }\n    };\n\n    const onDone = () => {\n      const results = findCommonMembers(intermediateResults, _ => _.unicode);\n      cb(results.sort((a, b) => a.order < b.order ? -1 : 1));\n    };\n\n    for (let i = 0; i < tokens.length; i++) {\n      const token = tokens[i];\n      const range = i === tokens.length - 1\n        ? IDBKeyRange.bound(token, token + '\\uffff', false, true) // treat last token as a prefix search\n        : IDBKeyRange.only(token); // treat all other tokens as an exact match\n      getAllIDB(emojiStore.index(INDEX_TOKENS), range, result => {\n        intermediateResults.push(result);\n        checkDone();\n      });\n    }\n  })\n}\n\n// This could have been implemented as an IDB index on shortcodes, but it seemed wasteful to do that\n// when we can already query by tokens and this will give us what we're looking for 99.9% of the time\nasync function getEmojiByShortcode (db, shortcode) {\n  const emojis = await getEmojiBySearchQuery(db, shortcode);\n\n  // In very rare cases (e.g. the shortcode \"v\" as in \"v for victory\"), we cannot search because\n  // there are no usable tokens (too short in this case). In that case, we have to do an inefficient\n  // full-database scan, which I believe is an acceptable tradeoff for not having to have an extra\n  // index on shortcodes.\n\n  if (!emojis.length) {\n    const predicate = _ => ((_.shortcodes || []).includes(shortcode.toLowerCase()));\n    return (await doFullDatabaseScanForSingleResult(db, predicate)) || null\n  }\n\n  return emojis.filter(_ => {\n    const lowerShortcodes = (_.shortcodes || []).map(_ => _.toLowerCase());\n    return lowerShortcodes.includes(shortcode.toLowerCase())\n  })[0] || null\n}\n\nasync function getEmojiByUnicode (db, unicode) {\n  return dbPromise(db, STORE_EMOJI, MODE_READONLY, (emojiStore, txn, cb) => (\n    getIDB(emojiStore, unicode, result => {\n      if (result) {\n        return cb(result)\n      }\n      getIDB(emojiStore.index(INDEX_SKIN_UNICODE), unicode, result => cb(result || null));\n    })\n  ))\n}\n\nfunction get (db, storeName, key) {\n  return dbPromise(db, storeName, MODE_READONLY, (store, txn, cb) => (\n    getIDB(store, key, cb)\n  ))\n}\n\nfunction set (db, storeName, key, value) {\n  return dbPromise(db, storeName, MODE_READWRITE, (store, txn) => {\n    store.put(value, key);\n    commit(txn);\n  })\n}\n\nfunction incrementFavoriteEmojiCount (db, unicode) {\n  return dbPromise(db, STORE_FAVORITES, MODE_READWRITE, (store, txn) => (\n    getIDB(store, unicode, result => {\n      store.put((result || 0) + 1, unicode);\n      commit(txn);\n    })\n  ))\n}\n\nfunction getTopFavoriteEmoji (db, customEmojiIndex, limit) {\n  if (limit === 0) {\n    return []\n  }\n  return dbPromise(db, [STORE_FAVORITES, STORE_EMOJI], MODE_READONLY, ([favoritesStore, emojiStore], txn, cb) => {\n    const results = [];\n    favoritesStore.index(INDEX_COUNT).openCursor(undefined, 'prev').onsuccess = e => {\n      const cursor = e.target.result;\n      if (!cursor) { // no more results\n        return cb(results)\n      }\n\n      function addResult (result) {\n        results.push(result);\n        if (results.length === limit) {\n          return cb(results) // done, reached the limit\n        }\n        cursor.continue();\n      }\n\n      const unicodeOrName = cursor.primaryKey;\n      const custom = customEmojiIndex.byName(unicodeOrName);\n      if (custom) {\n        return addResult(custom)\n      }\n      // This could be done in parallel (i.e. make the cursor and the get()s parallelized),\n      // but my testing suggests it's not actually faster.\n      getIDB(emojiStore, unicodeOrName, emoji => {\n        if (emoji) {\n          return addResult(emoji)\n        }\n        // emoji not found somehow, ignore (may happen if custom emoji change)\n        cursor.continue();\n      });\n    };\n  })\n}\n\n// trie data structure for prefix searches\n// loosely based on https://github.com/nolanlawson/substring-trie\n\nconst CODA_MARKER = ''; // marks the end of the string\n\nfunction trie (arr, itemToTokens) {\n  const map = new Map();\n  for (const item of arr) {\n    const tokens = itemToTokens(item);\n    for (const token of tokens) {\n      let currentMap = map;\n      for (let i = 0; i < token.length; i++) {\n        const char = token.charAt(i);\n        let nextMap = currentMap.get(char);\n        if (!nextMap) {\n          nextMap = new Map();\n          currentMap.set(char, nextMap);\n        }\n        currentMap = nextMap;\n      }\n      let valuesAtCoda = currentMap.get(CODA_MARKER);\n      if (!valuesAtCoda) {\n        valuesAtCoda = [];\n        currentMap.set(CODA_MARKER, valuesAtCoda);\n      }\n      valuesAtCoda.push(item);\n    }\n  }\n\n  const search = (query, exact) => {\n    let currentMap = map;\n    for (let i = 0; i < query.length; i++) {\n      const char = query.charAt(i);\n      const nextMap = currentMap.get(char);\n      if (nextMap) {\n        currentMap = nextMap;\n      } else {\n        return []\n      }\n    }\n\n    if (exact) {\n      const results = currentMap.get(CODA_MARKER);\n      return results || []\n    }\n\n    const results = [];\n    // traverse\n    const queue = [currentMap];\n    while (queue.length) {\n      const currentMap = queue.shift();\n      const entriesSortedByKey = [...currentMap.entries()].sort((a, b) => a[0] < b[0] ? -1 : 1);\n      for (const [key, value] of entriesSortedByKey) {\n        if (key === CODA_MARKER) { // CODA_MARKER always comes first; it's the empty string\n          results.push(...value);\n        } else {\n          queue.push(value);\n        }\n      }\n    }\n    return results\n  };\n\n  return search\n}\n\nconst requiredKeys$1 = [\n  'name',\n  'url'\n];\n\nfunction assertCustomEmojis (customEmojis) {\n  const isArray = customEmojis && Array.isArray(customEmojis);\n  const firstItemIsFaulty = isArray &&\n    customEmojis.length &&\n    (!customEmojis[0] || requiredKeys$1.some(key => !(key in customEmojis[0])));\n  if (!isArray || firstItemIsFaulty) {\n    throw new Error('Custom emojis are in the wrong format')\n  }\n}\n\nfunction customEmojiIndex (customEmojis) {\n  assertCustomEmojis(customEmojis);\n\n  const sortByName = (a, b) => a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1;\n\n  //\n  // all()\n  //\n  const all = customEmojis.sort(sortByName);\n\n  //\n  // search()\n  //\n  const emojiToTokens = emoji => {\n    const set = new Set();\n    if (emoji.shortcodes) {\n      for (const shortcode of emoji.shortcodes) {\n        for (const token of extractTokens(shortcode)) {\n          set.add(token);\n        }\n      }\n    }\n    return set\n  };\n  const searchTrie = trie(customEmojis, emojiToTokens);\n  const searchByExactMatch = _ => searchTrie(_, true);\n  const searchByPrefix = _ => searchTrie(_, false);\n\n  // Search by query for custom emoji. Similar to how we do this in IDB, the last token\n  // is treated as a prefix search, but every other one is treated as an exact match.\n  // Then we AND the results together\n  const search = query => {\n    const tokens = extractTokens(query);\n    const intermediateResults = tokens.map((token, i) => (\n      (i < tokens.length - 1 ? searchByExactMatch : searchByPrefix)(token)\n    ));\n    return findCommonMembers(intermediateResults, _ => _.name).sort(sortByName)\n  };\n\n  //\n  // byShortcode, byName\n  //\n  const shortcodeToEmoji = new Map();\n  const nameToEmoji = new Map();\n  for (const customEmoji of customEmojis) {\n    nameToEmoji.set(customEmoji.name.toLowerCase(), customEmoji);\n    for (const shortcode of (customEmoji.shortcodes || [])) {\n      shortcodeToEmoji.set(shortcode.toLowerCase(), customEmoji);\n    }\n  }\n\n  const byShortcode = shortcode => shortcodeToEmoji.get(shortcode.toLowerCase());\n  const byName = name => nameToEmoji.get(name.toLowerCase());\n\n  return {\n    all,\n    search,\n    byShortcode,\n    byName\n  }\n}\n\nconst isFirefoxContentScript = typeof wrappedJSObject !== 'undefined';\n\n// remove some internal implementation details, i.e. the \"tokens\" array on the emoji object\n// essentially, convert the emoji from the version stored in IDB to the version used in-memory\nfunction cleanEmoji (emoji) {\n  if (!emoji) {\n    return emoji\n  }\n  // if inside a Firefox content script, need to clone the emoji object to prevent Firefox from complaining about\n  // cross-origin object. See: https://github.com/nolanlawson/emoji-picker-element/issues/356\n  /* istanbul ignore if */\n  if (isFirefoxContentScript) {\n    emoji = structuredClone(emoji);\n  }\n  delete emoji.tokens;\n  if (emoji.skinTones) {\n    const len = emoji.skinTones.length;\n    emoji.skins = Array(len);\n    for (let i = 0; i < len; i++) {\n      emoji.skins[i] = {\n        tone: emoji.skinTones[i],\n        unicode: emoji.skinUnicodes[i],\n        version: emoji.skinVersions[i]\n      };\n    }\n    delete emoji.skinTones;\n    delete emoji.skinUnicodes;\n    delete emoji.skinVersions;\n  }\n  return emoji\n}\n\nfunction warnETag (eTag) {\n  if (!eTag) {\n    console.warn('emoji-picker-element is more efficient if the dataSource server exposes an ETag header.');\n  }\n}\n\nconst requiredKeys = [\n  'annotation',\n  'emoji',\n  'group',\n  'order',\n  'version'\n];\n\nfunction assertEmojiData (emojiData) {\n  if (!emojiData ||\n    !Array.isArray(emojiData) ||\n    !emojiData[0] ||\n    (typeof emojiData[0] !== 'object') ||\n    requiredKeys.some(key => (!(key in emojiData[0])))) {\n    throw new Error('Emoji data is in the wrong format')\n  }\n}\n\nfunction assertStatus (response, dataSource) {\n  if (Math.floor(response.status / 100) !== 2) {\n    throw new Error('Failed to fetch: ' + dataSource + ':  ' + response.status)\n  }\n}\n\nasync function getETag (dataSource) {\n  const response = await fetch(dataSource, { method: 'HEAD' });\n  assertStatus(response, dataSource);\n  const eTag = response.headers.get('etag');\n  warnETag(eTag);\n  return eTag\n}\n\nasync function getETagAndData (dataSource) {\n  const response = await fetch(dataSource);\n  assertStatus(response, dataSource);\n  const eTag = response.headers.get('etag');\n  warnETag(eTag);\n  const emojiData = await response.json();\n  assertEmojiData(emojiData);\n  return [eTag, emojiData]\n}\n\n// TODO: including these in blob-util.ts causes typedoc to generate docs for them,\n// even with --excludePrivate ¯\\_(ツ)_/¯\n/** @private */\n/**\n * Convert an `ArrayBuffer` to a binary string.\n *\n * Example:\n *\n * ```js\n * var myString = blobUtil.arrayBufferToBinaryString(arrayBuff)\n * ```\n *\n * @param buffer - array buffer\n * @returns binary string\n */\nfunction arrayBufferToBinaryString(buffer) {\n    var binary = '';\n    var bytes = new Uint8Array(buffer);\n    var length = bytes.byteLength;\n    var i = -1;\n    while (++i < length) {\n        binary += String.fromCharCode(bytes[i]);\n    }\n    return binary;\n}\n/**\n * Convert a binary string to an `ArrayBuffer`.\n *\n * ```js\n * var myBuffer = blobUtil.binaryStringToArrayBuffer(binaryString)\n * ```\n *\n * @param binary - binary string\n * @returns array buffer\n */\nfunction binaryStringToArrayBuffer(binary) {\n    var length = binary.length;\n    var buf = new ArrayBuffer(length);\n    var arr = new Uint8Array(buf);\n    var i = -1;\n    while (++i < length) {\n        arr[i] = binary.charCodeAt(i);\n    }\n    return buf;\n}\n\n// generate a checksum based on the stringified JSON\nasync function jsonChecksum (object) {\n  const inString = JSON.stringify(object);\n  let inBuffer = binaryStringToArrayBuffer(inString);\n\n  // this does not need to be cryptographically secure, SHA-1 is fine\n  const outBuffer = await crypto.subtle.digest('SHA-1', inBuffer);\n  const outBinString = arrayBufferToBinaryString(outBuffer);\n  const res = btoa(outBinString);\n  return res\n}\n\nasync function checkForUpdates (db, dataSource) {\n  // just do a simple HEAD request first to see if the eTags match\n  let emojiData;\n  let eTag = await getETag(dataSource);\n  if (!eTag) { // work around lack of ETag/Access-Control-Expose-Headers\n    const eTagAndData = await getETagAndData(dataSource);\n    eTag = eTagAndData[0];\n    emojiData = eTagAndData[1];\n    if (!eTag) {\n      eTag = await jsonChecksum(emojiData);\n    }\n  }\n  if (await hasData(db, dataSource, eTag)) ; else {\n    if (!emojiData) {\n      const eTagAndData = await getETagAndData(dataSource);\n      emojiData = eTagAndData[1];\n    }\n    await loadData(db, emojiData, dataSource, eTag);\n  }\n}\n\nasync function loadDataForFirstTime (db, dataSource) {\n  let [eTag, emojiData] = await getETagAndData(dataSource);\n  if (!eTag) {\n    // Handle lack of support for ETag or Access-Control-Expose-Headers\n    // https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Expose-Headers#Browser_compatibility\n    eTag = await jsonChecksum(emojiData);\n  }\n\n  await loadData(db, emojiData, dataSource, eTag);\n}\n\nclass Database {\n  constructor ({ dataSource = DEFAULT_DATA_SOURCE, locale = DEFAULT_LOCALE, customEmoji = [] } = {}) {\n    this.dataSource = dataSource;\n    this.locale = locale;\n    this._dbName = `emoji-picker-element-${this.locale}`;\n    this._db = undefined;\n    this._lazyUpdate = undefined;\n    this._custom = customEmojiIndex(customEmoji);\n\n    this._clear = this._clear.bind(this);\n    this._ready = this._init();\n  }\n\n  async _init () {\n    const db = this._db = await openDatabase(this._dbName);\n\n    addOnCloseListener(this._dbName, this._clear);\n    const dataSource = this.dataSource;\n    const empty = await isEmpty(db);\n\n    if (empty) {\n      await loadDataForFirstTime(db, dataSource);\n    } else { // offline-first - do an update asynchronously\n      this._lazyUpdate = checkForUpdates(db, dataSource);\n    }\n  }\n\n  async ready () {\n    const checkReady = async () => {\n      if (!this._ready) {\n        this._ready = this._init();\n      }\n      return this._ready\n    };\n    await checkReady();\n    // There's a possibility of a race condition where the element gets added, removed, and then added again\n    // with a particular timing, which would set the _db to undefined.\n    // We *could* do a while loop here, but that seems excessive and could lead to an infinite loop.\n    if (!this._db) {\n      await checkReady();\n    }\n  }\n\n  async getEmojiByGroup (group) {\n    assertNumber(group);\n    await this.ready();\n    return uniqEmoji(await getEmojiByGroup(this._db, group)).map(cleanEmoji)\n  }\n\n  async getEmojiBySearchQuery (query) {\n    assertNonEmptyString(query);\n    await this.ready();\n    const customs = this._custom.search(query);\n    const natives = uniqEmoji(await getEmojiBySearchQuery(this._db, query)).map(cleanEmoji);\n    return [\n      ...customs,\n      ...natives\n    ]\n  }\n\n  async getEmojiByShortcode (shortcode) {\n    assertNonEmptyString(shortcode);\n    await this.ready();\n    const custom = this._custom.byShortcode(shortcode);\n    if (custom) {\n      return custom\n    }\n    return cleanEmoji(await getEmojiByShortcode(this._db, shortcode))\n  }\n\n  async getEmojiByUnicodeOrName (unicodeOrName) {\n    assertNonEmptyString(unicodeOrName);\n    await this.ready();\n    const custom = this._custom.byName(unicodeOrName);\n    if (custom) {\n      return custom\n    }\n    return cleanEmoji(await getEmojiByUnicode(this._db, unicodeOrName))\n  }\n\n  async getPreferredSkinTone () {\n    await this.ready();\n    return (await get(this._db, STORE_KEYVALUE, KEY_PREFERRED_SKINTONE)) || 0\n  }\n\n  async setPreferredSkinTone (skinTone) {\n    assertNumber(skinTone);\n    await this.ready();\n    return set(this._db, STORE_KEYVALUE, KEY_PREFERRED_SKINTONE, skinTone)\n  }\n\n  async incrementFavoriteEmojiCount (unicodeOrName) {\n    assertNonEmptyString(unicodeOrName);\n    await this.ready();\n    return incrementFavoriteEmojiCount(this._db, unicodeOrName)\n  }\n\n  async getTopFavoriteEmoji (limit) {\n    assertNumber(limit);\n    await this.ready();\n    return (await getTopFavoriteEmoji(this._db, this._custom, limit)).map(cleanEmoji)\n  }\n\n  set customEmoji (customEmojis) {\n    this._custom = customEmojiIndex(customEmojis);\n  }\n\n  get customEmoji () {\n    return this._custom.all\n  }\n\n  async _shutdown () {\n    await this.ready(); // reopen if we've already been closed/deleted\n    try {\n      await this._lazyUpdate; // allow any lazy updates to process before closing/deleting\n    } catch (err) { /* ignore network errors (offline-first) */ }\n  }\n\n  // clear references to IDB, e.g. during a close event\n  _clear () {\n    // We don't need to call removeEventListener or remove the manual \"close\" listeners.\n    // The memory leak tests prove this is unnecessary. It's because:\n    // 1) IDBDatabases that can no longer fire \"close\" automatically have listeners GCed\n    // 2) we clear the manual close listeners in databaseLifecycle.js.\n    this._db = this._ready = this._lazyUpdate = undefined;\n  }\n\n  async close () {\n    await this._shutdown();\n    await closeDatabase(this._dbName);\n  }\n\n  async delete () {\n    await this._shutdown();\n    await deleteDatabase(this._dbName);\n  }\n}\n\nexport { Database as default };\n","import Database from './database.js';\n\n// via https://unpkg.com/browse/emojibase-data@6.0.0/meta/groups.json\nconst allGroups = [\n  [-1, '✨', 'custom'],\n  [0, '😀', 'smileys-emotion'],\n  [1, '👋', 'people-body'],\n  [3, '🐱', 'animals-nature'],\n  [4, '🍎', 'food-drink'],\n  [5, '🏠️', 'travel-places'],\n  [6, '⚽', 'activities'],\n  [7, '📝', 'objects'],\n  [8, '⛔️', 'symbols'],\n  [9, '🏁', 'flags']\n].map(([id, emoji, name]) => ({ id, emoji, name }));\n\nconst groups = allGroups.slice(1);\n\nconst MIN_SEARCH_TEXT_LENGTH = 2;\nconst NUM_SKIN_TONES = 6;\n\n/* istanbul ignore next */\nconst rIC = typeof requestIdleCallback === 'function' ? requestIdleCallback : setTimeout;\n\n// check for ZWJ (zero width joiner) character\nfunction hasZwj (emoji) {\n  return emoji.unicode.includes('\\u200d')\n}\n\n// Find one good representative emoji from each version to test by checking its color.\n// Ideally it should have color in the center. For some inspiration, see:\n// https://about.gitlab.com/blog/2018/05/30/journey-in-native-unicode-emoji/\n//\n// Note that for certain versions (12.1, 13.1), there is no point in testing them explicitly, because\n// all the emoji from this version are compound-emoji from previous versions. So they would pass a color\n// test, even in browsers that display them as double emoji. (E.g. \"face in clouds\" might render as\n// \"face without mouth\" plus \"fog\".) These emoji can only be filtered using the width test,\n// which happens in checkZwjSupport.js.\nconst versionsAndTestEmoji = {\n  '🫩': 16, // face with bags under eyes\n  '🫨': 15.1, // shaking head, technically from v15 but see note above\n  '🫠': 14,\n  '🥲': 13.1, // smiling face with tear, technically from v13 but see note above\n  '🥻': 12.1, // sari, technically from v12 but see note above\n  '🥰': 11,\n  '🤩': 5,\n  '👱‍♀️': 4,\n  '🤣': 3,\n  '👁️‍🗨️': 2,\n  '😀': 1,\n  '😐️': 0.7,\n  '😃': 0.6\n};\n\nconst TIMEOUT_BEFORE_LOADING_MESSAGE = 1000; // 1 second\nconst DEFAULT_SKIN_TONE_EMOJI = '🖐️';\nconst DEFAULT_NUM_COLUMNS = 8;\n\n// Based on https://fivethirtyeight.com/features/the-100-most-used-emojis/ and\n// https://blog.emojipedia.org/facebook-reveals-most-and-least-used-emojis/ with\n// a bit of my own curation. (E.g. avoid the \"OK\" gesture because of connotations:\n// https://emojipedia.org/ok-hand/)\nconst MOST_COMMONLY_USED_EMOJI = [\n  '😊',\n  '😒',\n  '❤️',\n  '👍️',\n  '😍',\n  '😂',\n  '😭',\n  '☺️',\n  '😔',\n  '😩',\n  '😏',\n  '💕',\n  '🙌',\n  '😘'\n];\n\n// It's important to list Twemoji Mozilla before everything else, because Mozilla bundles their\n// own font on some platforms (notably Windows and Linux as of this writing). Typically, Mozilla\n// updates faster than the underlying OS, and we don't want to render older emoji in one font and\n// newer emoji in another font:\n// https://github.com/nolanlawson/emoji-picker-element/pull/268#issuecomment-1073347283\nconst FONT_FAMILY = '\"Twemoji Mozilla\",\"Apple Color Emoji\",\"Segoe UI Emoji\",\"Segoe UI Symbol\",' +\n  '\"Noto Color Emoji\",\"EmojiOne Color\",\"Android Emoji\",sans-serif';\n\n/* istanbul ignore next */\nconst DEFAULT_CATEGORY_SORTING = (a, b) => a < b ? -1 : a > b ? 1 : 0;\n\n// Test if an emoji is supported by rendering it to canvas and checking that the color is not black\n// See https://about.gitlab.com/blog/2018/05/30/journey-in-native-unicode-emoji/\n// and https://www.npmjs.com/package/if-emoji for inspiration\n// This implementation is largely borrowed from if-emoji, adding the font-family\n\n\nconst getTextFeature = (text, color) => {\n  const canvas = document.createElement('canvas');\n  canvas.width = canvas.height = 1;\n\n  const ctx = canvas.getContext('2d', {\n    // Improves the performance of `getImageData()`\n    // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/getContextAttributes#willreadfrequently\n    willReadFrequently: true\n  });\n  ctx.textBaseline = 'top';\n  ctx.font = `100px ${FONT_FAMILY}`;\n  ctx.fillStyle = color;\n  ctx.scale(0.01, 0.01);\n  ctx.fillText(text, 0, 0);\n\n  return ctx.getImageData(0, 0, 1, 1).data\n};\n\nconst compareFeatures = (feature1, feature2) => {\n  const feature1Str = [...feature1].join(',');\n  const feature2Str = [...feature2].join(',');\n  // This is RGBA, so for 0,0,0, we are checking that the first RGB is not all zeroes.\n  // Most of the time when unsupported this is 0,0,0,0, but on Chrome on Mac it is\n  // 0,0,0,61 - there is a transparency here.\n  return feature1Str === feature2Str && !feature1Str.startsWith('0,0,0,')\n};\n\nfunction testColorEmojiSupported (text) {\n  // Render white and black and then compare them to each other and ensure they're the same\n  // color, and neither one is black. This shows that the emoji was rendered in color.\n  const feature1 = getTextFeature(text, '#000');\n  const feature2 = getTextFeature(text, '#fff');\n  return feature1 && feature2 && compareFeatures(feature1, feature2)\n}\n\n// rather than check every emoji ever, which would be expensive, just check some representatives from the\n// different emoji releases to determine what the font supports\n\nfunction determineEmojiSupportLevel () {\n  const entries = Object.entries(versionsAndTestEmoji);\n  try {\n    // start with latest emoji and work backwards\n    for (const [emoji, version] of entries) {\n      if (testColorEmojiSupported(emoji)) {\n        return version\n      }\n    }\n  } catch (e) { // canvas error\n  } finally {\n  }\n  // In case of an error, be generous and just assume all emoji are supported (e.g. for canvas errors\n  // due to anti-fingerprinting add-ons). Better to show some gray boxes than nothing at all.\n  return entries[0][1] // first one in the list is the most recent version\n}\n\n// Check which emojis we know for sure aren't supported, based on Unicode version level\nlet promise;\nconst detectEmojiSupportLevel = () => {\n  if (!promise) {\n    // Delay so it can run while the IDB database is being created by the browser (on another thread).\n    // This helps especially with first load – we want to start pre-populating the database on the main thread,\n    // and then wait for IDB to commit everything, and while waiting we run this check.\n    promise = new Promise(resolve => (\n      rIC(() => (\n        resolve(determineEmojiSupportLevel()) // delay so ideally this can run while IDB is first populating\n      ))\n    ));\n  }\n  return promise\n};\n// determine which emojis containing ZWJ (zero width joiner) characters\n// are supported (rendered as one glyph) rather than unsupported (rendered as two or more glyphs)\nconst supportedZwjEmojis = new Map();\n\nconst VARIATION_SELECTOR = '\\ufe0f';\nconst SKINTONE_MODIFIER = '\\ud83c';\nconst ZWJ = '\\u200d';\nconst LIGHT_SKIN_TONE = 0x1F3FB;\nconst LIGHT_SKIN_TONE_MODIFIER = 0xdffb;\n\n// TODO: this is a naive implementation, we can improve it later\n// It's only used for the skintone picker, so as long as people don't customize with\n// really exotic emoji then it should work fine\nfunction applySkinTone (str, skinTone) {\n  if (skinTone === 0) {\n    return str\n  }\n  const zwjIndex = str.indexOf(ZWJ);\n  if (zwjIndex !== -1) {\n    return str.substring(0, zwjIndex) +\n      String.fromCodePoint(LIGHT_SKIN_TONE + skinTone - 1) +\n      str.substring(zwjIndex)\n  }\n  if (str.endsWith(VARIATION_SELECTOR)) {\n    str = str.substring(0, str.length - 1);\n  }\n  return str + SKINTONE_MODIFIER + String.fromCodePoint(LIGHT_SKIN_TONE_MODIFIER + skinTone - 1)\n}\n\nfunction halt (event) {\n  event.preventDefault();\n  event.stopPropagation();\n}\n\n// Implementation left/right or up/down navigation, circling back when you\n// reach the start/end of the list\nfunction incrementOrDecrement (decrement, val, arr) {\n  val += (decrement ? -1 : 1);\n  if (val < 0) {\n    val = arr.length - 1;\n  } else if (val >= arr.length) {\n    val = 0;\n  }\n  return val\n}\n\n// like lodash's uniqBy but much smaller\nfunction uniqBy (arr, func) {\n  const set = new Set();\n  const res = [];\n  for (const item of arr) {\n    const key = func(item);\n    if (!set.has(key)) {\n      set.add(key);\n      res.push(item);\n    }\n  }\n  return res\n}\n\n// We don't need all the data on every emoji, and there are specific things we need\n// for the UI, so build a \"view model\" from the emoji object we got from the database\n\nfunction summarizeEmojisForUI (emojis, emojiSupportLevel) {\n  const toSimpleSkinsMap = skins => {\n    const res = {};\n    for (const skin of skins) {\n      // ignore arrays like [1, 2] with multiple skin tones\n      // also ignore variants that are in an unsupported emoji version\n      // (these do exist - variants from a different version than their base emoji)\n      if (typeof skin.tone === 'number' && skin.version <= emojiSupportLevel) {\n        res[skin.tone] = skin.unicode;\n      }\n    }\n    return res\n  };\n\n  return emojis.map(({ unicode, skins, shortcodes, url, name, category, annotation }) => ({\n    unicode,\n    name,\n    shortcodes,\n    url,\n    category,\n    annotation,\n    id: unicode || name,\n    skins: skins && toSimpleSkinsMap(skins)\n  }))\n}\n\n// import rAF from one place so that the bundle size is a bit smaller\nconst rAF = requestAnimationFrame;\n\n// \"Svelte action\"-like utility to detect layout changes via ResizeObserver.\n// If ResizeObserver is unsupported, we just use rAF once and don't bother to update.\n\n\nlet resizeObserverSupported = typeof ResizeObserver === 'function';\n\nfunction resizeObserverAction (node, abortSignal, onUpdate) {\n  let resizeObserver;\n  if (resizeObserverSupported) {\n    resizeObserver = new ResizeObserver(onUpdate);\n    resizeObserver.observe(node);\n  } else { // just run once, don't bother trying to track it\n    rAF(onUpdate);\n  }\n\n  // cleanup function (called on destroy)\n  abortSignal.addEventListener('abort', () => {\n    if (resizeObserver) {\n      resizeObserver.disconnect();\n    }\n  });\n}\n\n// get the width of the text inside of a DOM node, via https://stackoverflow.com/a/59525891/680742\nfunction calculateTextWidth (node) {\n  // skip running this in jest/vitest because we don't need to check for emoji support in that environment\n  /* istanbul ignore else */\n  {\n    const range = document.createRange();\n    range.selectNode(node.firstChild);\n    return range.getBoundingClientRect().width\n  }\n}\n\nlet baselineEmojiWidth;\n\n/**\n * Check if the given emojis containing ZWJ characters are supported by the current browser (don't render\n * as double characters) and return true if all are supported.\n * @param zwjEmojisToCheck\n * @param baselineEmoji\n * @param emojiToDomNode\n */\nfunction checkZwjSupport (zwjEmojisToCheck, baselineEmoji, emojiToDomNode) {\n  let allSupported = true;\n  for (const emoji of zwjEmojisToCheck) {\n    const domNode = emojiToDomNode(emoji);\n    const emojiWidth = calculateTextWidth(domNode);\n    if (typeof baselineEmojiWidth === 'undefined') { // calculate the baseline emoji width only once\n      baselineEmojiWidth = calculateTextWidth(baselineEmoji);\n    }\n    // On Windows, some supported emoji are ~50% bigger than the baseline emoji, but what we really want to guard\n    // against are the ones that are 2x the size, because those are truly broken (person with red hair = person with\n    // floating red wig, black cat = cat with black square, polar bear = bear with snowflake, etc.)\n    // So here we set the threshold at 1.8 times the size of the baseline emoji.\n    const supported = emojiWidth / 1.8 < baselineEmojiWidth;\n    supportedZwjEmojis.set(emoji.unicode, supported);\n\n    if (!supported) {\n      allSupported = false;\n    }\n  }\n  return allSupported\n}\n\n// like lodash's uniq\n\nfunction uniq (arr) {\n  return uniqBy(arr, _ => _)\n}\n\n// Note we put this in its own function outside Picker.js to avoid Svelte doing an invalidation on the \"setter\" here.\n// At best the invalidation is useless, at worst it can cause infinite loops:\n// https://github.com/nolanlawson/emoji-picker-element/pull/180\n// https://github.com/sveltejs/svelte/issues/6521\n// Also note tabpanelElement can be null if the element is disconnected immediately after connected\nfunction resetScrollTopIfPossible (element) {\n  /* istanbul ignore else */\n  if (element) { // Makes me nervous not to have this `if` guard\n    element.scrollTop = 0;\n  }\n}\n\nfunction getFromMap (cache, key, func) {\n  let cached = cache.get(key);\n  if (!cached) {\n    cached = func();\n    cache.set(key, cached);\n  }\n  return cached\n}\n\nfunction toString (value) {\n  return '' + value\n}\n\nfunction parseTemplate (htmlString) {\n  const template = document.createElement('template');\n  template.innerHTML = htmlString;\n  return template\n}\n\nconst parseCache = new WeakMap();\nconst domInstancesCache = new WeakMap();\n// This needs to be a symbol because it needs to be different from any possible output of a key function\nconst unkeyedSymbol = Symbol('un-keyed');\n\n// Not supported in Safari <=13\nconst hasReplaceChildren = 'replaceChildren' in Element.prototype;\nfunction replaceChildren (parentNode, newChildren) {\n  /* istanbul ignore else */\n  if (hasReplaceChildren) {\n    parentNode.replaceChildren(...newChildren);\n  } else { // minimal polyfill for Element.prototype.replaceChildren\n    parentNode.innerHTML = '';\n    parentNode.append(...newChildren);\n  }\n}\n\nfunction doChildrenNeedRerender (parentNode, newChildren) {\n  let oldChild = parentNode.firstChild;\n  let oldChildrenCount = 0;\n  // iterate using firstChild/nextSibling because browsers use a linked list under the hood\n  while (oldChild) {\n    const newChild = newChildren[oldChildrenCount];\n    // check if the old child and new child are the same\n    if (newChild !== oldChild) {\n      return true\n    }\n    oldChild = oldChild.nextSibling;\n    oldChildrenCount++;\n  }\n  // if new children length is different from old, we must re-render\n  return oldChildrenCount !== newChildren.length\n}\n\nfunction patchChildren (newChildren, instanceBinding) {\n  const { targetNode } = instanceBinding;\n  let { targetParentNode } = instanceBinding;\n\n  let needsRerender = false;\n\n  if (targetParentNode) { // already rendered once\n    needsRerender = doChildrenNeedRerender(targetParentNode, newChildren);\n  } else { // first render of list\n    needsRerender = true;\n    instanceBinding.targetNode = undefined; // placeholder node not needed anymore, free memory\n    instanceBinding.targetParentNode = targetParentNode = targetNode.parentNode;\n  }\n  // avoid re-rendering list if the dom nodes are exactly the same before and after\n  if (needsRerender) {\n    replaceChildren(targetParentNode, newChildren);\n  }\n}\n\nfunction patch (expressions, instanceBindings) {\n  for (const instanceBinding of instanceBindings) {\n    const {\n      targetNode,\n      currentExpression,\n      binding: {\n        expressionIndex,\n        attributeName,\n        attributeValuePre,\n        attributeValuePost\n      }\n    } = instanceBinding;\n\n    const expression = expressions[expressionIndex];\n\n    if (currentExpression === expression) {\n      // no need to update, same as before\n      continue\n    }\n\n    instanceBinding.currentExpression = expression;\n\n    if (attributeName) { // attribute replacement\n      targetNode.setAttribute(attributeName, attributeValuePre + toString(expression) + attributeValuePost);\n    } else { // text node / child element / children replacement\n      let newNode;\n      if (Array.isArray(expression)) { // array of DOM elements produced by tag template literals\n        patchChildren(expression, instanceBinding);\n      } else if (expression instanceof Element) { // html tag template returning a DOM element\n        newNode = expression;\n        targetNode.replaceWith(newNode);\n      } else { // primitive - string, number, etc\n        // nodeValue is faster than textContent supposedly https://www.youtube.com/watch?v=LY6y3HbDVmg\n        // note we may be replacing the value in a placeholder text node\n        targetNode.nodeValue = toString(expression);\n      }\n      if (newNode) {\n        instanceBinding.targetNode = newNode;\n      }\n    }\n  }\n}\n\nfunction parse (tokens) {\n  let htmlString = '';\n\n  let withinTag = false;\n  let withinAttribute = false;\n  let elementIndexCounter = -1; // depth-first traversal order\n\n  const elementsToBindings = new Map();\n  const elementIndexes = [];\n\n  for (let i = 0, len = tokens.length; i < len; i++) {\n    const token = tokens[i];\n    htmlString += token;\n\n    if (i === len - 1) {\n      break // no need to process characters - no more expressions to be found\n    }\n\n    for (let j = 0; j < token.length; j++) {\n      const char = token.charAt(j);\n      switch (char) {\n        case '<': {\n          const nextChar = token.charAt(j + 1);\n          if (nextChar === '/') { // closing tag\n            // leaving an element\n            elementIndexes.pop();\n          } else { // not a closing tag\n            withinTag = true;\n            elementIndexes.push(++elementIndexCounter);\n          }\n          break\n        }\n        case '>': {\n          withinTag = false;\n          withinAttribute = false;\n          break\n        }\n        case '=': {\n          withinAttribute = true;\n          break\n        }\n      }\n    }\n\n    const elementIndex = elementIndexes[elementIndexes.length - 1];\n    const bindings = getFromMap(elementsToBindings, elementIndex, () => []);\n\n    let attributeName;\n    let attributeValuePre;\n    let attributeValuePost;\n    if (withinAttribute) {\n      // I never use single-quotes for attribute values in HTML, so just support double-quotes or no-quotes\n      const match = /(\\S+)=\"?([^\"=]*)$/.exec(token);\n      attributeName = match[1];\n      attributeValuePre = match[2];\n      attributeValuePost = /^[^\">]*/.exec(tokens[i + 1])[0];\n    }\n\n    const binding = {\n      attributeName,\n      attributeValuePre,\n      attributeValuePost,\n      expressionIndex: i\n    };\n\n    bindings.push(binding);\n\n    if (!withinTag && !withinAttribute) {\n      // Add a placeholder text node, so we can find it later. Note we only support one dynamic child text node\n      htmlString += ' ';\n    }\n  }\n\n  const template = parseTemplate(htmlString);\n\n  return {\n    template,\n    elementsToBindings\n  }\n}\n\nfunction applyBindings (bindings, element, instanceBindings) {\n  for (let i = 0; i < bindings.length; i++) {\n    const binding = bindings[i];\n\n    const targetNode = binding.attributeName\n      ? element // attribute binding, just use the element itself\n      : element.firstChild; // not an attribute binding, so has a placeholder text node\n\n    const instanceBinding = {\n      binding,\n      targetNode,\n      targetParentNode: undefined,\n      currentExpression: undefined\n    };\n\n    instanceBindings.push(instanceBinding);\n  }\n}\n\nfunction traverseAndSetupBindings (rootElement, elementsToBindings) {\n  const instanceBindings = [];\n\n  let topLevelBindings;\n  if (elementsToBindings.size === 1 && (topLevelBindings = elementsToBindings.get(0))) {\n    // Optimization for the common case where there's only one element and one binding\n    // Skip creating a TreeWalker entirely and just handle the root DOM element\n    applyBindings(topLevelBindings, rootElement, instanceBindings);\n  } else {\n    // traverse dom\n    const treeWalker = document.createTreeWalker(rootElement, NodeFilter.SHOW_ELEMENT);\n\n    let element = rootElement;\n    let elementIndex = -1;\n    do {\n      const bindings = elementsToBindings.get(++elementIndex);\n      if (bindings) {\n        applyBindings(bindings, element, instanceBindings);\n      }\n    } while ((element = treeWalker.nextNode()))\n  }\n\n  return instanceBindings\n}\n\nfunction parseHtml (tokens) {\n  // All templates and bound expressions are unique per tokens array\n  const { template, elementsToBindings } = getFromMap(parseCache, tokens, () => parse(tokens));\n\n  // When we parseHtml, we always return a fresh DOM instance ready to be updated\n  const dom = template.cloneNode(true).content.firstElementChild;\n  const instanceBindings = traverseAndSetupBindings(dom, elementsToBindings);\n\n  return function updateDomInstance (expressions) {\n    patch(expressions, instanceBindings);\n    return dom\n  }\n}\n\nfunction createFramework (state) {\n  const domInstances = getFromMap(domInstancesCache, state, () => new Map());\n  let domInstanceCacheKey = unkeyedSymbol;\n\n  function html (tokens, ...expressions) {\n    // Each unique lexical usage of map() is considered unique due to the html`` tagged template call it makes,\n    // which has lexically unique tokens. The unkeyed symbol is just used for html`` usage outside of a map().\n    const domInstancesForTokens = getFromMap(domInstances, tokens, () => new Map());\n    const updateDomInstance = getFromMap(domInstancesForTokens, domInstanceCacheKey, () => parseHtml(tokens));\n\n    return updateDomInstance(expressions) // update with expressions\n  }\n\n  function map (array, callback, keyFunction) {\n    return array.map((item, index) => {\n      const originalCacheKey = domInstanceCacheKey;\n      domInstanceCacheKey = keyFunction(item);\n      try {\n        return callback(item, index)\n      } finally {\n        domInstanceCacheKey = originalCacheKey;\n      }\n    })\n  }\n\n  return { map, html }\n}\n\nfunction render (container, state, helpers, events, actions, refs, abortSignal, actionContext, firstRender) {\n  const { labelWithSkin, titleForEmoji, unicodeWithSkin } = helpers;\n  const { html, map } = createFramework(state);\n\n  function emojiList (emojis, searchMode, prefix) {\n    return map(emojis, (emoji, i) => {\n      return html`<button role=\"${searchMode ? 'option' : 'menuitem'}\" aria-selected=\"${searchMode ? i === state.activeSearchItem : ''}\" aria-label=\"${labelWithSkin(emoji, state.currentSkinTone)}\" title=\"${titleForEmoji(emoji)}\" class=\"${\n                'emoji' +\n                (searchMode && i === state.activeSearchItem ? ' active' : '') +\n                (emoji.unicode ? '' : ' custom-emoji')\n              }\" id=\"${`${prefix}-${emoji.id}`}\" style=\"${emoji.unicode ? '' : `--custom-emoji-background: url(${JSON.stringify(emoji.url)})`}\">${\n        emoji.unicode\n          ? unicodeWithSkin(emoji, state.currentSkinTone)\n          : ''\n      }</button>`\n      // It's important for the cache key to be unique based on the prefix, because the framework caches based on the\n      // unique tokens + cache key, and the same emoji may be used in the tab as well as in the fav bar\n    }, emoji => `${prefix}-${emoji.id}`)\n  }\n\n  const section = () => {\n    return html`<section data-ref=\"rootElement\" class=\"picker\" aria-label=\"${state.i18n.regionLabel}\" style=\"${state.pickerStyle || ''}\"><div class=\"pad-top\"></div><div class=\"search-row\"><div class=\"search-wrapper\"><input id=\"search\" class=\"search\" type=\"search\" role=\"combobox\" enterkeyhint=\"search\" placeholder=\"${state.i18n.searchLabel}\" autocapitalize=\"none\" autocomplete=\"off\" spellcheck=\"true\" aria-expanded=\"${!!(state.searchMode && state.currentEmojis.length)}\" aria-controls=\"search-results\" aria-describedby=\"search-description\" aria-autocomplete=\"list\" aria-activedescendant=\"${state.activeSearchItemId ? `emo-${state.activeSearchItemId}` : ''}\" data-ref=\"searchElement\" data-on-input=\"onSearchInput\" data-on-keydown=\"onSearchKeydown\"><label class=\"sr-only\" for=\"search\">${state.i18n.searchLabel}</label> <span id=\"search-description\" class=\"sr-only\">${state.i18n.searchDescription}</span></div><div class=\"skintone-button-wrapper ${state.skinTonePickerExpandedAfterAnimation ? 'expanded' : ''}\"><button id=\"skintone-button\" class=\"emoji ${state.skinTonePickerExpanded ? 'hide-focus' : ''}\" aria-label=\"${state.skinToneButtonLabel}\" title=\"${state.skinToneButtonLabel}\" aria-describedby=\"skintone-description\" aria-haspopup=\"listbox\" aria-expanded=\"${state.skinTonePickerExpanded}\" aria-controls=\"skintone-list\" data-on-click=\"onClickSkinToneButton\">${state.skinToneButtonText || ''}</button></div><span id=\"skintone-description\" class=\"sr-only\">${state.i18n.skinToneDescription}</span><div data-ref=\"skinToneDropdown\" id=\"skintone-list\" class=\"skintone-list hide-focus ${state.skinTonePickerExpanded ? '' : 'hidden no-animate'}\" style=\"transform:translateY(${state.skinTonePickerExpanded ? 0 : 'calc(-1 * var(--num-skintones) * var(--total-emoji-size))'})\" role=\"listbox\" aria-label=\"${state.i18n.skinTonesLabel}\" aria-activedescendant=\"skintone-${state.activeSkinTone}\" aria-hidden=\"${!state.skinTonePickerExpanded}\" tabIndex=\"-1\" data-on-focusout=\"onSkinToneOptionsFocusOut\" data-on-click=\"onSkinToneOptionsClick\" data-on-keydown=\"onSkinToneOptionsKeydown\" data-on-keyup=\"onSkinToneOptionsKeyup\">${\n    map(state.skinTones, (skinTone, i) => {\n    return html`<div id=\"skintone-${i}\" class=\"emoji ${i === state.activeSkinTone ? 'active' : ''}\" aria-selected=\"${i === state.activeSkinTone}\" role=\"option\" title=\"${state.i18n.skinTones[i]}\" aria-label=\"${state.i18n.skinTones[i]}\">${skinTone}</div>`\n    }, skinTone => skinTone)\n        }</div></div><div class=\"nav\" role=\"tablist\" style=\"grid-template-columns:repeat(${state.groups.length},1fr)\" aria-label=\"${state.i18n.categoriesLabel}\" data-on-keydown=\"onNavKeydown\" data-on-click=\"onNavClick\">${\n            map(state.groups, (group) => {\n              return html`<button role=\"tab\" class=\"nav-button\" aria-controls=\"tab-${group.id}\" aria-label=\"${state.i18n.categories[group.name]}\" aria-selected=\"${!state.searchMode && state.currentGroup.id === group.id}\" title=\"${state.i18n.categories[group.name]}\" data-group-id=\"${group.id}\"><div class=\"nav-emoji emoji\">${group.emoji}</div></button>`\n            }, group => group.id)\n          }</div><div class=\"indicator-wrapper\"><div class=\"indicator\" style=\"transform:translateX(${(/* istanbul ignore next */ (state.isRtl ? -1 : 1)) * state.currentGroupIndex * 100}%)\"></div></div><div class=\"message ${state.message ? '' : 'gone'}\" role=\"alert\" aria-live=\"polite\">${state.message || ''}</div><div data-ref=\"tabpanelElement\" class=\"tabpanel ${(!state.databaseLoaded || state.message) ? 'gone' : ''}\" role=\"${state.searchMode ? 'region' : 'tabpanel'}\" aria-label=\"${state.searchMode ? state.i18n.searchResultsLabel : state.i18n.categories[state.currentGroup.name]}\" id=\"${state.searchMode ? '' : `tab-${state.currentGroup.id}`}\" tabIndex=\"0\" data-on-click=\"onEmojiClick\"><div data-action=\"calculateEmojiGridStyle\">${\n              map(state.currentEmojisWithCategories, (emojiWithCategory, i) => {\n                return html`<div><div id=\"menu-label-${i}\" class=\"category ${state.currentEmojisWithCategories.length === 1 && state.currentEmojisWithCategories[0].category === '' ? 'gone' : ''}\" aria-hidden=\"true\">${\n                  state.searchMode\n                    ? state.i18n.searchResultsLabel\n                    : (\n                      emojiWithCategory.category\n                        ? emojiWithCategory.category\n                        : (\n                          state.currentEmojisWithCategories.length > 1\n                            ? state.i18n.categories.custom\n                            : state.i18n.categories[state.currentGroup.name]\n                        )\n                    )\n                }</div><div class=\"emoji-menu ${i !== 0 && !state.searchMode && state.currentGroup.id === -1 ? 'visibility-auto' : ''}\" style=\"${`--num-rows: ${Math.ceil(emojiWithCategory.emojis.length / state.numColumns)}`}\" data-action=\"updateOnIntersection\" role=\"${state.searchMode ? 'listbox' : 'menu'}\" aria-labelledby=\"menu-label-${i}\" id=\"${state.searchMode ? 'search-results' : ''}\">${\n              emojiList(emojiWithCategory.emojis, state.searchMode, /* prefix */ 'emo')\n            }</div></div>`\n              }, emojiWithCategory => emojiWithCategory.category)\n            }</div></div><div class=\"favorites onscreen emoji-menu ${state.message ? 'gone' : ''}\" role=\"menu\" aria-label=\"${state.i18n.favoritesLabel}\" data-on-click=\"onEmojiClick\">${\n            emojiList(state.currentFavorites, /* searchMode */ false, /* prefix */ 'fav')\n          }</div><button data-ref=\"baselineEmoji\" aria-hidden=\"true\" tabindex=\"-1\" class=\"abs-pos hidden emoji baseline-emoji\">😀</button></section>`\n  };\n\n  const rootDom = section();\n\n  // helper for traversing the dom, finding elements by an attribute, and getting the attribute value\n  const forElementWithAttribute = (attributeName, callback) => {\n    for (const element of container.querySelectorAll(`[${attributeName}]`)) {\n      callback(element, element.getAttribute(attributeName));\n    }\n  };\n\n  if (firstRender) { // not a re-render\n    container.appendChild(rootDom);\n\n    // we only bind events/refs once - there is no need to find them again given this component structure\n\n    // bind events\n    for (const eventName of ['click', 'focusout', 'input', 'keydown', 'keyup']) {\n      forElementWithAttribute(`data-on-${eventName}`, (element, listenerName) => {\n        element.addEventListener(eventName, events[listenerName]);\n      });\n    }\n\n    // find refs\n    forElementWithAttribute('data-ref', (element, ref) => {\n      refs[ref] = element;\n    });\n\n    // destroy/abort logic\n    abortSignal.addEventListener('abort', () => {\n      container.removeChild(rootDom);\n    });\n  }\n\n  // set up actions - these are re-bound on every render\n  forElementWithAttribute('data-action', (element, action) => {\n    let boundActions = actionContext.get(action);\n    if (!boundActions) {\n      actionContext.set(action, (boundActions = new WeakSet()));\n    }\n\n    // avoid applying the same action to the same element multiple times\n    if (!boundActions.has(element)) {\n      boundActions.add(element);\n      actions[action](element);\n    }\n  });\n}\n\n/* istanbul ignore next */\nconst qM = typeof queueMicrotask === 'function' ? queueMicrotask : callback => Promise.resolve().then(callback);\n\nfunction createState (abortSignal) {\n  let destroyed = false;\n  let currentObserver;\n\n  const propsToObservers = new Map();\n  const dirtyObservers = new Set();\n\n  let queued;\n\n  const flush = () => {\n    if (destroyed) {\n      return\n    }\n    const observersToRun = [...dirtyObservers];\n    dirtyObservers.clear(); // clear before running to force any new updates to run in another tick of the loop\n    try {\n      for (const observer of observersToRun) {\n        observer();\n      }\n    } finally {\n      queued = false;\n      if (dirtyObservers.size) { // new updates, queue another one\n        queued = true;\n        qM(flush);\n      }\n    }\n  };\n\n  const state = new Proxy({}, {\n    get (target, prop) {\n      if (currentObserver) {\n        let observers = propsToObservers.get(prop);\n        if (!observers) {\n          observers = new Set();\n          propsToObservers.set(prop, observers);\n        }\n        observers.add(currentObserver);\n      }\n      return target[prop]\n    },\n    set (target, prop, newValue) {\n      if (target[prop] !== newValue) {\n        target[prop] = newValue;\n        const observers = propsToObservers.get(prop);\n        if (observers) {\n          for (const observer of observers) {\n            dirtyObservers.add(observer);\n          }\n          if (!queued) {\n            queued = true;\n            qM(flush);\n          }\n        }\n      }\n      return true\n    }\n  });\n\n  const createEffect = (callback) => {\n    const runnable = () => {\n      const oldObserver = currentObserver;\n      currentObserver = runnable;\n      try {\n        return callback()\n      } finally {\n        currentObserver = oldObserver;\n      }\n    };\n    return runnable()\n  };\n\n  // destroy logic\n  abortSignal.addEventListener('abort', () => {\n    destroyed = true;\n  });\n\n  return {\n    state,\n    createEffect\n  }\n}\n\n// Compare two arrays, with a function called on each item in the two arrays that returns true if the items are equal\nfunction arraysAreEqualByFunction (left, right, areEqualFunc) {\n  if (left.length !== right.length) {\n    return false\n  }\n  for (let i = 0; i < left.length; i++) {\n    if (!areEqualFunc(left[i], right[i])) {\n      return false\n    }\n  }\n  return true\n}\n\nconst intersectionObserverCache = new WeakMap();\n\nfunction intersectionObserverAction (node, abortSignal, listener) {\n  /* istanbul ignore else */\n  {\n    // The scroll root is always `.tabpanel`\n    const root = node.closest('.tabpanel');\n\n    let observer = intersectionObserverCache.get(root);\n    if (!observer) {\n      // TODO: replace this with the contentvisibilityautostatechange event when all supported browsers support it.\n      // For now we use IntersectionObserver because it has better cross-browser support, and it would be bad for\n      // old Safari versions if they eagerly downloaded all custom emoji all at once.\n      observer = new IntersectionObserver(listener, {\n        root,\n        // trigger if we are 1/2 scroll container height away so that the images load a bit quicker while scrolling\n        rootMargin: '50% 0px 50% 0px',\n        // trigger if any part of the emoji grid is intersecting\n        threshold: 0\n      });\n\n      // avoid creating a new IntersectionObserver for every category; just use one for the whole root\n      intersectionObserverCache.set(root, observer);\n\n      // assume that the abortSignal is always the same for this root node; just add one event listener\n      abortSignal.addEventListener('abort', () => {\n        observer.disconnect();\n      });\n    }\n\n    observer.observe(node);\n  }\n}\n\n/* eslint-disable prefer-const,no-labels,no-inner-declarations */\n\n// constants\nconst EMPTY_ARRAY = [];\n\nconst { assign } = Object;\n\nfunction createRoot (shadowRoot, props) {\n  const refs = {};\n  const abortController = new AbortController();\n  const abortSignal = abortController.signal;\n  const { state, createEffect } = createState(abortSignal);\n  const actionContext = new Map();\n\n  // initial state\n  assign(state, {\n    skinToneEmoji: undefined,\n    i18n: undefined,\n    database: undefined,\n    customEmoji: undefined,\n    customCategorySorting: undefined,\n    emojiVersion: undefined\n  });\n\n  // public props\n  assign(state, props);\n\n  // private props\n  assign(state, {\n    initialLoad: true,\n    currentEmojis: [],\n    currentEmojisWithCategories: [],\n    rawSearchText: '',\n    searchText: '',\n    searchMode: false,\n    activeSearchItem: -1,\n    message: undefined,\n    skinTonePickerExpanded: false,\n    skinTonePickerExpandedAfterAnimation: false,\n    currentSkinTone: 0,\n    activeSkinTone: 0,\n    skinToneButtonText: undefined,\n    pickerStyle: undefined,\n    skinToneButtonLabel: '',\n    skinTones: [],\n    currentFavorites: [],\n    defaultFavoriteEmojis: undefined,\n    numColumns: DEFAULT_NUM_COLUMNS,\n    isRtl: false,\n    currentGroupIndex: 0,\n    groups: groups,\n    databaseLoaded: false,\n    activeSearchItemId: undefined\n  });\n\n  //\n  // Update the current group based on the currentGroupIndex\n  //\n  createEffect(() => {\n    if (state.currentGroup !== state.groups[state.currentGroupIndex]) {\n      state.currentGroup = state.groups[state.currentGroupIndex];\n    }\n  });\n\n  //\n  // Utils/helpers\n  //\n\n  const focus = id => {\n    shadowRoot.getElementById(id).focus();\n  };\n\n  const emojiToDomNode = emoji => shadowRoot.getElementById(`emo-${emoji.id}`);\n\n  // fire a custom event that crosses the shadow boundary\n  const fireEvent = (name, detail) => {\n    refs.rootElement.dispatchEvent(new CustomEvent(name, {\n      detail,\n      bubbles: true,\n      composed: true\n    }));\n  };\n\n  //\n  // Comparison utils\n  //\n\n  const compareEmojiArrays = (a, b) => a.id === b.id;\n\n  const compareCurrentEmojisWithCategories = (a, b) => {\n    const { category: aCategory, emojis: aEmojis } = a;\n    const { category: bCategory, emojis: bEmojis } = b;\n\n    if (aCategory !== bCategory) {\n      return false\n    }\n\n    return arraysAreEqualByFunction(aEmojis, bEmojis, compareEmojiArrays)\n  };\n\n  //\n  // Update utils to avoid excessive re-renders\n  //\n\n  // avoid excessive re-renders by checking the value before setting\n  const updateCurrentEmojis = (newEmojis) => {\n    if (!arraysAreEqualByFunction(state.currentEmojis, newEmojis, compareEmojiArrays)) {\n      state.currentEmojis = newEmojis;\n    }\n  };\n\n  // avoid excessive re-renders\n  const updateSearchMode = (newSearchMode) => {\n    if (state.searchMode !== newSearchMode) {\n      state.searchMode = newSearchMode;\n    }\n  };\n\n  // avoid excessive re-renders\n  const updateCurrentEmojisWithCategories = (newEmojisWithCategories) => {\n    if (!arraysAreEqualByFunction(state.currentEmojisWithCategories, newEmojisWithCategories, compareCurrentEmojisWithCategories)) {\n      state.currentEmojisWithCategories = newEmojisWithCategories;\n    }\n  };\n\n  // Helpers used by PickerTemplate\n\n  const unicodeWithSkin = (emoji, currentSkinTone) => (\n    (currentSkinTone && emoji.skins && emoji.skins[currentSkinTone]) || emoji.unicode\n  );\n\n  const labelWithSkin = (emoji, currentSkinTone) => (\n    uniq([\n      (emoji.name || unicodeWithSkin(emoji, currentSkinTone)),\n      emoji.annotation,\n      ...(emoji.shortcodes || EMPTY_ARRAY)\n    ].filter(Boolean)).join(', ')\n  );\n\n  const titleForEmoji = (emoji) => (\n    emoji.annotation || (emoji.shortcodes || EMPTY_ARRAY).join(', ')\n  );\n\n  const helpers = {\n    labelWithSkin, titleForEmoji, unicodeWithSkin\n  };\n  const events = {\n    onClickSkinToneButton,\n    onEmojiClick,\n    onNavClick,\n    onNavKeydown,\n    onSearchKeydown,\n    onSkinToneOptionsClick,\n    onSkinToneOptionsFocusOut,\n    onSkinToneOptionsKeydown,\n    onSkinToneOptionsKeyup,\n    onSearchInput\n  };\n  const actions = {\n    calculateEmojiGridStyle,\n    updateOnIntersection\n  };\n\n  let firstRender = true;\n  createEffect(() => {\n    render(shadowRoot, state, helpers, events, actions, refs, abortSignal, actionContext, firstRender);\n    firstRender = false;\n  });\n\n  //\n  // Determine the emoji support level (in requestIdleCallback)\n  //\n\n  // mount logic\n  if (!state.emojiVersion) {\n    detectEmojiSupportLevel().then(level => {\n      // Can't actually test emoji support in Jest/Vitest/JSDom, emoji never render in color in Cairo\n      /* istanbul ignore next */\n      if (!level) {\n        state.message = state.i18n.emojiUnsupportedMessage;\n      }\n    });\n  }\n\n  //\n  // Set or update the database object\n  //\n\n  createEffect(() => {\n    // show a Loading message if it takes a long time, or show an error if there's a network/IDB error\n    async function handleDatabaseLoading () {\n      let showingLoadingMessage = false;\n      const timeoutHandle = setTimeout(() => {\n        showingLoadingMessage = true;\n        state.message = state.i18n.loadingMessage;\n      }, TIMEOUT_BEFORE_LOADING_MESSAGE);\n      try {\n        await state.database.ready();\n        state.databaseLoaded = true; // eslint-disable-line no-unused-vars\n      } catch (err) {\n        console.error(err);\n        state.message = state.i18n.networkErrorMessage;\n      } finally {\n        clearTimeout(timeoutHandle);\n        if (showingLoadingMessage) { // Seems safer than checking the i18n string, which may change\n          showingLoadingMessage = false;\n          state.message = ''; // eslint-disable-line no-unused-vars\n        }\n      }\n    }\n\n    if (state.database) {\n      /* no await */\n      handleDatabaseLoading();\n    }\n  });\n\n  //\n  // Global styles for the entire picker\n  //\n\n  createEffect(() => {\n    state.pickerStyle = `\n      --num-groups: ${state.groups.length}; \n      --indicator-opacity: ${state.searchMode ? 0 : 1}; \n      --num-skintones: ${NUM_SKIN_TONES};`;\n  });\n\n  //\n  // Set or update the customEmoji\n  //\n\n  createEffect(() => {\n    if (state.customEmoji && state.database) {\n      updateCustomEmoji(); // re-run whenever customEmoji change\n    }\n  });\n\n  createEffect(() => {\n    if (state.customEmoji && state.customEmoji.length) {\n      if (state.groups !== allGroups) { // don't update unnecessarily\n        state.groups = allGroups;\n      }\n    } else if (state.groups !== groups) {\n      if (state.currentGroupIndex) {\n        // If the current group is anything other than \"custom\" (which is first), decrement.\n        // This fixes the odd case where you set customEmoji, then pick a category, then unset customEmoji\n        state.currentGroupIndex--;\n      }\n      state.groups = groups;\n    }\n  });\n\n  //\n  // Set or update the preferred skin tone\n  //\n\n  createEffect(() => {\n    async function updatePreferredSkinTone () {\n      if (state.databaseLoaded) {\n        state.currentSkinTone = await state.database.getPreferredSkinTone();\n      }\n    }\n\n    /* no await */ updatePreferredSkinTone();\n  });\n\n  createEffect(() => {\n    state.skinTones = Array(NUM_SKIN_TONES).fill().map((_, i) => applySkinTone(state.skinToneEmoji, i));\n  });\n\n  createEffect(() => {\n    state.skinToneButtonText = state.skinTones[state.currentSkinTone];\n  });\n\n  createEffect(() => {\n    state.skinToneButtonLabel = state.i18n.skinToneLabel.replace('{skinTone}', state.i18n.skinTones[state.currentSkinTone]);\n  });\n\n  //\n  // Set or update the favorites emojis\n  //\n\n  createEffect(() => {\n    async function updateDefaultFavoriteEmojis () {\n      const { database } = state;\n      const favs = (await Promise.all(MOST_COMMONLY_USED_EMOJI.map(unicode => (\n        database.getEmojiByUnicodeOrName(unicode)\n      )))).filter(Boolean); // filter because in Jest/Vitest tests we don't have all the emoji in the DB\n      state.defaultFavoriteEmojis = favs;\n    }\n\n    if (state.databaseLoaded) {\n      /* no await */ updateDefaultFavoriteEmojis();\n    }\n  });\n\n  function updateCustomEmoji () {\n    // Certain effects have an implicit dependency on customEmoji since it affects the database\n    // Getting it here on the state ensures this effect re-runs when customEmoji change.\n    const { customEmoji, database } = state;\n    const databaseCustomEmoji = customEmoji || EMPTY_ARRAY;\n    if (database.customEmoji !== databaseCustomEmoji) {\n      // Avoid setting this if the customEmoji have _not_ changed, because the setter triggers a re-computation of the\n      // `customEmojiIndex`. Note we don't bother with deep object changes.\n      database.customEmoji = databaseCustomEmoji;\n    }\n  }\n\n  createEffect(() => {\n    async function updateFavorites () {\n      updateCustomEmoji(); // re-run whenever customEmoji change\n      const { database, defaultFavoriteEmojis, numColumns } = state;\n      const dbFavorites = await database.getTopFavoriteEmoji(numColumns);\n      const favorites = await summarizeEmojis(uniqBy([\n        ...dbFavorites,\n        ...defaultFavoriteEmojis\n      ], _ => (_.unicode || _.name)).slice(0, numColumns));\n      state.currentFavorites = favorites;\n    }\n\n    if (state.databaseLoaded && state.defaultFavoriteEmojis) {\n      /* no await */ updateFavorites();\n    }\n  });\n\n  //\n  // Re-run whenever the emoji grid changes size, and re-calc style/layout-related state variables:\n  // 1) Re-calculate the --num-columns var because it may have changed\n  // 2) Re-calculate whether we're in RTL mode or not.\n  //\n  // The benefit of doing this in one place is to align with rAF/ResizeObserver\n  // and do all the calculations in one go. RTL vs LTR is not strictly layout-related,\n  // but since we're already reading the style here, and since it's already aligned with\n  // the rAF loop, this is the most appropriate place to do it perf-wise.\n  //\n\n  function calculateEmojiGridStyle (node) {\n    resizeObserverAction(node, abortSignal, () => {\n      /* istanbul ignore next */\n      { // jsdom throws errors for this kind of fancy stuff\n        // read all the style/layout calculations we need to make\n        const style = getComputedStyle(refs.rootElement);\n        const newNumColumns = parseInt(style.getPropertyValue('--num-columns'), 10);\n        const newIsRtl = style.getPropertyValue('direction') === 'rtl';\n\n        // write to state variables\n        state.numColumns = newNumColumns;\n        state.isRtl = newIsRtl;\n      }\n    });\n  }\n\n  // Re-run whenever the custom emoji in a category are shown/hidden. This is an optimization that simulates\n  // what we'd get from `<img loading=lazy>` but without rendering an `<img>`.\n  function updateOnIntersection (node) {\n    intersectionObserverAction(node, abortSignal, (entries) => {\n      for (const { target, isIntersecting } of entries) {\n        target.classList.toggle('onscreen', isIntersecting);\n      }\n    });\n  }\n\n  //\n  // Set or update the currentEmojis. Check for invalid ZWJ renderings\n  // (i.e. double emoji).\n  //\n\n  createEffect(() => {\n    async function updateEmojis () {\n      const { searchText, currentGroup, databaseLoaded, customEmoji } = state;\n      if (!databaseLoaded) {\n        state.currentEmojis = [];\n        state.searchMode = false;\n      } else if (searchText.length >= MIN_SEARCH_TEXT_LENGTH) {\n        const newEmojis = await getEmojisBySearchQuery(searchText);\n        if (state.searchText === searchText) { // if the situation changes asynchronously, do not update\n          updateCurrentEmojis(newEmojis);\n          updateSearchMode(true);\n        }\n      } else { // database is loaded and we're not in search mode, so we're in normal category mode\n        const { id: currentGroupId } = currentGroup;\n        // avoid race condition where currentGroupId is -1 and customEmoji is undefined/empty\n        if (currentGroupId !== -1 || (customEmoji && customEmoji.length)) {\n          const newEmojis = await getEmojisByGroup(currentGroupId);\n          if (state.currentGroup.id === currentGroupId) { // if the situation changes asynchronously, do not update\n            updateCurrentEmojis(newEmojis);\n            updateSearchMode(false);\n          }\n        }\n      }\n    }\n\n    /* no await */ updateEmojis();\n  });\n\n  const resetScrollTopInRaf = () => {\n    rAF(() => resetScrollTopIfPossible(refs.tabpanelElement));\n  };\n\n  // Some emojis have their ligatures rendered as two or more consecutive emojis\n  // We want to treat these the same as unsupported emojis, so we compare their\n  // widths against the baseline widths and remove them as necessary\n  createEffect(() => {\n    const { currentEmojis, emojiVersion } = state;\n    const zwjEmojisToCheck = currentEmojis\n      .filter(emoji => emoji.unicode) // filter custom emoji\n      .filter(emoji => hasZwj(emoji) && !supportedZwjEmojis.has(emoji.unicode));\n    if (!emojiVersion && zwjEmojisToCheck.length) {\n      // render now, check their length later\n      updateCurrentEmojis(currentEmojis);\n      rAF(() => checkZwjSupportAndUpdate(zwjEmojisToCheck));\n    } else {\n      const newEmojis = emojiVersion ? currentEmojis : currentEmojis.filter(isZwjSupported);\n      updateCurrentEmojis(newEmojis);\n      // Reset scroll top to 0 when emojis change\n      resetScrollTopInRaf();\n    }\n  });\n\n  function checkZwjSupportAndUpdate (zwjEmojisToCheck) {\n    const allSupported = checkZwjSupport(zwjEmojisToCheck, refs.baselineEmoji, emojiToDomNode);\n    if (allSupported) {\n      // Even if all emoji are supported, we still need to reset the scroll top to 0 when emojis change\n      resetScrollTopInRaf();\n    } else {\n      // Force update. We only do this if there are any unsupported ZWJ characters since otherwise,\n      // for browsers that support all emoji, it would be an unnecessary extra re-render.\n      state.currentEmojis = [...state.currentEmojis];\n    }\n  }\n\n  function isZwjSupported (emoji) {\n    return !emoji.unicode || !hasZwj(emoji) || supportedZwjEmojis.get(emoji.unicode)\n  }\n\n  async function filterEmojisByVersion (emojis) {\n    const emojiSupportLevel = state.emojiVersion || await detectEmojiSupportLevel();\n    // !version corresponds to custom emoji\n    return emojis.filter(({ version }) => !version || version <= emojiSupportLevel)\n  }\n\n  async function summarizeEmojis (emojis) {\n    return summarizeEmojisForUI(emojis, state.emojiVersion || await detectEmojiSupportLevel())\n  }\n\n  async function getEmojisByGroup (group) {\n    // -1 is custom emoji\n    const emoji = group === -1 ? state.customEmoji : await state.database.getEmojiByGroup(group);\n    return summarizeEmojis(await filterEmojisByVersion(emoji))\n  }\n\n  async function getEmojisBySearchQuery (query) {\n    return summarizeEmojis(await filterEmojisByVersion(await state.database.getEmojiBySearchQuery(query)))\n  }\n\n  createEffect(() => {\n  });\n\n  //\n  // Derive currentEmojisWithCategories from currentEmojis. This is always done even if there\n  // are no categories, because it's just easier to code the HTML this way.\n  //\n\n  createEffect(() => {\n    function calculateCurrentEmojisWithCategories () {\n      const { searchMode, currentEmojis } = state;\n      if (searchMode) {\n        return [\n          {\n            category: '',\n            emojis: currentEmojis\n          }\n        ]\n      }\n      const categoriesToEmoji = new Map();\n      for (const emoji of currentEmojis) {\n        const category = emoji.category || '';\n        let emojis = categoriesToEmoji.get(category);\n        if (!emojis) {\n          emojis = [];\n          categoriesToEmoji.set(category, emojis);\n        }\n        emojis.push(emoji);\n      }\n      return [...categoriesToEmoji.entries()]\n        .map(([category, emojis]) => ({ category, emojis }))\n        .sort((a, b) => state.customCategorySorting(a.category, b.category))\n    }\n\n    const newEmojisWithCategories = calculateCurrentEmojisWithCategories();\n    updateCurrentEmojisWithCategories(newEmojisWithCategories);\n  });\n\n  //\n  // Handle active search item (i.e. pressing up or down while searching)\n  //\n\n  createEffect(() => {\n    state.activeSearchItemId = state.activeSearchItem !== -1 && state.currentEmojis[state.activeSearchItem].id;\n  });\n\n  //\n  // Handle user input on the search input\n  //\n\n  createEffect(() => {\n    const { rawSearchText } = state;\n    rIC(() => {\n      state.searchText = (rawSearchText || '').trim(); // defer to avoid input delays, plus we can trim here\n      state.activeSearchItem = -1;\n    });\n  });\n\n  function onSearchKeydown (event) {\n    if (!state.searchMode || !state.currentEmojis.length) {\n      return\n    }\n\n    const goToNextOrPrevious = (previous) => {\n      halt(event);\n      state.activeSearchItem = incrementOrDecrement(previous, state.activeSearchItem, state.currentEmojis);\n    };\n\n    switch (event.key) {\n      case 'ArrowDown':\n        return goToNextOrPrevious(false)\n      case 'ArrowUp':\n        return goToNextOrPrevious(true)\n      case 'Enter':\n        if (state.activeSearchItem === -1) {\n          // focus the first option in the list since the list must be non-empty at this point (it's verified above)\n          state.activeSearchItem = 0;\n        } else { // there is already an active search item\n          halt(event);\n          return clickEmoji(state.currentEmojis[state.activeSearchItem].id)\n        }\n    }\n  }\n\n  //\n  // Handle user input on nav\n  //\n\n  function onNavClick (event) {\n    const { target } = event;\n    const closestTarget = target.closest('.nav-button');\n    /* istanbul ignore if */\n    if (!closestTarget) {\n      return // This should never happen, but makes me nervous not to have it\n    }\n    const groupId = parseInt(closestTarget.dataset.groupId, 10);\n    refs.searchElement.value = ''; // clear search box input\n    state.rawSearchText = '';\n    state.searchText = '';\n    state.activeSearchItem = -1;\n    state.currentGroupIndex = state.groups.findIndex(_ => _.id === groupId);\n  }\n\n  function onNavKeydown (event) {\n    const { target, key } = event;\n\n    const doFocus = el => {\n      if (el) {\n        halt(event);\n        el.focus();\n      }\n    };\n\n    switch (key) {\n      case 'ArrowLeft':\n        return doFocus(target.previousElementSibling)\n      case 'ArrowRight':\n        return doFocus(target.nextElementSibling)\n      case 'Home':\n        return doFocus(target.parentElement.firstElementChild)\n      case 'End':\n        return doFocus(target.parentElement.lastElementChild)\n    }\n  }\n\n  //\n  // Handle user input on an emoji\n  //\n\n  async function clickEmoji (unicodeOrName) {\n    const emoji = await state.database.getEmojiByUnicodeOrName(unicodeOrName);\n    const emojiSummary = [...state.currentEmojis, ...state.currentFavorites]\n      .find(_ => (_.id === unicodeOrName));\n    const skinTonedUnicode = emojiSummary.unicode && unicodeWithSkin(emojiSummary, state.currentSkinTone);\n    await state.database.incrementFavoriteEmojiCount(unicodeOrName);\n    fireEvent('emoji-click', {\n      emoji,\n      skinTone: state.currentSkinTone,\n      ...(skinTonedUnicode && { unicode: skinTonedUnicode }),\n      ...(emojiSummary.name && { name: emojiSummary.name })\n    });\n  }\n\n  async function onEmojiClick (event) {\n    const { target } = event;\n    /* istanbul ignore if */\n    if (!target.classList.contains('emoji')) {\n      // This should never happen, but makes me nervous not to have it\n      return\n    }\n    halt(event);\n    const id = target.id.substring(4); // replace 'emo-' or 'fav-' prefix\n\n    /* no await */ clickEmoji(id);\n  }\n\n  //\n  // Handle user input on the skintone picker\n  //\n\n  function changeSkinTone (skinTone) {\n    state.currentSkinTone = skinTone;\n    state.skinTonePickerExpanded = false;\n    focus('skintone-button');\n    fireEvent('skin-tone-change', { skinTone });\n    /* no await */ state.database.setPreferredSkinTone(skinTone);\n  }\n\n  function onSkinToneOptionsClick (event) {\n    const { target: { id } } = event;\n    const match = id && id.match(/^skintone-(\\d)/); // skintone option format\n    /* istanbul ignore if */\n    if (!match) { // not a skintone option\n      return // This should never happen, but makes me nervous not to have it\n    }\n    halt(event);\n    const skinTone = parseInt(match[1], 10); // remove 'skintone-' prefix\n    changeSkinTone(skinTone);\n  }\n\n  function onClickSkinToneButton (event) {\n    state.skinTonePickerExpanded = !state.skinTonePickerExpanded;\n    state.activeSkinTone = state.currentSkinTone;\n    // this should always be true, since the button is obscured by the listbox, so this `if` is just to be sure\n    if (state.skinTonePickerExpanded) {\n      halt(event);\n      rAF(() => focus('skintone-list'));\n    }\n  }\n\n  // To make the animation nicer, change the z-index of the skintone picker button\n  // *after* the animation has played. This makes it appear that the picker box\n  // is expanding \"below\" the button\n  createEffect(() => {\n    if (state.skinTonePickerExpanded) {\n      refs.skinToneDropdown.addEventListener('transitionend', () => {\n        state.skinTonePickerExpandedAfterAnimation = true; // eslint-disable-line no-unused-vars\n      }, { once: true });\n    } else {\n      state.skinTonePickerExpandedAfterAnimation = false; // eslint-disable-line no-unused-vars\n    }\n  });\n\n  function onSkinToneOptionsKeydown (event) {\n    // this should never happen, but makes me nervous not to have it\n    /* istanbul ignore if */\n    if (!state.skinTonePickerExpanded) {\n      return\n    }\n    const changeActiveSkinTone = async nextSkinTone => {\n      halt(event);\n      state.activeSkinTone = nextSkinTone;\n    };\n\n    switch (event.key) {\n      case 'ArrowUp':\n        return changeActiveSkinTone(incrementOrDecrement(true, state.activeSkinTone, state.skinTones))\n      case 'ArrowDown':\n        return changeActiveSkinTone(incrementOrDecrement(false, state.activeSkinTone, state.skinTones))\n      case 'Home':\n        return changeActiveSkinTone(0)\n      case 'End':\n        return changeActiveSkinTone(state.skinTones.length - 1)\n      case 'Enter':\n        // enter on keydown, space on keyup. this is just how browsers work for buttons\n        // https://lists.w3.org/Archives/Public/w3c-wai-ig/2019JanMar/0086.html\n        halt(event);\n        return changeSkinTone(state.activeSkinTone)\n      case 'Escape':\n        halt(event);\n        state.skinTonePickerExpanded = false;\n        return focus('skintone-button')\n    }\n  }\n\n  function onSkinToneOptionsKeyup (event) {\n    // this should never happen, but makes me nervous not to have it\n    /* istanbul ignore if */\n    if (!state.skinTonePickerExpanded) {\n      return\n    }\n    switch (event.key) {\n      case ' ':\n        // enter on keydown, space on keyup. this is just how browsers work for buttons\n        // https://lists.w3.org/Archives/Public/w3c-wai-ig/2019JanMar/0086.html\n        halt(event);\n        return changeSkinTone(state.activeSkinTone)\n    }\n  }\n\n  async function onSkinToneOptionsFocusOut (event) {\n    // On blur outside of the skintone listbox, collapse the skintone picker.\n    const { relatedTarget } = event;\n    // The `else` should never happen, but makes me nervous not to have it\n    /* istanbul ignore else */\n    if (!relatedTarget || relatedTarget.id !== 'skintone-list') {\n      state.skinTonePickerExpanded = false;\n    }\n  }\n\n  function onSearchInput (event) {\n    state.rawSearchText = event.target.value;\n  }\n\n  return {\n    $set (newState) {\n      assign(state, newState);\n    },\n    $destroy () {\n      abortController.abort();\n    }\n  }\n}\n\nconst DEFAULT_DATA_SOURCE = 'https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json';\nconst DEFAULT_LOCALE = 'en';\n\nvar enI18n = {\n  categoriesLabel: 'Categories',\n  emojiUnsupportedMessage: 'Your browser does not support color emoji.',\n  favoritesLabel: 'Favorites',\n  loadingMessage: 'Loading…',\n  networkErrorMessage: 'Could not load emoji.',\n  regionLabel: 'Emoji picker',\n  searchDescription: 'When search results are available, press up or down to select and enter to choose.',\n  searchLabel: 'Search',\n  searchResultsLabel: 'Search results',\n  skinToneDescription: 'When expanded, press up or down to select and enter to choose.',\n  skinToneLabel: 'Choose a skin tone (currently {skinTone})',\n  skinTonesLabel: 'Skin tones',\n  skinTones: [\n    'Default',\n    'Light',\n    'Medium-Light',\n    'Medium',\n    'Medium-Dark',\n    'Dark'\n  ],\n  categories: {\n    custom: 'Custom',\n    'smileys-emotion': 'Smileys and emoticons',\n    'people-body': 'People and body',\n    'animals-nature': 'Animals and nature',\n    'food-drink': 'Food and drink',\n    'travel-places': 'Travel and places',\n    activities: 'Activities',\n    objects: 'Objects',\n    symbols: 'Symbols',\n    flags: 'Flags'\n  }\n};\n\nvar baseStyles = \":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--border-radius:0;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){color-scheme:light;--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);border-radius:var(--border-radius);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;scrollbar-gutter:stable;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.emoji-menu.visibility-auto{content-visibility:auto;contain-intrinsic-size:calc(var(--num-columns)*var(--total-emoji-size)) calc(var(--num-rows)*var(--total-emoji-size))}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;height:var(--total-emoji-size);width:var(--total-emoji-size);line-height:1;overflow:hidden;font-family:var(--emoji-font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.onscreen .custom-emoji::after{content:\\\"\\\";width:var(--emoji-size);height:var(--emoji-size);background-repeat:no-repeat;background-position:center center;background-size:contain;background-image:var(--custom-emoji-background)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{overflow-y:auto;scrollbar-gutter:stable;display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}\";\n\nconst PROPS = [\n  'customEmoji',\n  'customCategorySorting',\n  'database',\n  'dataSource',\n  'i18n',\n  'locale',\n  'skinToneEmoji',\n  'emojiVersion'\n];\n\n// Styles injected ourselves, so we can declare the FONT_FAMILY variable in one place\nconst EXTRA_STYLES = `:host{--emoji-font-family:${FONT_FAMILY}}`;\n\nclass PickerElement extends HTMLElement {\n  constructor (props) {\n    super();\n    this.attachShadow({ mode: 'open' });\n    const style = document.createElement('style');\n    style.textContent = baseStyles + EXTRA_STYLES;\n    this.shadowRoot.appendChild(style);\n    this._ctx = {\n      // Set defaults\n      locale: DEFAULT_LOCALE,\n      dataSource: DEFAULT_DATA_SOURCE,\n      skinToneEmoji: DEFAULT_SKIN_TONE_EMOJI,\n      customCategorySorting: DEFAULT_CATEGORY_SORTING,\n      customEmoji: null,\n      i18n: enI18n,\n      emojiVersion: null,\n      ...props\n    };\n    // Handle properties set before the element was upgraded\n    for (const prop of PROPS) {\n      if (prop !== 'database' && Object.prototype.hasOwnProperty.call(this, prop)) {\n        this._ctx[prop] = this[prop];\n        delete this[prop];\n      }\n    }\n    this._dbFlush(); // wait for a flush before creating the db, in case the user calls e.g. a setter or setAttribute\n  }\n\n  connectedCallback () {\n    // The _cmp may be defined if the component was immediately disconnected and then reconnected. In that case,\n    // do nothing (preserve the state)\n    if (!this._cmp) {\n      this._cmp = createRoot(this.shadowRoot, this._ctx);\n    }\n  }\n\n  disconnectedCallback () {\n    // Check in a microtask if the element is still connected. If so, treat this as a \"move\" rather than a disconnect\n    // Inspired by Vue: https://vuejs.org/guide/extras/web-components.html#building-custom-elements-with-vue\n    qM(() => {\n      // this._cmp may be defined if connect-disconnect-connect-disconnect occurs synchronously\n      if (!this.isConnected && this._cmp) {\n        this._cmp.$destroy();\n        this._cmp = undefined;\n\n        const { database } = this._ctx;\n        database.close()\n          // only happens if the database failed to load in the first place, so we don't care\n          .catch(err => console.error(err));\n      }\n    });\n  }\n\n  static get observedAttributes () {\n    return ['locale', 'data-source', 'skin-tone-emoji', 'emoji-version'] // complex objects aren't supported, also use kebab-case\n  }\n\n  attributeChangedCallback (attrName, oldValue, newValue) {\n    this._set(\n      // convert from kebab-case to camelcase\n      // see https://github.com/sveltejs/svelte/issues/3852#issuecomment-665037015\n      attrName.replace(/-([a-z])/g, (_, up) => up.toUpperCase()),\n      // convert string attribute to float if necessary\n      attrName === 'emoji-version' ? parseFloat(newValue) : newValue\n    );\n  }\n\n  _set (prop, newValue) {\n    this._ctx[prop] = newValue;\n    if (this._cmp) {\n      this._cmp.$set({ [prop]: newValue });\n    }\n    if (['locale', 'dataSource'].includes(prop)) {\n      this._dbFlush();\n    }\n  }\n\n  _dbCreate () {\n    const { locale, dataSource, database } = this._ctx;\n    // only create a new database if we really need to\n    if (!database || database.locale !== locale || database.dataSource !== dataSource) {\n      this._set('database', new Database({ locale, dataSource }));\n    }\n  }\n\n  // Update the Database in one microtask if the locale/dataSource change. We do one microtask\n  // so we don't create two Databases if e.g. both the locale and the dataSource change\n  _dbFlush () {\n    qM(() => (\n      this._dbCreate()\n    ));\n  }\n}\n\nconst definitions = {};\n\nfor (const prop of PROPS) {\n  definitions[prop] = {\n    get () {\n      if (prop === 'database') {\n        // in rare cases, the microtask may not be flushed yet, so we need to instantiate the DB\n        // now if the user is asking for it\n        this._dbCreate();\n      }\n      return this._ctx[prop]\n    },\n    set (val) {\n      if (prop === 'database') {\n        throw new Error('database is read-only')\n      }\n      this._set(prop, val);\n    }\n  };\n}\n\nObject.defineProperties(PickerElement.prototype, definitions);\n\n/* istanbul ignore else */\nif (!customElements.get('emoji-picker')) { // if already defined, do nothing (e.g. same script imported twice)\n  customElements.define('emoji-picker', PickerElement);\n}\n\nexport { PickerElement as default };\n","import { Chrono } from 'chrono-node';\nimport 'emoji-picker-element';\nlet theme = 'light';\nbrowser.storage.local.get([\"sidebarCollapsed\", \"theme\"], (data) => {\n    try {\n        const sidebar = document.getElementById('sidebar');\n        sidebar.classList.add('no-transition');\n        if (data.sidebarCollapsed) {\n            sidebar.classList.add('collapsed');\n        }\n        if (data.theme) {\n            theme = data.theme;\n            document.body.className = data.theme;\n        }\n\n        setTimeout(() => {\n            sidebar.classList.remove('no-transition');\n        }, 100);\n    } catch (error) {\n        console.error('Error updating sidebar:', error);\n    }\n});\nfunction toggleTheme(){\n    theme = theme === 'light' ? 'dark' : 'light';\n    document.body.className = theme;\n    const emojiPickers = document.querySelectorAll('emoji-picker');\n    emojiPickers.forEach(picker => {\n        picker.className = picker.className.replace(/light|dark/g, theme);\n    });\n    browser.storage.local.set({ theme });\n}\nconst scrollAnimation = {\n    isScrolling: false,\n    scrollX: 0,\n    scrollY: 0,\n    animationFrameId: null\n};\nconst settingsButton = document.querySelector('.settings-button');\nconst columnsContainer = document.getElementById('columns-container');\nconst colorOptions = ['tab-default', 'tab-pink', 'tab-yellow', 'tab-blue', 'tab-purple'];\nlet dropIndicator = null;\nlet dropType = null;\nlet deletionArea = null;\nlet newColumnIndicator = null;\nlet lastSelectedIndex = null;\nlet activeColumnMenu = null;\nlet activeOptionsMenu = null;\nlet activeColorMenu = null;\nlet activeSettingsMenu = null;\nlet tabs_in_storage = [];\nfunction getToday(tabDate) {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0); // Normalize to start of the day\n\n    const parsedDate = new Date(tabDate);\n    parsedDate.setHours(0, 0, 0, 0); // Normalize to start of the day\n\n    const diffTime = parsedDate.getTime() - today.getTime();\n    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n    return diffDays;\n}\nconst getRandomEmoji = () => {\n    const range = [0x1F34F, 0x1F37F]; // Food and Drink        \n    const codePoint = Math.floor(Math.random() * (range[1] - range[0] + 1)) + range[0];\n    return String.fromCodePoint(codePoint);\n};\ndocument.getElementById(\"add-column\").addEventListener(\"click\", () => {\n    createColumn();\n    saveColumnState();\n});\n\nfunction createDeletionArea() {\n    deletionArea = document.createElement('div');\n    deletionArea.id = 'deletion-area';\n\n    const deleteIcon = document.createElement('div');\n    deleteIcon.innerHTML = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"40\" height=\"40\" class=\"main-grid-item-icon\" fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\">\n      <polyline points=\"3 6 5 6 21 6\" />\n      <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\n      <line x1=\"10\" x2=\"10\" y1=\"11\" y2=\"17\" />\n      <line x1=\"14\" x2=\"14\" y1=\"11\" y2=\"17\" />\n    </svg>`;\n    deleteIcon.alt = 'Delete Icon';\n    deleteIcon.classList.add('delete-icon');\n    deletionArea.appendChild(deleteIcon);\n\n    deletionArea.addEventListener('dragover', handleDragOver);\n    deletionArea.addEventListener('drop', handleDrop);\n    deletionArea.addEventListener('dragleave', function(event) {\n        if (!deletionArea.contains(event.relatedTarget)) {\n            deletionArea.classList.remove('deletion-area-active');\n        }\n    });\n    document.body.appendChild(deletionArea);\n}\ncreateDeletionArea();\nfunction closeAllMenus() {\n    [activeOptionsMenu, activeColorMenu, activeColumnMenu, activeSettingsMenu].forEach(menu => {\n        if (menu) {\n            menu.remove();\n        }\n    });\n    activeOptionsMenu = activeColorMenu = activeColumnMenu = activeSettingsMenu = null;\n}\nfunction getBrowser() {\n    const userAgent = navigator.userAgent.toLowerCase();\n    if (userAgent.indexOf('firefox') > -1) {\n        return 'firefox';\n    }\n    else if (userAgent.indexOf('safari') > -1) {\n        return 'safari';\n    }\n    else {\n        return 'chrome';\n    }\n}\nconst userBrowser = getBrowser();\n\n/* Tab and Subgroup Functions */\nfunction deleteTab(id, column = null, li = null) {\n    if (!Array.isArray(id)) id = [id];\n\n    browser.storage.local.get(\"savedTabs\", (data) => {\n        const tabs = data.savedTabs || [];\n        id.forEach(tabId => {\n            const index = tabs.findIndex(tab => tab.id === tabId);\n            if (index !== -1) {\n                tabs.splice(index, 1); // Remove the tab at the specified index\n                //console.log('Tab deleted:', tabId);\n            }\n        });\n\n        if(column){\n            column.remove();\n        }\n        else if(li){\n            li.remove();\n        }\n        browser.storage.local.set({ savedTabs: tabs, columnState: saveColumnState(true) }, () => {\n            //console.log('Updated storage with remaining columns');\n        });\n    });\n}\nfunction deleteSubgroup(groupId) {\n    const li = document.getElementById(groupId);\n    const tabIds = Array.from(li.querySelectorAll('.subgroup-favicon')).map(favicon => parseInt(favicon.id.split('-')[1]));\n    li.remove();\n    deleteTab(tabIds);\n}\nfunction ungroupSubgroup(groupId) {\n    browser.storage.local.get(['columnState', 'savedTabs'], (data) => {\n        const columnState = data.columnState || [];\n        const savedTabs = data.savedTabs || [];\n\n        // Find which column contains the subgroup\n        for (let column of columnState) {\n            const tabIds = column.tabIds;\n            const subgroupIndex = tabIds.findIndex(id => Array.isArray(id) && id[0] === groupId);\n            \n            if (subgroupIndex !== -1) {\n                // Get the subgroup array\n                const subgroup = tabIds[subgroupIndex];\n                // Remove the subgroup itself\n                tabIds.splice(subgroupIndex, 1);\n                // Add all tabs from subgroup individually\n                const individualTabs = subgroup.slice(1, -2);\n                tabIds.splice(subgroupIndex, 0, ...individualTabs);\n                \n                // Save the updated state\n                browser.storage.local.set({ columnState: columnState, savedTabs: savedTabs }, () => {\n                    console.log('Subgroup ungrouped:', groupId);\n                });\n                break;\n            }\n        }\n    });\n}\nfunction saveTab(tabId) {\n    const tabIds = Array.isArray(tabId) ? tabId : [tabId];\n    const newTabs = [];\n\n    tabIds.forEach(id => {\n        const numericId = parseInt(id.replace('tab-', ''));\n        browser.tabs.get(numericId, (tab) => {\n            const newTab = {\n                title: tab.title,\n                url: tab.url,\n                favIconUrl: tab.favIconUrl || getFaviconUrl(tab.url),\n                id: numericId,\n                color: '#FFFFFF'\n            };\n            newTabs.push(newTab);\n\n            if (newTabs.length === tabIds.length) {\n                browser.storage.local.get(\"savedTabs\", (data) => {\n                    const existingTabs = data.savedTabs || [];\n                    const updatedTabs = [...existingTabs, ...newTabs];\n                    browser.storage.local.set({ savedTabs: updatedTabs, columnState: saveColumnState(true) }, () => {\n                        browser.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n                            let activeTab = tabs[0];\n                            browser.tabs.remove(tabIds.map(id => parseInt(id.replace('tab-', ''))), () => {\n                                // Ensure the focus remains on the active tab\n                                browser.tabs.update(activeTab.id, { active: true });\n                            });\n                        });\n                    });\n                });\n            }\n        });\n    });\n}\n\n/* Tab Menu Actions */\nfunction createMenuDropdown(menuItems, button) {\n    const menuDropdown = document.createElement(\"div\");\n    menuDropdown.className = \"options-menu\";\n\n    menuItems.forEach(item => {\n        if (item.hidden) return;\n        const menuItem = document.createElement(\"button\");\n        menuItem.classList.add(\"menu-option\");\n        menuItem.innerHTML = `\n            <span>${item.text}</span>\n        `;\n        menuItem.addEventListener(\"click\", (e) => {\n            e.stopPropagation();\n            item.action(e);\n            menuDropdown.style.display = \"none\";\n        });\n        menuDropdown.appendChild(menuItem);\n    });\n\n    // Position the dropdown relative to the button\n    const buttonRect = button.getBoundingClientRect();\n    menuDropdown.style.position = \"fixed\";\n    menuDropdown.style.top = `${buttonRect.bottom + 5}px`;\n    menuDropdown.style.right = `${window.innerWidth - buttonRect.right}px`;\n\n    document.body.appendChild(menuDropdown);\n    return menuDropdown;\n}\nfunction renameTab(tab, li) {\n    li.removeEventListener('dragstart', handleDragStart);\n    li.draggable = false;\n    const column = li.closest('.column');\n    column.draggable = false;\n    const subgroup = li.closest('.subgroup-item');\n    if (subgroup) subgroup.draggable = false;\n    \n    const titleDisplay = li.querySelector(`#title-display-${tab.id}`);\n    const titleInput = li.querySelector(`#title-input-${tab.id}`);\n    \n    titleInput.classList.remove(\"hidden\");\n    titleDisplay.classList.add(\"hidden\");\n    titleInput.focus();\n\n    const length = titleInput.value.length;\n    titleInput.setSelectionRange(length, length);\n\n    titleInput.addEventListener('keydown', function handleKeydown(event) {\n        if (event.key === 'Enter') {\n            titleDisplay.textContent = titleInput.value;\n            titleInput.classList.add(\"hidden\");\n            titleDisplay.classList.remove(\"hidden\");\n            titleInput.removeEventListener('keydown', handleKeydown);\n        }\n    });\n\n    titleInput.addEventListener(\"blur\", function () {\n        const newTitle = titleInput.value;\n        li.draggable = true;\n        column.draggable = true;\n        if (subgroup) subgroup.draggable = true;\n        browser.storage.local.get(\"savedTabs\", (data) => {\n            const tabs = data.savedTabs || [];\n            const tabIndex = tabs.findIndex(t => t.id === tab.id);\n            tabs[tabIndex].title = newTitle;\n            titleDisplay.textContent = newTitle;\n            titleInput.classList.add(\"hidden\");\n            titleDisplay.classList.remove(\"hidden\");\n            li.addEventListener('dragstart', handleDragStart);\n            browser.storage.local.set({ savedTabs: tabs }, () => {\n                //console.log('Tab title saved:', tab.id, newTitle);\n            });\n        });\n    });\n}\nfunction editTabNote(tab, li) {\n    li.removeEventListener('dragstart', handleDragStart);\n    const noteDisplay = li.querySelector(`#note-display-${tab.id}`);\n    const noteInput = li.querySelector(`#note-input-${tab.id}`);\n    const column = li.closest('.column');\n\n    li.draggable = false;\n    column.draggable = false;\n    noteInput.classList.remove(\"hidden\");\n    noteDisplay.classList.add(\"hidden\");\n    noteInput.focus();\n    noteInput.style.height = \"auto\";\n    noteInput.style.height = (noteInput.scrollHeight) + \"px\";\n\n    const length = noteInput.value.length;\n    noteInput.setSelectionRange(length, length);\n}\nfunction saveTabNote(id, note) {\n    browser.storage.local.get(\"savedTabs\", (data) => {\n        const tabs = data.savedTabs || [];\n        const index = tabs.findIndex(tab => tab.id === id);\n        const { parsedDate, remainingNote } = parseAndSaveDate(note);\n        tabs[index].note = remainingNote.replace(/\\n/g, '<br>'); // Update the note for the tab\n\n        if (parsedDate) {\n            tabs[index].parsedDate = parsedDate.getTime(); // Save the timestamp of the date\n        }\n\n        browser.storage.local.set({ savedTabs: tabs }, () => {\n            //console.log('Tab note saved:', id, remainingNote);\n        });\n    });\n}\nfunction calculateFormattedDate(parsedDate) {\n    if (!parsedDate) {\n        return { formattedDate: '', dateDisplayColor: '#e63c30' };\n    }\n\n    parsedDate = new Date(parsedDate);\n    const diffDays = getToday(parsedDate);\n    let formattedDate = '';\n    let dateDisplayColor = '#ababab';\n\n    if (diffDays === 0) {\n        formattedDate = 'Today';\n        dateDisplayColor = '#058527';\n    } else if (diffDays === 1) {\n        formattedDate = 'Tomorrow';\n        dateDisplayColor = '#C76E00';\n    } else if (diffDays >= 2 && diffDays <= 7) {\n        const weekdayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n        formattedDate = weekdayNames[parsedDate.getDay()];\n    } else {\n        const month = String(parsedDate.getMonth() + 1).padStart(2, '0');\n        const day = String(parsedDate.getDate()).padStart(2, '0');\n        const year = String(parsedDate.getFullYear()).slice(-2);\n        formattedDate = `${month}/${day}/${year}`;\n    }\n\n    if (diffDays < 0) {\n        dateDisplayColor = '#e63c30';\n    }\n\n    return { formattedDate, dateDisplayColor };\n}\nfunction parseAndSaveDate(note) {\n    const chrono = new Chrono();\n    const parsedNote = note.replace(/\\\\\\w+/g, '');\n    const parsedDate = chrono.parseDate(parsedNote);\n    const detectedDateText = parsedDate ? chrono.parse(note)[0].text : '';\n    \n    // Remove the parsed date from the note\n    const remainingNote = parsedDate ? note.replace(detectedDateText, '').trim() : note;\n    return { parsedDate, remainingNote, detectedDateText };\n}\nfunction removeDate(tab, dateDisplay) {\n    tab.parsedDate = null;\n    dateDisplay.textContent = '';\n    dateDisplay.classList.add('hidden');\n    browser.storage.local.set({ savedTabs: tabs_in_storage }, () => {\n        console.log('Tab date removed:', tab.id);\n    });\n}\nfunction openColorMenu(tab, moreOptionsButton) {\n    if (activeColorMenu) {\n        activeColorMenu.remove();\n        activeColorMenu = null;\n        return;\n    }\n    const colorMenu = document.createElement('div');\n    colorMenu.classList.add('color-menu');\n\n    colorOptions.forEach(color => {\n        const colorOption = document.createElement('div');\n        colorOption.classList.add('color-option', color);\n        colorOption.addEventListener('click', () => {\n            tab.color = color;\n            browser.storage.local.set({ savedTabs: tabs_in_storage }, () => {\n                //console.log('Tab color saved:', tab.id, tab.color);\n            });\n            closeAllMenus();\n        });\n        colorMenu.appendChild(colorOption);\n    });\n\n    document.body.appendChild(colorMenu);\n    const rect = moreOptionsButton.getBoundingClientRect();\n    colorMenu.style.top = `${rect.bottom + 5}px`;\n    colorMenu.style.right = `${window.innerWidth - rect.right}px`;\n    activeColorMenu = colorMenu;\n}\n\n/* Column Menu Actions */\nfunction deleteColumn(event) {\n    closeAllMenus();\n    let column = event;\n    if(event instanceof Event){\n        column = event.target.closest(\".column\");\n    }\n    const tabItems = column.querySelectorAll('.tab-item');\n    const tabIds = Array.from(tabItems).map(tabItem => tabItem.id);\n    deleteTab(tabIds.map(id => parseInt(id.replace('tab-', ''))), column);\n}\nfunction openAllInColumn(column, subgroup = null) {\n    closeAllMenus();\n    let urls;\n    if (subgroup) {\n        const favicons = Array.from(column.querySelectorAll(`#${subgroup[0]} .subgroup-favicon`));\n        urls = favicons.map(favicon => favicon.dataset.url);\n    }\n    else{\n        const tabItems = column.querySelectorAll('.tab-item:not(.subgroup-item .tab-item)');\n        urls = Array.from(tabItems).flatMap(tabItem => {\n            if (tabItem.classList.contains('subgroup-item')) {\n                const favicons = tabItem.querySelectorAll('.subgroup-favicon');\n                return Array.from(favicons).map(favicon => favicon.dataset.url);\n            } else {\n                return tabItem.dataset.url;\n            }\n        });\n    }\n    if(userBrowser !== 'chrome'){\n        urls.forEach(url => {\n            browser.tabs.create({ url, active: false });\n        });   \n    }\n    else{\n        // Open all tabs\n        const createTabs = urls.map(url => \n            new Promise(resolve => {\n                browser.tabs.create({ url: url, active: false }, resolve);\n            })\n        );\n        // After all tabs are created, group them\n        Promise.all(createTabs).then(tabs => {\n            const tabIds = tabs.map(tab => tab.id); // Extract tab IDs\n            browser.tabs.group({ tabIds: tabIds }, groupId => {\n                // Set the title of the group\n                let title;\n                if(subgroup){\n                    title = subgroup[subgroup.length - 2];\n                }\n                else{\n                    title = column.querySelector('.column-title-text').textContent;\n                }\n                browser.tabGroups.update(groupId, { title });\n            });\n        });\n    }\n}\n\n/* Column Functions */\nfunction saveColumnState(returnState = false) {\n    const columns = columnsContainer.querySelectorAll('.column');\n    const columnState = [];\n    columns.forEach(column => {\n        const columnId = column.id;\n        const tabItems = Array.from(column.querySelectorAll('.tab-item')).filter(item => \n            item.classList.contains('tab-item') && !item.closest('.expanded-tabs')\n        );\n        const tabIds = Array.from(tabItems).map(tabItem => {\n            if (tabItem.classList.contains('subgroup-item')) {\n                const expandedContainer = tabItem.querySelector('.expanded-tabs');\n                const expandedTabList = Array.from(expandedContainer.querySelectorAll('li'));\n                const subgroup = [\n                    tabItem.id,\n                    ...expandedTabList.map(tab => tab.id),\n                    tabItem.querySelector('.subgroup-title-text').textContent,\n                    tabItem.querySelector('.expand-button').classList.contains('expanded')\n                ];\n                return subgroup.length > 3 ? subgroup : null;\n            } \n            else {\n                return tabItem.id;\n            }\n        }).filter(id => id !== null);\n        \n        columnState.push({\n            id: columnId,\n            tabIds: tabIds,\n            title: column.querySelector('.column-title-text').textContent,\n            minimized: column.classList.contains('minimized'),\n            emoji: column.dataset.emoji\n        });\n    });\n    if(returnState) {\n        return columnState;\n    }\n    else{\n        browser.storage.local.set({ columnState }, () => {\n            //console.log('Column state saved:', columnState);\n        });\n    }\n}\nfunction minimizeColumn(column) {\n    const titleSpan = column.querySelector(\".column-title-text\");\n    const titleInput = column.querySelector(\".column-title-input\");\n    const maximizeButton = column.querySelector(\".maximize-column\");\n    const minimizeButton = column.querySelector(\".minimize-column\");\n    const titleGroup = column.querySelector(\".title-group\");\n    const menuContainer = column.querySelector(\".menu-container\");\n    const menuButton = column.querySelector(\".more-options\");\n    const headerContainer = column.querySelector(\".header-container\");\n\n    column.classList.add(\"minimized\");\n    titleSpan.classList.add(\"vertical-text\");\n    titleInput.classList.add(\"vertical-text\");\n    titleGroup.classList.add(\"vertical\");\n    maximizeButton.style.display = \"inline\";\n    minimizeButton.style.display = \"none\";\n    menuContainer.classList.add(\"vertical\");\n    menuButton.classList.add(\"vertical\");\n    headerContainer.classList.add(\"vertical\");\n\n    // Hide all tab items in the column\n    const tabItems = column.querySelectorAll('.tab-item');\n    tabItems.forEach(tabItem => {\n        tabItem.style.display = \"none\";\n    });\n}\nfunction maximizeColumn(column) {\n    const titleSpan = column.querySelector(\".column-title-text\");\n    const titleInput = column.querySelector(\".column-title-input\");\n    const titleGroup = column.querySelector(\".title-group\");\n    const maximizeButton = column.querySelector(\".maximize-column\");\n    const minimizeButton = column.querySelector(\".minimize-column\");\n    const menuContainer = column.querySelector(\".menu-container\");\n    const menuButton = column.querySelector(\".more-options\");\n    const headerContainer = column.querySelector(\".header-container\");\n\n    column.classList.remove(\"minimized\");\n    titleSpan.classList.remove(\"vertical-text\");\n    titleInput.classList.remove(\"vertical-text\");\n    titleGroup.classList.remove(\"vertical\");\n    maximizeButton.style.display = \"none\";\n    minimizeButton.style.display = \"inline\";\n    menuContainer.classList.remove(\"vertical\");\n    menuButton.classList.remove(\"vertical\");\n    headerContainer.classList.remove(\"vertical\");\n\n    // Show all tab items in the column\n    const tabItems = column.querySelectorAll('.tab-item');\n    tabItems.forEach(tabItem => {\n        tabItem.style.display = \"flex\";\n    });\n}\n\n/* Tab Drag and Drop */\nfunction handleDragStart(event) {\n    event.stopPropagation();\n    closeAllMenus();\n    const tabItem = event.target.closest('.tab-item');\n    if(!tabItem) return;\n    const draggedItems = document.querySelectorAll('.selected');\n    const isDraggedItemSelected = tabItem.classList.contains('selected');\n    \n    if (isDraggedItemSelected && draggedItems.length > 1) {\n        draggedItems.forEach(item => item.classList.add('dragging'));\n    } \n    // If dragging an unselected item, only add dragging to that item\n    else {\n        draggedItems.forEach(item => item.classList.remove('selected'));\n        tabItem.classList.add('dragging');\n    }\n\n    event.dataTransfer.setData(\"text/plain\", tabItem.id);\n    event.dataTransfer.setDragImage(tabItem, 0, 0);\n    dropType = \"list-item\";\n}\nfunction calculateDropPosition(event, tabItems, isMinimized = false) {\n    if(isMinimized){\n        return tabItems.length;\n    } \n\n    // If dragging a subgroup, filter out items that are inside subgroups\n    const draggedElement = document.querySelector('.dragging');\n    if (draggedElement && draggedElement.classList.contains('subgroup-item')) {\n        tabItems = tabItems.filter(item => !item.closest('.expanded-tabs'));\n    }\n\n    let dropPosition = tabItems.length;\n    for (let i = 0; i < tabItems.length; i++) {\n        const tabRect = tabItems[i].getBoundingClientRect();\n        if (event.clientY < tabRect.top + tabRect.height / 2) {\n            dropPosition = i;\n            break;\n        }\n    }\n    return dropPosition;\n}\n\n/* Column Drag and Drop */\nfunction handleColumnDragStart(event) {\n    closeAllMenus();\n    if (event.target.closest('.tab-item')) {\n        event.preventDefault();\n        return;\n    }\n    const column = event.target.closest('.column');\n    if(!column) return;\n\n    // Remove .selected class from all items\n    const draggedItems = document.querySelectorAll('.selected');\n    draggedItems.forEach(item => item.classList.remove('selected'));\n\n    event.dataTransfer.setData(\"text/plain\", column.id);\n    event.dataTransfer.setDragImage(column, 0, 0);\n    dropType = \"column\";\n    column.classList.add(\"dragging\");\n}\nfunction calculateColumnDropPosition(event, columns) {\n    let dropPosition = columns.length;\n    for (let i = 0; i < columns.length; i++) {\n        const columnRect = columns[i].getBoundingClientRect();\n        if (event.clientX < columnRect.left + columnRect.width / 2) {\n            dropPosition = i;\n            break;\n        }\n    }\n    return dropPosition;\n}\n\n/* General Drag and Drop */\nfunction startScrollAnimation(container) {\n    function animate() {\n        if (!scrollAnimation.isScrolling) return;\n\n        if (scrollAnimation.scrollX !== 0 || scrollAnimation.scrollY !== 0) {\n            container.scrollBy(scrollAnimation.scrollX, scrollAnimation.scrollY);\n            scrollAnimation.animationFrameId = requestAnimationFrame(animate);\n        } else {\n            stopScrollAnimation();\n        }\n    }\n    scrollAnimation.animationFrameId = requestAnimationFrame(animate);\n}\nfunction stopScrollAnimation() {\n    scrollAnimation.isScrolling = false;\n    scrollAnimation.scrollX = 0;\n    scrollAnimation.scrollY = 0;\n    if (scrollAnimation.animationFrameId) {\n        cancelAnimationFrame(scrollAnimation.animationFrameId);\n        scrollAnimation.animationFrameId = null;\n    }\n}\nfunction handleDragOver(event) {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n\n    /* Auto Scroll */\n    const scrollThreshold = 240;\n    const maxScrollSpeed = 15;\n    const containerRect = columnsContainer.getBoundingClientRect();\n    function calculateScrollSpeed(distance) {\n        if (distance <= 0) return 0;\n        if (distance >= scrollThreshold) return 0;\n        \n        // Create a smooth acceleration curve\n        const scrollProgress = 1 - (distance / scrollThreshold);\n        return maxScrollSpeed * Math.pow(scrollProgress, 2);\n    }\n    const leftSpeed = calculateScrollSpeed(event.clientX - containerRect.left);\n    const rightSpeed = calculateScrollSpeed(containerRect.right - event.clientX);\n    const topSpeed = calculateScrollSpeed(event.clientY - containerRect.top);\n    const bottomSpeed = calculateScrollSpeed(containerRect.bottom - event.clientY);\n    scrollAnimation.scrollX = -leftSpeed + rightSpeed;\n    scrollAnimation.scrollY = -topSpeed + bottomSpeed;\n    if (!scrollAnimation.isScrolling && (scrollAnimation.scrollX !== 0 || scrollAnimation.scrollY !== 0)) {\n        scrollAnimation.isScrolling = true;\n        startScrollAnimation(columnsContainer);\n    } \n    else if (scrollAnimation.scrollX === 0 && scrollAnimation.scrollY === 0) {\n        stopScrollAnimation();\n    }\n\n    /* Deletion Area and New Column Indicator */\n    deletionArea.style.display = 'flex';\n    if (deletionArea.contains(event.target)) {\n        deletionArea.classList.add('deletion-area-active');\n        dropIndicator.style.display = 'none';\n        return;\n    } \n    else if (newColumnIndicator.contains(event.target)) {\n        newColumnIndicator.classList.add('new-column-indicator-active');\n        dropIndicator.style.display = 'none';\n        return;\n    }\n    \n    const column = event.target.closest('.column');\n    const openTabsList = event.target.closest('#open-tabs-list');\n    const spaceContainer = document.getElementById('space-container');\n    const spaceContainerRect = spaceContainer.getBoundingClientRect();\n    const spaceContainerLeft = spaceContainerRect.left;\n    const spaceContainerRight = spaceContainerRect.right;\n    const containerScrollTop = openTabsList ? sidebar.scrollTop : columnsContainer.scrollTop;\n\n    if (!dropIndicator) {\n        dropIndicator = document.createElement('div');\n        dropIndicator.className = 'drop-indicator';\n        const dropIndicatorContainer = document.createElement('div');\n        dropIndicatorContainer.className = 'drop-indicator-container';\n        dropIndicatorContainer.appendChild(dropIndicator);\n        document.body.appendChild(dropIndicatorContainer);\n    }\n\n    /* List Item Drag Over */\n    if (dropType === \"list-item\") {\n        newColumnIndicator.style.display = 'flex';\n        const sidebar = document.getElementById('sidebar');\n        const sidebarRect = sidebar.getBoundingClientRect();\n        const element = openTabsList || column;\n        if(!element){\n            return;\n        }\n        const rect = element.getBoundingClientRect();\n        // Only get top-level tab items (excluding items inside subgroups)\n        const listItems = Array.from(element.children).filter(item => \n            item.classList.contains('tab-item') && !item.closest('.expanded-tabs')\n        );\n        const isMinimized = column && column.classList.contains('minimized');\n        const dropPosition = calculateDropPosition(event, listItems, isMinimized);\n\n        let indicatorLeft = rect.left;\n        let width = rect.width;\n        if(openTabsList){\n            indicatorLeft = sidebarRect.left;\n            width = sidebarRect.width;\n        }\n        else{\n            // Left boundary\n            if (indicatorLeft < spaceContainerLeft) {\n                const difference = spaceContainerLeft - indicatorLeft;\n                indicatorLeft = spaceContainerLeft;\n                width = width - difference;\n            }\n            // Right boundary \n            if (indicatorLeft + width > spaceContainerRight) {\n                width = spaceContainerRight - indicatorLeft;\n            }\n        }\n        dropIndicator.style.width = `${width}px`;\n        dropIndicator.style.height = '2px';\n        dropIndicator.style.left = `${indicatorLeft}px`;\n\n        const rectTopScroll = rect.top + containerScrollTop;\n        const containerRect = openTabsList ? sidebarRect : spaceContainerRect;\n        let indicatorTop;\n        if (dropPosition === listItems.length) {\n            const lastItem = listItems[listItems.length - 1];\n            indicatorTop = isMinimized || !lastItem \n                ? rectTopScroll \n                : lastItem.getBoundingClientRect().bottom + containerScrollTop;\n        } else {\n            indicatorTop = listItems[dropPosition].getBoundingClientRect().top + containerScrollTop;\n        }\n        indicatorTop = Math.max(indicatorTop, containerRect.top);\n        indicatorTop = Math.min(indicatorTop, containerRect.bottom - 2);\n        dropIndicator.style.top = `${indicatorTop}px`;\n\n        const draggedTabs = Array.from(document.querySelectorAll('.dragging'));\n\n        // Check if dragging directly over a tab or group\n        const targetTab = listItems.find(item => {\n            if (item.closest('#open-tabs-list') || item.classList.contains('dragging') || item.closest('.expanded-tabs')) {\n                return false;\n            }\n            // Check if the tab is already in the target subgroup\n            const targetSubgroup = item.closest('.subgroup-item');\n            if (targetSubgroup && draggedTabs.some(tab => targetSubgroup.contains(tab))) {\n                return false;\n            }\n            const itemRect = item.getBoundingClientRect();\n            const itemHeight = itemRect.bottom - itemRect.top;\n\n            // Calculate middle third region\n            const middleThirdTop = itemRect.top + itemHeight / 3;\n            const middleThirdBottom = itemRect.bottom - itemHeight / 3;\n\n            // Calculate fixed 32px exclusion region\n            const fixedMargin = 32;\n            const fixedTop = itemRect.top + fixedMargin;\n            const fixedBottom = itemRect.bottom - fixedMargin;\n\n            // Use larger region\n            return fixedBottom - fixedTop > middleThirdBottom - middleThirdTop\n            ? event.clientY >= fixedTop && event.clientY <= fixedBottom\n            : event.clientY >= middleThirdTop && event.clientY <= middleThirdBottom;\n        });\n\n        document.querySelectorAll('.tab-item').forEach(item => {\n            item.classList.remove('targeted');\n        });\n        if (targetTab) {\n            targetTab.classList.add('targeted');\n            dropIndicator.style.display = 'none';\n        } else {\n            dropIndicator.style.display = 'block';\n        }\n        \n        let draggedTabsFromSubgroup = null;\n        if (draggedTabs.length > 0) {\n            const firstSubgroup = draggedTabs[0].closest('.subgroup-item');\n            const allFromSameSubgroup = draggedTabs.every(tab => tab.closest('.subgroup-item') === firstSubgroup);\n\n            if (allFromSameSubgroup && !draggedTabs[0].classList.contains('subgroup-item')) {\n                draggedTabsFromSubgroup = firstSubgroup;\n            }\n        }\n        const targetInSubgroup = event.target.closest('.subgroup-item');\n\n        // Rearrange tabs within the same subgroup\n        if (draggedTabsFromSubgroup && targetInSubgroup && targetInSubgroup === draggedTabsFromSubgroup) {\n            const subgroupItems = Array.from(draggedTabsFromSubgroup.querySelectorAll('.tab-item')).filter(item => item.closest('.expanded-tabs'));\n            const subgroupDropPosition = calculateDropPosition(event, subgroupItems, isMinimized);\n\n            let subgroupRect = draggedTabsFromSubgroup.getBoundingClientRect();\n            let subgroupIndicatorLeft = subgroupRect.left;\n            let subgroupWidth = subgroupRect.width;\n\n            dropIndicator.style.width = `${subgroupWidth}px`;\n            dropIndicator.style.height = '2px';\n            dropIndicator.style.left = `${subgroupIndicatorLeft}px`;\n\n            let subgroupIndicatorTop;\n            if (subgroupDropPosition === subgroupItems.length) {\n                const lastSubItem = subgroupItems[subgroupDropPosition - 1];\n                subgroupIndicatorTop = lastSubItem \n                    ? lastSubItem.getBoundingClientRect().bottom + containerScrollTop\n                    : subgroupRect.top + containerScrollTop;\n            } else {\n                subgroupIndicatorTop = subgroupItems[subgroupDropPosition].getBoundingClientRect().top + containerScrollTop;\n            }\n\n            dropIndicator.style.top = `${subgroupIndicatorTop}px`;\n        }\n    }\n    /* Column Drag Over */\n    else if (dropType === \"column\") {\n        newColumnIndicator.style.display = 'none';\n        dropIndicator.style.display = 'block';\n\n        const columns = Array.from(columnsContainer.querySelectorAll('.column'));\n        const dropPosition = calculateColumnDropPosition(event, columns);\n\n        let indicatorLeft;\n        const width = 2;\n        let height = containerRect.height;\n\n        // Left boundary\n        if (indicatorLeft < spaceContainerLeft) {\n            indicatorLeft = spaceContainerLeft;\n        }\n        // Right boundary\n        if (indicatorLeft > spaceContainerRight - width) {\n            indicatorLeft = spaceContainerRight - width;\n        }\n\n        if (dropPosition === columns.length) {\n            const lastColumn = columns[columns.length - 1];\n            indicatorLeft = lastColumn ? lastColumn.getBoundingClientRect().right : containerRect.left;\n        } else {\n            const targetColumn = columns[dropPosition];\n            indicatorLeft = targetColumn.getBoundingClientRect().left;\n        }\n\n        dropIndicator.style.width = `${width}px`;\n        dropIndicator.style.height = `${height}px`;\n        dropIndicator.style.left = `${indicatorLeft}px`;\n        dropIndicator.style.top = `${containerRect.top + containerScrollTop}px`;\n    }\n}\nfunction handleDrop(event) {\n    event.preventDefault();\n    const eventDropData = event.dataTransfer.getData(\"text/plain\");\n\n    /* Column Drop */\n    const droppedColumn = document.getElementById(eventDropData);\n    if (droppedColumn && droppedColumn.classList.contains('column')) {\n        if(deletionArea.contains(event.target)) {\n            deleteColumn(droppedColumn);\n            return;\n        }\n\n        const columns = Array.from(columnsContainer.querySelectorAll('.column'));\n        const dropPosition = calculateColumnDropPosition(event, columns);\n\n        if (dropPosition === columns.length) {\n            columnsContainer.appendChild(droppedColumn);\n        }\n        else {\n            columnsContainer.insertBefore(droppedColumn, columns[dropPosition]);\n        }\n\n        // Ensure newColumnIndicator is the last element\n        columnsContainer.appendChild(newColumnIndicator);\n\n        saveColumnState();\n        return;\n    }\n\n    /* List Item Drop */\n    const column = event.target.closest('.column') || event.target.closest('#open-tabs-list');\n    const columnState = saveColumnState(true);\n    const isMinimized = column && column.classList.contains('minimized');\n    if (!column && !deletionArea.contains(event.target) && !newColumnIndicator.contains(event.target)) {\n        return;\n    }\n    const tabId = eventDropData;\n    const tabItem = document.querySelector(`li#${tabId}`);\n    if (!tabItem || !tabItem.classList.contains('tab-item')){\n        return;\n    }\n\n    const draggedTabs = Array.from(document.querySelectorAll('.dragging'));\n    const itemsToProcess = draggedTabs.length > 1 ? draggedTabs : [tabItem];\n    const draggedTabIds = Array.from(itemsToProcess).map(item => item.id);\n\n    const tabIdsToDelete = [];\n    const itemIdsToSave = [];\n    const itemsToInsert = [];\n\n    if(deletionArea.contains(event.target)) {\n        let deletedSubgroup = false;\n        itemsToProcess.forEach(item => {\n            const itemId = item.id;\n            if (itemId.startsWith('tab-')) {\n                tabIdsToDelete.push(parseInt(itemId.replace('tab-', '')));\n                item.remove();\n            }\n            else if (itemId.startsWith('opentab')) {\n                browser.tabs.remove(parseInt(itemId.replace('opentab-', '')), () => {\n                    //console.log('Tab closed:', itemId);\n                });\n                item.remove();\n            }\n            else if (itemId.startsWith('group')) {\n                deleteSubgroup(itemId);\n                deletedSubgroup = true;\n            }\n        });\n        if(!deletedSubgroup){\n            deleteTab(tabIdsToDelete);\n        }\n        return;\n    }\n    else if(newColumnIndicator.contains(event.target)) {\n        const newColumn = createColumn();\n        itemsToProcess.forEach(item => {\n            if(item.id.startsWith('opentab-')) {\n                itemIdsToSave.push(item.id.replace('opentab-', ''));\n            }\n            newColumn.appendChild(item);\n        });\n        if(itemIdsToSave.length > 0) {\n            saveTab(itemIdsToSave);\n        }\n        else{\n            saveColumnState();\n        }\n        return;\n    }\n\n    const columnIndex = columnState.findIndex(col => col.id === column.id);\n    const tabItems = Array.from(column.querySelectorAll('.tab-item')).filter(item => !item.closest('.expanded-tabs'));\n    const dropPosition = calculateDropPosition(event, tabItems, isMinimized);\n\n    const firstSubgroup = itemsToProcess[0].closest('.subgroup-item');\n    const allFromSameSubgroup = itemsToProcess.every(item => item.closest('.subgroup-item') === firstSubgroup);\n    const draggedTabsFromSubgroup = allFromSameSubgroup ? firstSubgroup : null;\n    const targetIsSubgroup = event.target.closest('.subgroup-item');\n\n    // Rearranging tabs within a subgroup\n    if (targetIsSubgroup && draggedTabsFromSubgroup && targetIsSubgroup === draggedTabsFromSubgroup) {\n        const tabIds = columnState[columnIndex].tabIds;\n        const subgroupId = targetIsSubgroup.id;\n        const subgroupIndex = tabIds.findIndex(id => Array.isArray(id) && id[0] === subgroupId);\n        const subgroupItems = Array.from(targetIsSubgroup.querySelectorAll('.tab-item')).filter(item => item.closest('.expanded-tabs'));\n        let targetIndex = calculateDropPosition(event, subgroupItems, isMinimized) + 1;\n        if (subgroupIndex !== -1) {\n            let subgroup = tabIds[subgroupIndex];\n\n            // Adjust targetIndex based on the position of dragged tabs\n            draggedTabIds.forEach(draggedTabId => {\n                const tabIndex = subgroup.indexOf(draggedTabId);\n                if (tabIndex !== -1 && tabIndex < targetIndex) {\n                    targetIndex--;\n                }\n            });\n\n            subgroup = subgroup.filter(tabId => !draggedTabIds.includes(tabId));\n            subgroup.splice(targetIndex, 0, ...draggedTabIds);\n            columnState[columnIndex].tabIds[subgroupIndex] = subgroup;\n\n            browser.storage.local.set({ columnState }, () => {\n                //console.log('Rearranged tabs within subgroup:', columnState);\n            });\n        }\n        return;\n    }\n\n    // Dropped directly on top of another tab or group\n    const targetTab = tabItems.find(item => {\n        if (item.closest('#open-tabs-list') || item.classList.contains('dragging') || item.closest('.expanded-tabs')) {\n            return false;\n        }\n        // Check if the tab is already in the target subgroup\n        const targetSubgroup = item.closest('.subgroup-item');\n        if (targetSubgroup && draggedTabs.some(tab => targetSubgroup.contains(tab))) {\n            return false;\n        }\n        const itemRect = item.getBoundingClientRect();\n        const itemHeight = itemRect.bottom - itemRect.top;\n\n        // Calculate middle third region\n        const middleThirdTop = itemRect.top + itemHeight / 3;\n        const middleThirdBottom = itemRect.bottom - itemHeight / 3;\n\n        // Calculate fixed 32px exclusion region\n        const fixedMargin = 32;\n        const fixedTop = itemRect.top + fixedMargin;\n        const fixedBottom = itemRect.bottom - fixedMargin;\n\n        // Use larger region\n        return fixedBottom - fixedTop > middleThirdBottom - middleThirdTop\n        ? event.clientY >= fixedTop && event.clientY <= fixedBottom\n        : event.clientY >= middleThirdTop && event.clientY <= middleThirdBottom;\n    });\n\n    if (targetTab) {\n        const targetTabId = targetTab.id;\n        let _draggedTabIds = draggedTabIds.slice().map(id => id.replace('opentab-', 'tab-'));\n        const generateGroupId = () => `group-${Date.now()}`;\n        const removeTabsFromSource = (draggedTabIds) => {\n            draggedTabIds.forEach(draggedTabId => {\n                for (let colIndex = 0; colIndex < columnState.length; colIndex++) {\n                    const sourceTabIds = columnState[colIndex].tabIds;\n    \n                    // Check for tab as individual item\n                    const sourceIndex = sourceTabIds.findIndex(id => id === draggedTabId);\n                    if (sourceIndex !== -1) {\n                        sourceTabIds.splice(sourceIndex, 1);\n                        break;\n                    }\n    \n                    // Check for tab within subgroups\n                    const sourceSubgroupIndex = sourceTabIds.findIndex(id => \n                        Array.isArray(id) && id.includes(draggedTabId)\n                    );\n                    if (sourceSubgroupIndex !== -1) {\n                        const sourceSubgroup = sourceTabIds[sourceSubgroupIndex];\n                        const tabIndexInSubgroup = sourceSubgroup.indexOf(draggedTabId);\n                        if (tabIndexInSubgroup !== -1) {\n                            sourceSubgroup.splice(tabIndexInSubgroup, 1);\n                            // Remove empty subgroup\n                            if (sourceSubgroup.length <= 3) {\n                                sourceTabIds.splice(sourceSubgroupIndex, 1);\n                            }\n                            break;\n                        }\n                    }\n                }\n            });\n        };\n    \n        if (columnIndex !== -1) {\n            const tabIds = columnState[columnIndex].tabIds;\n            let targetTabIdIndex = tabIds.findIndex(id => id === targetTabId || (Array.isArray(id) && id[0] === targetTabId));\n    \n            if (targetTabIdIndex !== -1) {\n                let sourceSubgroup = null;\n                let sourceColumnIndex = -1;\n                let tabsToAdd = [];\n                for (let i = 0; i < columnState.length; i++) {\n                    const col = columnState[i];\n                    const subgroup = col.tabIds.find(id => Array.isArray(id) && id[0] === _draggedTabIds[0]);\n                    if (subgroup) {\n                        sourceSubgroup = subgroup;\n                        tabsToAdd = sourceSubgroup.slice(1, -2);\n                        sourceColumnIndex = i;\n                        break;\n                    }\n                }\n    \n                const draggedIsSubgroup = tabItem.classList.contains('subgroup-item');\n                // Source is existing subgroup and target is regular tab\n                if (draggedIsSubgroup && !Array.isArray(tabIds[targetTabIdIndex])) {\n                    const title = sourceSubgroup[sourceSubgroup.length - 2];\n                    const expanded = sourceSubgroup[sourceSubgroup.length - 1];\n                    tabIds[targetTabIdIndex] = [generateGroupId(), tabIds[targetTabIdIndex], ...tabsToAdd, title, expanded];\n    \n                    // Remove the source subgroup from its original column\n                    if (sourceColumnIndex !== -1) {\n                        const sourceTabIds = columnState[sourceColumnIndex].tabIds;\n                        const sourceIndex = sourceTabIds.findIndex(id => Array.isArray(id) && id[0] === _draggedTabIds[0]);\n                        if (sourceIndex !== -1) {\n                            sourceTabIds.splice(sourceIndex, 1);\n                        }\n                    }\n                } \n                // Merging two subgroups\n                else if (draggedIsSubgroup && Array.isArray(tabIds[targetTabIdIndex])) {\n                    tabIds[targetTabIdIndex].splice(tabIds[targetTabIdIndex].length - 2, 0, ...tabsToAdd);\n    \n                    // Remove the source subgroup from its original column\n                    if (sourceColumnIndex !== -1) {\n                        const sourceTabIds = columnState[sourceColumnIndex].tabIds;\n                        const sourceIndex = sourceTabIds.findIndex(id => Array.isArray(id) && id[0] === _draggedTabIds[0]);\n                        if (sourceIndex !== -1) {\n                            sourceTabIds.splice(sourceIndex, 1);\n                        }\n                    }\n                }\n                // Source is regular tab and target is an existing subgroup\n                else if (Array.isArray(tabIds[targetTabIdIndex])) {\n                    removeTabsFromSource(_draggedTabIds);\n                    targetTabIdIndex = tabIds.findIndex(id => id === targetTabId || (Array.isArray(id) && id[0] === targetTabId));\n                    tabIds[targetTabIdIndex].splice(tabIds[targetTabIdIndex].length - 2, 0, ..._draggedTabIds);\n                }\n                // Creating new subgroup from regular tabs\n                else {\n                    removeTabsFromSource(_draggedTabIds);\n                    targetTabIdIndex = tabIds.findIndex(id => id === targetTabId || (Array.isArray(id) && id[0] === targetTabId));\n                    tabIds[targetTabIdIndex] = [generateGroupId(), tabIds[targetTabIdIndex], ..._draggedTabIds, \"New Group\", true];\n                }\n            }\n            columnState[columnIndex].tabIds = tabIds;\n    \n            const isOpenTabsList = draggedTabIds.some(id => id.startsWith('opentab-'));\n            if (isOpenTabsList) {\n                let updatedTabs = [];\n                draggedTabIds.filter(draggedTabId => draggedTabId.startsWith('opentab-')).forEach(draggedTabId => {\n                    const originalDraggedTabId = draggedTabId;\n                    draggedTabId = draggedTabId.replace('opentab-', 'tab-');\n                    const numericId = parseInt(draggedTabId.replace('tab-', ''));\n                    browser.tabs.get(numericId, (tab) => {\n                        if (originalDraggedTabId.startsWith('opentab-')) {\n                            const newTab = {\n                                title: tab.title,\n                                url: tab.url,\n                                favIconUrl: tab.favIconUrl || getFaviconUrl(tab.url),\n                                id: numericId,\n                                color: '#FFFFFF'\n                            };\n                            updatedTabs.push(newTab);\n                        }\n                    });\n                });\n                browser.storage.local.get('savedTabs', (data) => {\n                    let existingTabs = data.savedTabs || [];\n                    updatedTabs = existingTabs.concat(updatedTabs);\n    \n                    browser.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n                        let activeTab = tabs[0];\n                        _draggedTabIds.forEach(draggedTabId => {\n                            const numericId = parseInt(draggedTabId.replace('tab-', ''));\n                            browser.tabs.remove(numericId, () => {\n                                browser.tabs.update(activeTab.id, { active: true });\n                            });\n                        });\n    \n                        browser.storage.local.set({ columnState: columnState, savedTabs: updatedTabs }, () => {\n                            //console.log('Updated storage with new tab:', updatedTabs);\n                        });\n                    });\n                });\n            }\n            else {\n                browser.storage.local.set({ columnState }, () => {\n                    //console.log('Updated column state with subgroup:', columnState);\n                });\n            }\n    \n        }\n        return;\n    }\n\n    let earlyExit = false;\n    const sidebar = document.getElementById('sidebar');\n    const isCollapsed = sidebar.classList.contains('collapsed');\n    itemsToProcess.forEach(item => {\n        const columnId = column.id;\n        let itemId = item.id;\n \n        if (columnId !== 'open-tabs-list' && itemId.startsWith('opentab')) {\n            itemId = itemId.replace('opentab-', 'tab-');\n            item.id = itemId;\n            itemIdsToSave.push(itemId);\n        }\n        else if (columnId === 'open-tabs-list' && itemId.startsWith('tab')) {\n            console.log(\"HI\");\n            browser.tabs.create({ url: item.dataset.url, active: false });\n            tabIdsToDelete.push(parseInt(itemId.replace('tab-', '')));\n            if(isCollapsed){\n                item.classList.add('collapsed');\n            }\n        }\n        else if (columnId === 'open-tabs-list' && itemId.startsWith('group')) {\n            const column = columnState.find(col => \n                col.tabIds.some(id => Array.isArray(id) && id[0] === itemId)\n            );\n        \n            if (column) {\n                const columnElement = document.getElementById(column.id);\n                const subgroup = column.tabIds.find(id => Array.isArray(id) && id[0] === itemId);\n        \n                if (subgroup) {\n                    openAllInColumn(columnElement, subgroup);\n                    deleteSubgroup(itemId);\n                    earlyExit = true;\n                    return;\n                }\n            }\n        }\n\n        itemsToInsert.push({ item, dropPosition });\n\n        //Rearranging tabs in open-tabs-list\n        if (columnId === 'open-tabs-list' && itemId.startsWith('opentab')) {\n            browser.tabs.move(parseInt(itemId.split('-')[1]), { index: dropPosition }, () => {\n                //console.log('Tab moved:', itemId, 'to index:', dropPosition);\n            });\n        }\n    });\n    if(earlyExit) return;\n\n    itemsToInsert.forEach(({ item, dropPosition }) => {\n        if (dropPosition === tabItems.length) {\n            column.appendChild(item);\n        } else {\n            column.insertBefore(item, tabItems[dropPosition]);\n        }\n    });\n    if (itemIdsToSave.length > 0) {\n        saveTab(itemIdsToSave);\n    }\n    if (tabIdsToDelete.length > 0) {\n        deleteTab(tabIdsToDelete);\n    }\n    if (itemIdsToSave.length === 0 && tabIdsToDelete.length === 0) {\n        saveColumnState();\n    }\n\n    if(isMinimized){\n        const updatedTabs = column.querySelectorAll('.tab-item');\n        updatedTabs.forEach(tabItem => {\n            tabItem.style.display = \"none\";\n        });\n    }\n}\nfunction handleDragEnd(event) {\n    stopScrollAnimation();\n    document.querySelectorAll('.tab-item.dragging').forEach(item => {\n        item.classList.remove(\"dragging\");\n    });\n    event.target.closest('.column')?.classList.remove(\"dragging\");\n    if (deletionArea){\n        deletionArea.style.display = 'none';\n        deletionArea.classList.remove('deletion-area-active');\n    } \n    if (newColumnIndicator){\n        newColumnIndicator.style.display = 'none';\n        newColumnIndicator.classList.remove('new-column-indicator-active');\n    } \n    if (dropIndicator) dropIndicator.style.display = 'none';\n    document.querySelectorAll('.tab-item').forEach(item => {\n        item.style.outline = 'none';\n    });\n}\n\n/* Display Helper Functions */\nfunction getFaviconUrl(tabUrl) {\n    try {\n        const url = new URL(tabUrl);\n        return `https://www.google.com/s2/favicons?domain=${url.hostname}&sz=32`;\n    } catch (error) {\n        console.error(\"Invalid favicon URL:\", tabUrl, error);\n        return '';\n    }\n}\nfunction toggleSubgroupExpandedState(expandButton) {\n    const isExpanded = expandButton.classList.toggle('expanded');\n    const faviconsContainer = expandButton.closest('.tab-group-container').querySelector('.favicons-container');\n    const expandedContainer = expandButton.closest('.tab-group-container').querySelector('.expanded-tabs');\n\n    // Update button appearance\n    expandButton.innerHTML = isExpanded \n            ? `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-chevron-up\"><path d=\"m18 15-6-6-6 6\"/></svg>`\n            : `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-chevron-down\"><path d=\"m6 9 6 6 6-6\"/></svg>`;\n\n    if (isExpanded) {\n        faviconsContainer.style.display = 'none';\n        expandedContainer.style.display = 'flex';\n    } else {\n        faviconsContainer.style.display = 'flex';\n        expandedContainer.style.display = 'none';\n    }\n    return isExpanded;\n}\nfunction createDraggableListItem(options = {}) {\n    const {\n        id,\n        isSubgroup = false,\n        classes = []\n    } = options;\n\n    const li = document.createElement(\"li\");\n    li.classList.add(\"tab-item\", ...classes);\n    if (isSubgroup) {\n        li.classList.add(\"subgroup-item\");\n    }\n    li.draggable = true;\n    li.id = id;\n    li.addEventListener(\"dragstart\", handleDragStart);\n    li.addEventListener(\"dragend\", handleDragEnd);\n\n    return li;\n}\nfunction getColorClass(color) {\n    switch (color) {\n        case '#FFFFFF':\n            return 'tab-default';\n        case '#ffc4c4':\n        case '#f7c2d6':\n            return 'tab-pink';\n        case '#fffdc4':\n        case '#f9ffc4':\n            return 'tab-yellow';\n        case '#b0e5ff':\n        case '#c6e2e9':\n            return 'tab-blue';\n        case '#ebc4ff':\n        case '#e9c8fa':\n            return 'tab-purple';\n        default:\n            return 'tab-default';\n    }\n}\nfunction createTabItem(tab){\n    const li = createDraggableListItem({\n        id: `tab-${tab.id}`\n    });\n    li.dataset.url = tab.url;\n\n    let colorClass = tab.color;\n    if (!colorOptions.includes(colorClass)) {\n        colorClass = getColorClass(tab.color);\n    }\n    li.classList.add(colorClass);\n\n    // Calculate the formatted date when displaying\n    const { formattedDate, dateDisplayColor } = calculateFormattedDate(tab.parsedDate);\n    li.innerHTML += `\n        <div class=\"tab-info-container\">\n            <div class=\"tab-info-left\">\n                <img src=\"${tab.favIconUrl}\" draggable=\"false\">\n            </div>\n            <div class=\"tab-info-right\">\n                <span class=\"tab-title\" data-url=\"${tab.url}\" id=\"title-display-${tab.id}\">${tab.title}</span>\n                <input type=\"text\" class=\"hidden\" id=\"title-input-${tab.id}\" value=\"${tab.title}\">\n                <div class=\"note-display fixed-width\" id=\"note-display-${tab.id}\">${tab.note ? tab.note.replace(/\\\\/g, '').replace(/\\n/g, '<br>') : ''}</div>\n                <textarea class=\"tab-note hidden\" id=\"note-input-${tab.id}\">${tab.note ? tab.note.replace(/<br>/g, '\\n') : ''}</textarea>\n                <div class=\"date-display ${formattedDate ? '' : 'hidden'}\" id=\"date-display-${tab.id}\">${formattedDate || ''}</div>\n            </div>\n            <div class=\"tab-actions\">\n                <button class=\"more-options\" data-index=\"${tab.id}\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" class=\"main-grid-item-icon\" fill=\"currentColor\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\">\n                      <circle cx=\"12\" cy=\"12\" r=\"1\" />\n                      <circle cx=\"12\" cy=\"5\" r=\"1\" />\n                      <circle cx=\"12\" cy=\"19\" r=\"1\" />\n                    </svg>                \n                </button>\n            </div>\n        </div>\n    `;\n\n    const dateDisplay = li.querySelector(`#date-display-${tab.id}`);\n    dateDisplay.style.backgroundColor = dateDisplayColor;\n\n    const favicon = li.querySelector(\".tab-info-left\");\n    favicon.addEventListener(\"click\", (event) => handleFaviconClick(li, event));\n\n    const tabLink = li.querySelector('.tab-title');\n    tabLink.addEventListener('click', () => {\n        window.location.href = tabLink.dataset.url;\n    });\n    \n    const moreOptionsButton = li.querySelector('.more-options');\n    moreOptionsButton.addEventListener('click', (event) => {\n        event.stopPropagation();\n\n        const selectedItems = document.querySelectorAll('.selected');\n        selectedItems.forEach(item => {\n            item.classList.remove('selected');\n        });\n    \n        if (activeOptionsMenu && activeOptionsMenu.dataset.tabId === tab.id.toString()) {\n            closeAllMenus();\n            return;\n        }\n        closeAllMenus();\n    \n        const noteButtonText = tab.note && tab.note.trim() !== '' ? 'Edit Note' : 'Add Note';\n        const menuItems = [\n            { text: \"Rename\", action: () => { renameTab(tab, li); closeAllMenus() } },            \n            { text: noteButtonText, action: () => { editTabNote(tab, li); closeAllMenus() } },\n            { text: \"Clear Date\", action: () => { removeDate(tab, dateDisplay); closeAllMenus() }, hidden: !formattedDate },\n            { text: \"Color\", action: () => openColorMenu(tab, moreOptionsButton) },\n            { text: \"Delete\", action: () => deleteTab(tab.id, null, li) }\n        ];\n    \n        activeOptionsMenu = createMenuDropdown(menuItems, moreOptionsButton);\n        activeOptionsMenu.dataset.tabId = tab.id.toString();\n    });\n    \n    const noteDisplay = li.querySelector(`#note-display-${tab.id}`);\n    const noteInput = li.querySelector(`#note-input-${tab.id}`);\n    \n    noteDisplay.addEventListener(\"click\", function () {\n        editTabNote(tab, li);\n    });\n    \n    noteInput.addEventListener(\"blur\", function () {\n        const note = noteInput.value;\n        saveTabNote(tab.id, note);\n        noteDisplay.innerHTML = note ? note.replace(/\\\\/g, '').replace(/\\n/g, '<br>') : '';\n        noteInput.classList.add(\"hidden\");\n        noteDisplay.classList.remove(\"hidden\");\n        li.addEventListener('dragstart', handleDragStart);\n    });\n\n    noteInput.addEventListener(\"keydown\", function (event) {\n        if (event.key === \"Enter\" && !event.shiftKey) {\n            noteInput.blur();\n        }\n        else if (event.key === \"Enter\" && event.shiftKey) {\n            const start = noteInput.selectionStart;\n            const end = noteInput.selectionEnd;\n            noteInput.value = noteInput.value.substring(0, start) + \"\\n\" + noteInput.value.substring(end);\n            noteInput.selectionStart = noteInput.selectionEnd = start + 1;\n            event.preventDefault();\n        }\n    });\n\n    noteInput.addEventListener(\"input\", function () {\n        noteInput.style.height = \"auto\";\n        noteInput.style.height = (noteInput.scrollHeight) + \"px\";\n\n        const note = noteInput.value;\n        // Update the date display in real-time\n        const dateDisplay = li.querySelector(`#date-display-${tab.id}`);\n        const chrono = new Chrono();\n        const parsedNote = note.replace(/\\\\\\w+/g, '');\n        const parsedDate = chrono.parseDate(parsedNote);\n        if (parsedDate) {\n            const { formattedDate, dateDisplayColor } = calculateFormattedDate(parsedDate);\n            dateDisplay.textContent = formattedDate;\n            dateDisplay.classList.remove('hidden');\n            dateDisplay.style.backgroundColor = dateDisplayColor;\n        } \n        else if(formattedDate) {\n            dateDisplay.textContent = formattedDate;\n            dateDisplay.classList.remove('hidden');\n            dateDisplay.style.backgroundColor = dateDisplayColor;\n        }\n        else {\n            dateDisplay.classList.add('hidden');\n        }\n    });\n\n    return li;\n}\nfunction createColumn(title, id, minimized = false, emoji = null) {\n    const columnsContainer = document.getElementById(\"columns-container\");\n    const column = document.createElement(\"div\");\n    column.classList.add(\"column\");\n    if (minimized) column.classList.add(\"minimized\");\n    if (id) {\n        column.id = id;\n    } else {\n        column.id = `column-${Date.now()}`;\n    }\n\n    column.draggable = true;\n    column.addEventListener('dragstart', handleColumnDragStart);\n    column.addEventListener('dragend', handleDragEnd);\n\n    // Create a container for the title and buttons\n    const headerContainer = document.createElement(\"div\");\n    headerContainer.classList.add(\"header-container\");\n\n    // Add minimize button to the column\n    const minimizeButton = document.createElement(\"button\");\n    minimizeButton.classList.add(\"minimize-column\");\n    minimizeButton.title = \"Minimize Column\";\n    minimizeButton.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-arrow-left-to-line\"> <path d=\"M3 19V5\"/><path d=\"m13 6-6 6 6 6\"/><path d=\"M7 12h14\"/></svg>`;    \n    minimizeButton.addEventListener(\"click\", () => {\n        minimizeColumn(column);\n        browser.storage.local.set({ columnState: saveColumnState(true), animation: {columnId: column.id, minimized: true} }, () => {\n            //console.log(`${column.id} minimized`);\n        });\n    });\n\n    // Add maximize button to the column\n    const maximizeButton = document.createElement(\"button\");\n    maximizeButton.classList.add(\"maximize-column\");\n    maximizeButton.title = \"Maximize Column\";\n    maximizeButton.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-maximize-2\"><polyline points=\"15 3 21 3 21 9\"/><polyline points=\"9 21 3 21 3 15\"/><line x1=\"21\" x2=\"14\" y1=\"3\" y2=\"10\"/><line x1=\"3\" x2=\"10\" y1=\"21\" y2=\"14\"/></svg>`;\n    maximizeButton.addEventListener(\"click\", () => {\n        maximizeColumn(column);\n        browser.storage.local.set({ columnState: saveColumnState(true), animation: {columnId: column.id, minimized: false} }, () => {\n            //console.log(`${column.id} maximized`);\n        });\n    });\n\n    // Add title input to the column\n    const { titleGroup } = createEditableTitle({\n        initialText: title,\n        groupClass: 'title-group',\n        inputClass: 'column-title-input',\n        spanClass: 'column-title-text',\n        container: 'h2',\n        defaultText: 'New Column',\n        onSave: (value) => {\n            column.dataset.title = value;\n            saveColumnState();\n        }\n    });\n\n    // Create three-dot menu container\n    const menuContainer = document.createElement(\"div\");\n    menuContainer.classList.add(\"menu-container\");\n    \n    // Create three-dot menu button\n    const menuButton = document.createElement(\"button\");\n    menuButton.classList.add(\"more-options\");\n    menuButton.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" class=\"main-grid-item-icon\" fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"><circle cx=\"12\" cy=\"12\" r=\"1\" /><circle cx=\"12\" cy=\"5\" r=\"1\" /><circle cx=\"12\" cy=\"19\" r=\"1\" /></svg>`;\n    menuContainer.appendChild(menuButton);\n    menuButton.addEventListener(\"click\", (e) => {\n        e.stopPropagation();\n\n        const selectedItems = document.querySelectorAll('.selected');\n        selectedItems.forEach(item => {\n            item.classList.remove('selected');\n        });\n\n        if(activeColumnMenu && activeColumnMenu.dataset.columnId === column.id){\n            closeAllMenus();\n            return;\n        }\n        closeAllMenus();\n\n        const menuItems = [\n            { text: \"Open All\", action: () => openAllInColumn(column) },\n            { text: \"Delete Column\", action: () => deleteColumn(column) }\n        ];\n        \n        activeColumnMenu = createMenuDropdown(menuItems, menuButton);\n        activeColumnMenu.dataset.columnId = column.id;\n    });\n\n    // Create emoji button and span\n    const emojiButton = document.createElement(\"button\");\n    emojiButton.classList.add(\"emoji-button\");\n    emojiButton.textContent = emoji || getRandomEmoji();\n    column.dataset.emoji = emojiButton.textContent;\n\n    // Create and configure the emoji picker element\n    const emojiPicker = document.createElement('emoji-picker');\n    emojiPicker.classList.add('emoji-picker-on-top', theme);\n    emojiPicker.style.display = 'none';\n    emojiPicker.addEventListener('emoji-click', (event) => {\n        const newEmoji = event.detail.unicode;\n        emojiButton.textContent = newEmoji;\n        column.dataset.emoji = newEmoji;\n        emojiPicker.style.display = 'none';\n        saveColumnState();\n    });\n\n    // Toggle emoji picker when clicking the emoji button\n    emojiButton.addEventListener('click', () => {\n        // Hide all other pickers\n        const allPickers = document.querySelectorAll('.emoji-picker-on-top');\n        allPickers.forEach(picker => {\n            if (picker !== emojiPicker) {\n                picker.style.display = 'none';\n            }\n        });\n        \n        if (emojiPicker.style.display === 'none') {\n            const rect = emojiButton.getBoundingClientRect();\n            emojiPicker.style.top = `${rect.bottom + 4}px`;\n            emojiPicker.style.left = `${rect.left}px`;\n            emojiPicker.style.display = 'block';\n        } \n        else {\n            emojiPicker.style.display = 'none';\n        }\n    });\n\n    headerContainer.appendChild(minimizeButton);\n    headerContainer.appendChild(maximizeButton);\n    titleGroup.insertBefore(emojiPicker, titleGroup.firstChild);\n    titleGroup.insertBefore(emojiButton, titleGroup.firstChild);\n    headerContainer.appendChild(titleGroup);\n    headerContainer.appendChild(menuContainer);\n\n    // Append header container to the column\n    column.appendChild(headerContainer);\n    columnsContainer.appendChild(column);\n\n    return column;\n}\nfunction createEditableTitle(options = {}) {\n    const {\n        initialText = '',\n        groupClass = '',\n        inputClass = '',\n        spanClass = '',\n        onSave = () => {},\n        defaultText = 'New Title',\n        container = 'span' // h2 or span\n    } = options;\n\n    const titleGroup = document.createElement(\"div\");\n    titleGroup.classList.add(groupClass);\n\n    const titleSpan = document.createElement(container);\n    titleSpan.classList.add(spanClass);\n    titleSpan.textContent = initialText || defaultText;\n    \n    const titleInput = document.createElement(\"input\");\n    titleInput.type = \"text\"; \n    titleInput.classList.add(inputClass);\n    titleInput.style.display = \"none\";\n\n    // Switch to edit mode\n    titleSpan.addEventListener(\"click\", () => {\n        titleInput.value = titleSpan.textContent;\n        titleInput.style.display = \"inline\";\n        titleSpan.style.display = \"none\";\n        titleInput.focus();\n        const length = titleInput.value.length;\n        titleInput.setSelectionRange(length, length);\n        const column = titleSpan.closest('.column');\n        column.draggable = false;\n        if(groupClass === 'subgroup-title-group'){\n            const subgroup = titleSpan.closest('.subgroup-item');\n            subgroup.draggable = false;\n        }\n    });\n\n    // Switch back to display mode\n    titleInput.addEventListener(\"blur\", () => {\n        const column = titleInput.closest('.column');\n        column.draggable = true;\n        if(groupClass === 'subgroup-title-group'){\n            const subgroup = titleSpan.closest('.subgroup-item');\n            subgroup.draggable = true;\n        }\n        const trimmedValue = titleInput.value.trim();\n        titleSpan.textContent = trimmedValue || defaultText;\n        titleInput.style.display = \"none\";\n        titleSpan.style.display = \"inline\";\n        onSave(trimmedValue);\n    });\n\n    // Save on Enter\n    titleInput.addEventListener(\"keydown\", (event) => {\n        if (event.key === \"Enter\") {\n            titleInput.blur();\n        }\n    });\n\n    titleGroup.appendChild(titleInput);\n    titleGroup.appendChild(titleSpan);\n\n    return {\n        titleGroup,\n        titleInput,\n        titleSpan\n    };\n}\nfunction handleFaviconClick(li, event) {\n    event.stopPropagation();\n    closeAllMenus();\n    const draggedItems = document.querySelectorAll('.selected');\n    const allItems = Array.from(document.querySelectorAll('li'));\n    const currentIndex = allItems.indexOf(li);\n\n    if (event.ctrlKey || event.metaKey) {\n        // Toggle selection with Ctrl/Cmd click\n        li.classList.toggle('selected');\n    } else if (event.shiftKey && lastSelectedIndex !== null) {\n        // Select range with Shift click\n        const start = Math.min(lastSelectedIndex, currentIndex);\n        const end = Math.max(lastSelectedIndex, currentIndex);\n        for (let i = start; i <= end; i++) {\n            allItems[i].classList.add('selected');\n        }\n    } else {\n        // Single selection\n        if (draggedItems.length === 1 && draggedItems[0] === li) {\n            // Clear selection if the only selected item is clicked again\n            li.classList.remove('selected');\n        } else {\n            draggedItems.forEach(item => item.classList.remove('selected'));\n            li.classList.add('selected');\n        }\n    }\n\n    lastSelectedIndex = currentIndex;\n}\n\n/* Tab Display */\nfunction displaySavedTabs(tabs) {\n    const columnsContainer = document.getElementById(\"columns-container\");\n    const mainContent = document.getElementById(\"main-content\");\n    mainContent.addEventListener('dragover', handleDragOver);\n    mainContent.addEventListener('drop', handleDrop);\n    columnsContainer.innerHTML = \"\";\n\n    browser.storage.local.get('columnState', (result) => {\n        const columnState = result.columnState || [];\n        columnState.forEach(columnData => {\n            const column = createColumn(columnData.title, columnData.id, columnData.minimized, columnData.emoji);\n            columnData.tabIds.forEach(tabId => {\n                if(Array.isArray(tabId)){\n                    const li = createDraggableListItem({\n                        id: tabId[0],\n                        isSubgroup: true\n                    });\n\n                    const tabGroupContainer = document.createElement(\"div\");\n                    tabGroupContainer.classList.add(\"tab-group-container\");\n                    \n                    const tabInfoContainer = document.createElement(\"div\");\n                    tabInfoContainer.classList.add(\"tab-info-container\");\n                    \n                    const faviconsContainer = document.createElement(\"div\");\n                    faviconsContainer.classList.add(\"favicons-container\");\n\n                    const expandedContainer = document.createElement('div');\n                    expandedContainer.classList.add('expanded-tabs');\n                    expandedContainer.style.display = 'none';\n                \n                    // Create title elements\n                    const { titleGroup } = createEditableTitle({\n                        initialText: tabId[tabId.length - 2],\n                        groupClass: 'subgroup-title-group',\n                        inputClass: 'subgroup-title',\n                        spanClass: 'subgroup-title-text',\n                        defaultText: 'New Group',\n                        onSave: () => saveColumnState()\n                    });\n                    tabGroupContainer.appendChild(titleGroup);\n\n                    const subgroupTabActions = document.createElement(\"div\");\n                    subgroupTabActions.classList.add(\"subgroup-tab-actions\");\n\n                    const expandButton = document.createElement(\"button\");\n                    expandButton.classList.add(\"expand-button\");\n                    expandButton.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-chevron-down\"><path d=\"m6 9 6 6 6-6\"/></svg>`;\n                    subgroupTabActions.appendChild(expandButton);\n                \n                    tabId.forEach((subTabId, index) => {\n                        // Skip the first element which is the groupId and the last element which is the title\n                        if (index === 0 || index === tabId.length - 2 || index === tabId.length - 1) return;\n                    \n                        const tab = tabs.find(t => `${t.id}` === subTabId.split('-')[1]);\n                        if (tab) {\n                            const faviconWrapper = document.createElement(\"div\");\n                            faviconWrapper.classList.add(\"favicon-wrapper\");\n                            let colorClass = tab.color;\n                            if (!colorOptions.includes(colorClass)) {\n                                colorClass = getColorClass(tab.color);\n                            }\n                            faviconWrapper.classList.add(colorClass);\n                            \n                            const favicon = document.createElement(\"img\");\n                            favicon.src = tab.favIconUrl;\n                            favicon.id = `tab-${tab.id}`;\n                            favicon.classList.add(\"subgroup-favicon\");\n                            favicon.dataset.url = tab.url;\n                            favicon.draggable = false;\n                            \n                            const title = document.createElement(\"div\");\n                            title.classList.add(\"favicon-title\");\n                            title.textContent = tab.title;\n                            title.title = tab.title;\n                \n                            faviconWrapper.appendChild(favicon);\n                            faviconWrapper.appendChild(title);\n                            faviconWrapper.addEventListener(\"click\", () => {\n                                window.location.href = tab.url;\n                            });\n                            faviconsContainer.appendChild(faviconWrapper);\n                        }\n                    });\n\n                    const allFaviconWrappers = faviconsContainer.querySelectorAll('.favicon-wrapper');\n                    allFaviconWrappers.forEach(wrapper => {\n                        const favicon = wrapper.querySelector('.subgroup-favicon');\n                        const tabId = parseInt(favicon.id.split('-')[1]);\n                        const tab = tabs.find(t => t.id === tabId);\n                        \n                        const expandedTab = createTabItem(tab);\n                        expandedContainer.appendChild(expandedTab);\n                    });\n\n                    const moreOptionsButton = document.createElement('button');\n                    moreOptionsButton.classList.add('more-options');\n                    moreOptionsButton.innerHTML = `\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" class=\"main-grid-item-icon\" fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\">\n                        <circle cx=\"12\" cy=\"12\" r=\"1\" />\n                        <circle cx=\"12\" cy=\"5\" r=\"1\" />\n                        <circle cx=\"12\" cy=\"19\" r=\"1\" />\n                      </svg>\n                    `;\n                    subgroupTabActions.appendChild(moreOptionsButton);\n\n                    moreOptionsButton.addEventListener('click', (event) => {\n                        event.stopPropagation();\n\n                        const selectedItems = document.querySelectorAll('.selected');\n                        selectedItems.forEach(item => {\n                            item.classList.remove('selected');\n                        });\n                    \n                        if (activeOptionsMenu && activeOptionsMenu.dataset.tabId === tabId[0]) {\n                            closeAllMenus();\n                            return;\n                        }\n                        closeAllMenus();\n                    \n                        const menuItems = [\n                            { text: \"Open All\", action: () => { openAllInColumn(column, tabId); closeAllMenus(); } },\n                            { text: \"Ungroup\", action: () => { ungroupSubgroup(tabId[0]); closeAllMenus(); } },\n                            { text: \"Delete\", action: () => { deleteSubgroup(tabId[0]); closeAllMenus(); } }\n                        ];\n                    \n                        activeOptionsMenu = createMenuDropdown(menuItems, moreOptionsButton);\n                        activeOptionsMenu.dataset.tabId = tabId[0];\n                    });\n\n                    titleGroup.appendChild(subgroupTabActions);\n                    tabInfoContainer.appendChild(faviconsContainer);\n                    tabInfoContainer.appendChild(expandedContainer);\n                    tabGroupContainer.appendChild(tabInfoContainer);\n                    li.appendChild(tabGroupContainer);                \n                    column.appendChild(li);\n\n                    expandButton.addEventListener('click', () => {\n                        toggleSubgroupExpandedState(expandButton);\n                        saveColumnState();\n                    });                        \n                    if (tabId[tabId.length - 1]) {\n                        toggleSubgroupExpandedState(expandButton);\n                    }\n\n                    return;\n                }\n                const tab = tabs.find(t => `${t.id}` === tabId.split('-')[1]);\n                if (tab) {\n                    const li = createTabItem(tab);\n                    column.appendChild(li);\n                }\n            });\n            if(columnData.minimized) {\n                minimizeColumn(column);\n            }\n        });\n        newColumnIndicator = document.createElement('div');\n        newColumnIndicator.classList.add('new-column-indicator');\n        const newColumnIcon = document.createElement('div');\n        newColumnIcon.innerHTML = `\n            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"40\" height=\"40\" class=\"main-grid-item-icon\" fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\">\n            <path d=\"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z\" />\n            <line x1=\"12\" x2=\"12\" y1=\"11\" y2=\"17\" />\n            <line x1=\"9\" x2=\"15\" y1=\"14\" y2=\"14\" />\n            </svg>\n        `;\n        newColumnIcon.classList.add('new-column-icon');\n        newColumnIndicator.appendChild(newColumnIcon);\n        newColumnIndicator.addEventListener('dragleave', (event) => {\n            if (!newColumnIndicator.contains(event.relatedTarget)) {\n                newColumnIndicator.classList.remove('new-column-indicator-active');\n            }\n        });\n        columnsContainer.appendChild(newColumnIndicator);\n    });\n}\nfunction fetchOpenTabs() {\n    browser.tabs.query({ currentWindow: true }, (tabs) => {\n        const excludedPrefixes = [\n            'chrome://',\n            'edge://',\n            'opera://',\n            'vivaldi://',\n            'brave://',\n            'moz-extension://',\n            'about:',\n            'file://',\n            'safari-web-extension://'\n        ];      \n        tabs = tabs.filter(tab => \n            (!excludedPrefixes.some(prefix => tab.url.startsWith(prefix))) && \n            tab.url !== \"\"\n        );\n        const sidebar = document.getElementById('sidebar');\n        const isCollapsed = sidebar.classList.contains('collapsed');\n        const classes = ['tab-item'];\n        if (isCollapsed) {\n            classes.push('collapsed');\n        }\n\n        const openTabsList = document.getElementById(\"open-tabs-list\");\n        openTabsList.addEventListener('dragover', handleDragOver);\n        openTabsList.addEventListener('drop', handleDrop);\n        openTabsList.innerHTML = \"\";\n\n        tabs.forEach((tab, index) => {\n            const li = createDraggableListItem({\n                id: `opentab-${tab.id}`,\n                isSubgroup: false,\n                classes: classes\n            });\n\n            li.innerHTML += `\n                <div class=\"tab-info-container\">\n                    <div class=\"tab-info-left\">\n                        <img src=\"${tab.favIconUrl || getFaviconUrl(tab.url)}\">\n                    </div>\n                    <div class=\"tab-info-right\">\n                        <span class=\"tab-title\">${tab.title}</span>\n                    </div>\n                    <div class=\"tab-actions\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" class=\"close-button\" fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\">\n                            <line x1=\"18\" x2=\"6\" y1=\"6\" y2=\"18\" />\n                            <line x1=\"6\" x2=\"18\" y1=\"6\" y2=\"18\" />\n                        </svg>\n                    </div>\n                </div>\n            `;\n            \n            const closeButton = li.querySelector(\".close-button\");\n            closeButton.addEventListener(\"click\", () => {\n                browser.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n                    let activeTab = tabs[0];\n                    \n                    browser.tabs.remove(tab.id, () => {\n                        browser.tabs.update(activeTab.id, { active: true });\n                    });\n                });\n            });\n\n            li.setAttribute(\"data-tab-id\", tab.id);\n            li.setAttribute(\"data-index\", index);\n\n            const favicon = li.querySelector(\".tab-info-left\");\n            favicon.addEventListener(\"click\", (event) => handleFaviconClick(li, event));\n\n            // Add click event listener to switch to the tab\n            const tabTitle = li.querySelector(\".tab-title\");\n            tabTitle.addEventListener(\"click\", () => {\n                const allItems = document.querySelectorAll('li');\n                allItems.forEach(item => item.classList.remove('selected'));\n                browser.tabs.update(tab.id, { active: true });\n            });\n\n            openTabsList.appendChild(li);\n        });\n    });\n}\n\nbrowser.tabs.onUpdated.addListener(fetchOpenTabs);\nbrowser.tabs.onRemoved.addListener(() => {\n    if(userBrowser === 'firefox'){\n        setTimeout(fetchOpenTabs, 150);\n    }\n    else{\n        fetchOpenTabs();\n    }\n});\nbrowser.tabs.onMoved.addListener(fetchOpenTabs);\nbrowser.storage.onChanged.addListener((changes, areaName) => {\n    if (userBrowser !== 'safari'){\n        if (areaName !== 'local') return;\n    }\n    if (changes.savedTabs || changes.columnState) {\n        console.log(\"Changes detected\", changes);\n        if(changes.savedTabs){\n            tabs_in_storage = changes.savedTabs.newValue.filter(tab => !('temp' in tab));\n        }\n        if(changes.columnState && changes.animation){\n            const column = document.getElementById(changes.animation.newValue.columnId);\n            if(changes.animation.newValue.minimized === true){\n                minimizeColumn(column);\n            }\n            else{\n                maximizeColumn(column);\n            }\n            return;\n        }\n        displaySavedTabs(tabs_in_storage);\n    }\n    else if (changes.bgTabs) {\n        const oldBgTabs = changes.bgTabs.oldValue || [];\n        const newBgTabs = changes.bgTabs.newValue || [];\n\n        //Check if bgTabs has changed\n        if (JSON.stringify(oldBgTabs) !== JSON.stringify(newBgTabs)) {\n            browser.storage.local.get([\"columnState\", \"bgTabs\", \"savedTabs\"], (data) => {\n                let columnState = data.columnState || [];\n                const bgTabs = data.bgTabs || [];\n                let savedTabs = data.savedTabs || [];\n                const tabIds = bgTabs.map(tab => tab.id);\n    \n                if (columnState.length === 0) {\n                    columnState.push({ id: \"defaultColumn\", tabIds: [], title: \"New Column\" });\n                }\n                const firstColumn = columnState[0];\n                const formattedIds = tabIds.map(id => `tab-${id}`);\n                firstColumn.tabIds = firstColumn.tabIds.concat(formattedIds);\n                savedTabs = savedTabs.concat(bgTabs);\n    \n                browser.storage.local.set({ columnState: columnState, bgTabs: [], savedTabs: savedTabs }, () => {\n                    console.log(\"Migrated bgTabs\");\n                });\n            });\n        }\n    }\n    else if (changes.sidebarCollapsed) {\n        if(changes.sidebarCollapsed.newValue) {\n            document.getElementById('sidebar').classList.add('collapsed');\n        } \n        else {\n            document.getElementById('sidebar').classList.remove('collapsed');\n        }\n    }\n});\nfetchOpenTabs();\n\nbrowser.storage.local.get([\"columnState\", \"bgTabs\", \"savedTabs\"], (data) => {\n    let columnState = data.columnState || [];\n    const bgTabs = data.bgTabs || [];\n    let savedTabs = data.savedTabs || [];\n\n    if(bgTabs.length > 0) {\n        const tabIds = bgTabs.map(tab => tab.id);\n        if (columnState.length === 0) {\n            columnState.push({ id: \"defaultColumn\", tabIds: [], title: \"New Column\", emoji: getRandomEmoji() });\n        }\n        const firstColumn = columnState[0];\n        const formattedIds = tabIds.map(id => `tab-${id}`);\n        firstColumn.tabIds = firstColumn.tabIds.concat(formattedIds);\n        savedTabs = savedTabs.concat(bgTabs);\n    }\n\n    savedTabs = savedTabs.filter(tab => !('temp' in tab));\n    savedTabs.push({\"temp\": Date.now()});\n\n    browser.storage.local.set({ columnState: columnState, bgTabs: [], savedTabs: savedTabs }, () => {\n        //console.log(\"Migrated bgTabs\");\n    });\n});\n\ndocument.querySelector('.minimize-sidebar').addEventListener('click', () => {\n    browser.storage.local.set({ sidebarCollapsed: true }, () => {\n        //console.log(\"Sidebar collapsed state saved\");\n        document.querySelectorAll('#open-tabs-list .tab-item').forEach(tab => {\n            tab.classList.add('collapsed');\n        });\n    });\n});\ndocument.querySelector('.maximize-sidebar').addEventListener('click', () => {\n    browser.storage.local.set({ sidebarCollapsed: false }, () => {\n        //console.log(\"Sidebar expanded state saved\");\n        document.querySelectorAll('#open-tabs-list .tab-item').forEach(tab => {\n            tab.classList.remove('collapsed');\n        });\n    });\n});\n\ndocument.addEventListener('dragover', function(event) {\n    event.preventDefault();\n});\nconst handleClickOutside = (e) => {\n    const clickedButton = e.target.closest('.more-options, .menu-option, .settings-button');\n    const isMoreOptionsButton = clickedButton !== null;\n\n    const allItems = Array.from(document.querySelectorAll('li')).filter(item => !item.classList.contains('subgroup-item'));\n    const isClickInside = allItems.some(item => item.contains(e.target));\n\n    if (!isMoreOptionsButton) {\n        closeAllMenus();\n    }\n    if (!isClickInside) {\n        allItems.forEach(item => item.classList.remove('selected'));\n    }\n\n    const emojiPickers = document.querySelectorAll('emoji-picker');\n    const emojiButtons = document.querySelectorAll('.emoji-button');\n    const isEmojiClick = Array.from(emojiButtons).some(btn => btn.contains(e.target)) || \n                        Array.from(emojiPickers).some(picker => picker.contains(e.target));\n    if (!isEmojiClick) {\n        emojiPickers.forEach(picker => picker.style.display = 'none');\n    }\n};\ndocument.addEventListener('click', handleClickOutside);\n\nbrowser.storage.local.get(['release', 'whatsNewClicked'], (data) => {\n    const release = browser.runtime.getManifest().version;\n    const previousRelease = data.release;\n    let whatsNewClicked = data.whatsNewClicked || false;\n\n    if (previousRelease !== release) {\n        const notification = document.createElement('div');\n        notification.classList.add('notification-circle');\n        settingsButton.appendChild(notification);\n        whatsNewClicked = false;\n        browser.storage.local.set({ whatsNewClicked: false });\n    }\n\n    settingsButton.addEventListener('click', () => {\n        if (activeSettingsMenu) {\n            closeAllMenus();\n            return;\n        }\n        closeAllMenus();\n\n        const settingsNotification = document.querySelector('.notification-circle:not(.inline-notification)');\n        if (settingsNotification) {\n            settingsNotification.remove();\n            browser.storage.local.set({ release: release });\n        }\n\n        let releaseNotesNotification = document.querySelector('.inline-notification');\n\n        const menuItems = [\n            { text: theme === 'dark' ? \"Toggle Light Theme\" : \"Toggle Dark Theme\", action: () => { toggleTheme(); closeAllMenus() } },\n            { text: \"What's New\", action: () => { \n                if (releaseNotesNotification) {\n                    releaseNotesNotification.remove();\n                }\n                window.open('https://tabsmagic.com/releasenotes', '_blank');\n                closeAllMenus();\n                whatsNewClicked = true;\n                browser.storage.local.set({ whatsNewClicked: true });\n            }},\n            { text: \"Feedback\", action: () => { window.open('https://tabsmagic.com/contact', '_blank'); closeAllMenus() } },\n        ];\n        activeSettingsMenu = createMenuDropdown(menuItems, settingsButton);\n\n        if (!whatsNewClicked) {\n            const releaseNotesMenuItem = activeSettingsMenu.querySelector('button:nth-child(2)');\n            releaseNotesNotification = document.createElement('div');\n            releaseNotesNotification.classList.add('notification-circle', 'inline-notification');\n            releaseNotesMenuItem.insertBefore(releaseNotesNotification, releaseNotesMenuItem.firstChild);\n        }\n    });\n});"],"names":["module","exports","e","n","r","i","s","u","a","o","c","f","h","d","l","$","y","M","name","weekdays","split","months","ordinal","t","m","String","length","Array","join","v","z","utcOffset","Math","abs","floor","date","year","month","clone","add","ceil","p","w","D","ms","Q","toLowerCase","replace","g","S","_","O","args","arguments","b","locale","$L","utc","$u","x","$x","$offset","this","parse","prototype","$d","Date","NaN","test","match","substring","UTC","init","$y","getFullYear","$M","getMonth","$D","getDate","$W","getDay","$H","getHours","$m","getMinutes","$s","getSeconds","$ms","getMilliseconds","$utils","isValid","toString","isSame","startOf","endOf","isAfter","isBefore","$g","set","unix","valueOf","getTime","toDate","apply","slice","$locale","weekStart","$set","min","daysInMonth","get","Number","round","subtract","format","invalidDate","meridiem","monthsShort","weekdaysMin","weekdaysShort","getTimezoneOffset","diff","toJSON","toISOString","toUTCString","k","forEach","extend","$i","isDayjs","en","Ls","quarter","bind","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call","Weekday","Month","Meridiem","component","targetDayJs","assign","assignSimilarTime","hour","minute","second","millisecond","AM","PM","implySimilarDate","imply","implySimilarTime","TIMEZONE_ABBR_MAP","ACDT","ACST","ADT","AEDT","AEST","AFT","AKDT","AKST","ALMT","AMST","AMT","ANAST","ANAT","AQTT","ART","AST","AWDT","AWST","AZOST","AZOT","AZST","AZT","BNT","BOT","BRST","BRT","BST","BTT","CAST","CAT","CCT","CDT","CEST","CET","timezoneOffsetDuringDst","timezoneOffsetNonDst","dstStart","getLastWeekdayOfMonth","MARCH","SUNDAY","dstEnd","OCTOBER","CHADT","CHAST","CKT","CLST","CLT","COT","CST","CT","getNthWeekdayOfMonth","NOVEMBER","CVT","CXT","ChST","DAVT","EASST","EAST","EAT","ECT","EDT","EEST","EET","EGST","EGT","EST","ET","FJST","FJT","FKST","FKT","FNT","GALT","GAMT","GET","GFT","GILT","GMT","GST","GYT","HAA","HAC","HADT","HAE","HAP","HAR","HAST","HAT","HAY","HKT","HLV","HNA","HNC","HNE","HNP","HNR","HNT","HNY","HOVT","ICT","IDT","IOT","IRDT","IRKST","IRKT","IRST","IST","JST","KGT","KRAST","KRAT","KST","KUYT","LHDT","LHST","LINT","MAGST","MAGT","MART","MAWT","MDT","MESZ","MEZ","MHT","MMT","MSD","MSK","MST","MT","MUT","MVT","MYT","NCT","NDT","NFT","NOVST","NOVT","NPT","NST","NUT","NZDT","NZST","OMSST","OMST","PDT","PET","PETST","PETT","PGT","PHOT","PHT","PKT","PMDT","PMST","PONT","PST","PT","PWT","PYST","PYT","RET","SAMT","SAST","SBT","SCT","SGT","SRT","SST","TAHT","TFT","TJT","TKT","TLT","TMT","TVT","ULAT","UYST","UYT","UZT","VET","VLAST","VLAT","VUT","WAST","WAT","WEST","WESZ","WET","WEZ","WFT","WGST","WGT","WIB","WIT","WITA","WST","WT","YAKST","YAKT","YAPT","YEKST","YEKT","weekday","dayOfMonth","oneIndexedWeekday","firstWeekdayNextMonth","dayDiff","setDate","toTimezoneOffset","timezoneInput","timezoneOverrides","matchedTimezone","quarterOfYear","ReferenceWithTimezone","constructor","input","instant","timezoneOffset","timezone","getDateWithAdjustedTimezone","getSystemTimezoneAdjustmentMinute","overrideTimezoneOffset","currentTimezoneOffset","reference","knownComponents","_tags","Set","knownValues","impliedValues","key","refDayJs","isCertain","getCertainComponents","Object","keys","value","isOnlyDate","isOnlyTime","isOnlyWeekdayComponent","isDateWithUnknownYear","isValidDate","dateWithoutTimezoneAdjustment","JSON","stringify","from","sort","dayjs","timezoneAdjustment","addTag","tag","addTags","tags","setFullYear","createRelativeFromReference","fragments","components","day","ParsingResult","index","text","start","end","refDate","result","combinedTags","repeatedTimeunitPattern","prefix","singleTimeunitPattern","connectorPattern","singleTimeunitPatternNoCapture","matchAnyPattern","dictionary","joinedTerms","Map","extractTerms","findMostLikelyADYear","yearNumber","findYearClosestToRef","refMoment","dateMoment","nextYear","lastYear","WEEKDAY_DICTIONARY","sunday","sun","monday","mon","tuesday","tue","wednesday","wed","thursday","thurs","thur","thu","friday","fri","saturday","sat","FULL_MONTH_NAME_DICTIONARY","january","february","march","april","may","june","july","august","september","october","november","december","MONTH_DICTIONARY","jan","feb","mar","apr","jun","jul","aug","sep","sept","oct","nov","dec","INTEGER_WORD_DICTIONARY","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","ORDINAL_WORD_DICTIONARY","first","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth","eleventh","twelfth","thirteenth","fourteenth","fifteenth","sixteenth","seventeenth","eighteenth","nineteenth","twentieth","TIME_UNIT_DICTIONARY_NO_ABBR","seconds","minutes","hours","days","week","weeks","quarters","years","TIME_UNIT_DICTIONARY","sec","mins","hr","hrs","mo","mos","qtr","yr","NUMBER_PATTERN","ORDINAL_NUMBER_PATTERN","parseOrdinalNumberPattern","num","parseInt","YEAR_PATTERN","parseYear","SINGLE_TIME_UNIT_PATTERN","SINGLE_TIME_UNIT_REGEX","RegExp","SINGLE_TIME_UNIT_NO_ABBR_PATTERN","TIME_UNIT_CONNECTOR_PATTERN","TIME_UNITS_PATTERN","TIME_UNITS_NO_ABBR_PATTERN","parseTimeUnits","timeunitText","remainingText","exec","collectDateTimeFragment","trim","parseFloat","parseNumberPattern","AbstractParserWithWordBoundaryChecking","cachedInnerPattern","cachedPattern","innerPatternHasChange","context","currentInnerPattern","innerPattern","patternLeftBoundary","pattern","source","flags","extract","header","innerExtract","PATTERN_WITH_OPTIONAL_PREFIX","PATTERN_WITH_PREFIX","PATTERN_WITH_PREFIX_STRICT","ENTimeUnitWithinFormatParser","strictMode","super","option","forwardDate","timeUnits","PATTERN","ENMonthNameLittleEndianParser","createParsingResult","endDate","ENMonthNameMiddleEndianParser","shouldSkipYearLikeDate","createParsingComponents","ENMonthNameParser","monthName","ENYearMonthDayParser","strictMonthDateOrder","ENSlashMonthFormatParser","AbstractTimeExpressionParser","cachedPrimaryPrefix","cachedPrimarySuffix","cachedPrimaryTimePattern","cachedFollowingPhase","cachedFollowingSuffix","cachedFollowingTimePatten","patternFlags","primaryPatternLeftBoundary","primarySuffix","followingSuffix","getPrimaryTimePatternThroughCache","startComponents","extractPrimaryTimeComponents","followingMatch","getFollowingTimePatternThroughCache","checkAndReturnWithoutFollowingPattern","extractFollowingTimeComponents","checkAndReturnWithFollowingPattern","strict","ampm","endingWithNumbers","endingNumbers","includes","startingNumbers","endingNumberVal","startingNumberVal","primaryPrefix","leftBoundary","primaryTimePattern","followingPhase","followingTimePatten","ENTimeExpressionParser","endsWith","reverseTimeUnits","reversed","STRICT_PATTERN","ENTimeUnitAgoFormatParser","outputTimeUnits","ENTimeUnitLaterFormatParser","Filter","refine","results","filter","MergingRefiner","mergedResults","curResult","nextResult","textBetween","shouldMergeResults","left","right","mergedResult","mergeResults","debug","console","log","push","AbstractMergeDateRangeRefiner","currentResult","patternBetween","fromResult","toResult","fromMoment","toMoment","ENMergeDateRangeRefiner","mergeDateTimeResult","dateResult","timeResult","beginDate","beginTime","mergeDateTimeComponent","endDateTime","nextDayJs","dateComponent","timeComponent","dateTimeComponent","AbstractMergeDateTimeRefiner","ENMergeDateTimeRefiner","TIMEZONE_NAME_PATTERN","ExtractTimezoneAbbrRefiner","timezones","suffix","timezoneAbbr","toUpperCase","tzOverrides","extractedTimezoneOffset","TIMEZONE_OFFSET_PATTERN","ExtractTimezoneOffsetRefiner","OverlapRemovalRefiner","filteredResults","prevResult","kept","removed","ForwardDateRefiner","UnlikelyFormatFilter","isStrictModeValid","ISOFormatParser","offset","hourOffset","minuteOffset","MergeWeekdayComponentRefiner","newResult","theDayAfter","nDays","targetDate","ENCasualDateParser","lowerText","theDayBefore","implyHour","ENCasualTimeParser","implyTheNextDay","getDaysForwardToWeekday","forwardCount","getBackwardDaysToWeekday","backwardCount","ENWeekdayParser","dayOfWeek","postfix","modifierWord","modifier","daysToWeekday","refWeekday","SATURDAY","backward","forward","getDaysToWeekdayClosest","getDaysToWeekday","output","addImpliedTimeUnits","createParsingComponentsAtWeekday","ENRelativeDateFormatParser","unitWord","timeunit","startsWith","SlashDateFormatParser","littleEndian","groupNumberMonth","groupNumberDay","indexEnd","indexOf","PATTERN_NO_ABBR","ENTimeUnitCasualRelativeFormatParser","allowAbbreviations","IsNegativeFollowingReference","ENMergeRelativeAfterDateRefiner","hasImpliedEarlierReferenceDate","ENMergeRelativeFollowByDateRefiner","YEAR_SUFFIX_PATTERN","ENExtractYearSuffixRefiner","ENDefaultConfiguration","createCasualConfiguration","createConfiguration","parsers","options","configuration","unshift","refiners","includeCommonConfiguration","Chrono","defaultConfig","parseDate","referenceDate","ParsingContext","parser","parsedResults","executeParser","concat","refiner","originalText","parsedResult","parsedIndex","parsedText","textOrEndIndex","endComponents","block","Function","assertNonEmptyString","str","Error","assertNumber","number","STORE_EMOJI","STORE_KEYVALUE","STORE_FAVORITES","INDEX_TOKENS","INDEX_COUNT","INDEX_GROUP_AND_ORDER","KEY_ETAG","KEY_URL","KEY_PREFERRED_SKINTONE","MODE_READONLY","MODE_READWRITE","INDEX_SKIN_UNICODE","uniqEmoji","emojis","arr","res","item","unicode","has","uniqBy","openIndexedDBRequests","databaseCache","onCloseListeners","handleOpenOrDeleteReq","resolve","reject","req","onerror","error","onblocked","onsuccess","dbPromise","db","storeName","readOnlyOrReadWrite","cb","Promise","txn","transaction","durability","store","objectStore","map","oncomplete","closeDatabase","dbName","close","listeners","listener","irregularEmoticons","extractTokens","word","Boolean","normalizeTokens","callStore","method","target","getIDB","getAllIDB","commit","findCommonMembers","arrays","uniqByFunc","shortestArray","array","func","minItem","minBy","some","findIndex","async","loadData","emojiData","url","eTag","transformedData","annotation","emoticon","group","order","shortcodes","skins","emoji","version","tokens","flat","skinTones","skinUnicodes","skinVersions","tone","transformEmojiData","emojiStore","metaStore","oldETag","oldUrl","todo","checkFetched","clear","data","put","onFetched","getEmojiBySearchQuery","query","intermediateResults","onDone","token","range","IDBKeyRange","bound","only","requiredKeys$1","customEmojiIndex","customEmojis","isArray","firstItemIsFaulty","assertCustomEmojis","sortByName","all","searchTrie","itemToTokens","currentMap","char","charAt","nextMap","valuesAtCoda","exact","queue","entriesSortedByKey","shift","entries","trie","shortcode","searchByExactMatch","searchByPrefix","shortcodeToEmoji","nameToEmoji","customEmoji","search","byShortcode","byName","isFirefoxContentScript","wrappedJSObject","cleanEmoji","structuredClone","len","warnETag","warn","requiredKeys","assertStatus","response","dataSource","status","getETagAndData","fetch","headers","json","assertEmojiData","jsonChecksum","object","inBuffer","binary","buf","ArrayBuffer","Uint8Array","charCodeAt","binaryStringToArrayBuffer","outBinString","buffer","bytes","byteLength","fromCharCode","arrayBufferToBinaryString","crypto","subtle","digest","btoa","Database","_dbName","_db","_lazyUpdate","_custom","_clear","_ready","_init","indexedDB","open","onupgradeneeded","oldVersion","createObjectStore","keyPath","indexes","indexName","multiEntry","createIndex","initialMigration","onclose","createDatabase","addOnCloseListener","empty","isEmpty","loadDataForFirstTime","getETag","eTagAndData","hasData","checkForUpdates","ready","checkReady","getEmojiByGroup","getEmojiByShortcode","predicate","lastKey","processNextBatch","getAll","lowerBound","doFullDatabaseScanForSingleResult","lowerShortcodes","getEmojiByUnicodeOrName","unicodeOrName","getEmojiByUnicode","getPreferredSkinTone","setPreferredSkinTone","skinTone","incrementFavoriteEmojiCount","getTopFavoriteEmoji","limit","favoritesStore","openCursor","cursor","addResult","continue","primaryKey","custom","_shutdown","err","deleteDatabase","allGroups","id","groups","rIC","requestIdleCallback","setTimeout","hasZwj","versionsAndTestEmoji","MOST_COMMONLY_USED_EMOJI","FONT_FAMILY","DEFAULT_CATEGORY_SORTING","getTextFeature","color","canvas","document","createElement","width","height","ctx","getContext","willReadFrequently","textBaseline","font","fillStyle","scale","fillText","getImageData","testColorEmojiSupported","feature1","feature2","feature1Str","compareFeatures","promise","detectEmojiSupportLevel","determineEmojiSupportLevel","supportedZwjEmojis","halt","event","preventDefault","stopPropagation","incrementOrDecrement","decrement","val","rAF","requestAnimationFrame","baselineEmojiWidth","resizeObserverSupported","ResizeObserver","calculateTextWidth","node","createRange","selectNode","firstChild","getBoundingClientRect","getFromMap","cache","cached","parseCache","WeakMap","domInstancesCache","unkeyedSymbol","Symbol","hasReplaceChildren","Element","patchChildren","newChildren","instanceBinding","targetNode","targetParentNode","needsRerender","parentNode","oldChild","oldChildrenCount","nextSibling","doChildrenNeedRerender","replaceChildren","innerHTML","append","applyBindings","bindings","element","instanceBindings","binding","attributeName","currentExpression","parseHtml","template","elementsToBindings","htmlString","withinTag","withinAttribute","elementIndexCounter","elementIndexes","j","pop","attributeValuePre","attributeValuePost","expressionIndex","parseTemplate","dom","cloneNode","content","firstElementChild","rootElement","topLevelBindings","size","treeWalker","createTreeWalker","NodeFilter","SHOW_ELEMENT","elementIndex","nextNode","traverseAndSetupBindings","expressions","expression","setAttribute","newNode","replaceWith","nodeValue","patch","qM","queueMicrotask","callback","then","arraysAreEqualByFunction","areEqualFunc","intersectionObserverCache","EMPTY_ARRAY","createRoot","shadowRoot","props","refs","abortController","AbortController","abortSignal","signal","state","createEffect","currentObserver","destroyed","propsToObservers","dirtyObservers","queued","flush","observersToRun","observer","Proxy","prop","observers","newValue","addEventListener","runnable","oldObserver","createState","actionContext","skinToneEmoji","i18n","database","customCategorySorting","emojiVersion","initialLoad","currentEmojis","currentEmojisWithCategories","rawSearchText","searchText","searchMode","activeSearchItem","message","skinTonePickerExpanded","skinTonePickerExpandedAfterAnimation","currentSkinTone","activeSkinTone","skinToneButtonText","pickerStyle","skinToneButtonLabel","currentFavorites","defaultFavoriteEmojis","numColumns","isRtl","currentGroupIndex","databaseLoaded","activeSearchItemId","currentGroup","focus","getElementById","emojiToDomNode","fireEvent","detail","dispatchEvent","CustomEvent","bubbles","composed","compareEmojiArrays","compareCurrentEmojisWithCategories","category","aCategory","aEmojis","bCategory","bEmojis","updateCurrentEmojis","newEmojis","updateSearchMode","newSearchMode","unicodeWithSkin","helpers","labelWithSkin","titleForEmoji","events","onClickSkinToneButton","onEmojiClick","classList","contains","clickEmoji","onNavClick","closestTarget","closest","groupId","dataset","searchElement","onNavKeydown","doFocus","el","previousElementSibling","nextElementSibling","parentElement","lastElementChild","onSearchKeydown","goToNextOrPrevious","previous","onSkinToneOptionsClick","changeSkinTone","onSkinToneOptionsFocusOut","relatedTarget","onSkinToneOptionsKeydown","changeActiveSkinTone","nextSkinTone","onSkinToneOptionsKeyup","onSearchInput","actions","calculateEmojiGridStyle","onUpdate","resizeObserver","observe","disconnect","resizeObserverAction","style","getComputedStyle","newNumColumns","getPropertyValue","newIsRtl","updateOnIntersection","root","IntersectionObserver","isIntersecting","toggle","rootMargin","threshold","intersectionObserverAction","firstRender","updateCustomEmoji","databaseCustomEmoji","container","html","domInstances","domInstanceCacheKey","keyFunction","originalCacheKey","domInstancesForTokens","updateDomInstance","createFramework","emojiList","rootDom","regionLabel","searchLabel","searchDescription","skinToneDescription","skinTonesLabel","categoriesLabel","categories","searchResultsLabel","emojiWithCategory","favoritesLabel","forElementWithAttribute","querySelectorAll","getAttribute","appendChild","eventName","listenerName","ref","removeChild","action","boundActions","WeakSet","render","level","emojiUnsupportedMessage","showingLoadingMessage","timeoutHandle","loadingMessage","networkErrorMessage","clearTimeout","handleDatabaseLoading","updatePreferredSkinTone","fill","zwjIndex","fromCodePoint","applySkinTone","skinToneLabel","favs","updateDefaultFavoriteEmojis","dbFavorites","favorites","summarizeEmojis","updateFavorites","filterEmojisByVersion","getEmojisBySearchQuery","currentGroupId","getEmojisByGroup","updateEmojis","resetScrollTopInRaf","tabpanelElement","scrollTop","isZwjSupported","emojiSupportLevel","toSimpleSkinsMap","skin","summarizeEmojisForUI","emojiSummary","find","skinTonedUnicode","zwjEmojisToCheck","allSupported","baselineEmoji","emojiWidth","supported","checkZwjSupport","checkZwjSupportAndUpdate","newEmojisWithCategories","categoriesToEmoji","calculateCurrentEmojisWithCategories","skinToneDropdown","once","newState","$destroy","abort","enI18n","activities","objects","symbols","PROPS","EXTRA_STYLES","PickerElement","HTMLElement","attachShadow","mode","textContent","_ctx","hasOwnProperty","_dbFlush","connectedCallback","_cmp","disconnectedCallback","isConnected","catch","observedAttributes","attributeChangedCallback","attrName","oldValue","_set","up","_dbCreate","definitions","defineProperties","customElements","define","theme","browser","storage","local","sidebar","sidebarCollapsed","body","className","remove","scrollAnimation","isScrolling","scrollX","scrollY","animationFrameId","settingsButton","querySelector","columnsContainer","colorOptions","dropIndicator","dropType","deletionArea","newColumnIndicator","lastSelectedIndex","activeColumnMenu","activeOptionsMenu","activeColorMenu","activeSettingsMenu","tabs_in_storage","getRandomEmoji","codePoint","random","closeAllMenus","menu","createColumn","saveColumnState","deleteIcon","alt","handleDragOver","handleDrop","createDeletionArea","userAgent","userBrowser","navigator","deleteTab","column","li","tabs","savedTabs","tabId","tab","splice","columnState","deleteSubgroup","tabIds","favicon","saveTab","newTabs","numericId","newTab","title","favIconUrl","getFaviconUrl","existingTabs","updatedTabs","_toConsumableArray","active","currentWindow","activeTab","update","createMenuDropdown","menuItems","button","menuDropdown","hidden","menuItem","display","buttonRect","position","top","bottom","window","innerWidth","editTabNote","removeEventListener","handleDragStart","noteDisplay","noteInput","draggable","scrollHeight","setSelectionRange","calculateFormattedDate","parsedDate","formattedDate","dateDisplayColor","diffDays","tabDate","today","setHours","diffTime","getToday","padStart","deleteColumn","Event","tabItems","tabItem","openAllInColumn","urls","subgroup","flatMap","favicons","create","createTabs","tabGroups","returnState","columns","columnId","expandedContainer","expandedTabList","minimized","minimizeColumn","titleSpan","titleInput","maximizeButton","minimizeButton","titleGroup","menuContainer","menuButton","headerContainer","maximizeColumn","draggedItems","dataTransfer","setData","setDragImage","calculateDropPosition","draggedElement","dropPosition","tabRect","clientY","handleColumnDragStart","calculateColumnDropPosition","columnRect","clientX","stopScrollAnimation","cancelAnimationFrame","dropEffect","containerRect","calculateScrollSpeed","distance","scrollProgress","pow","leftSpeed","rightSpeed","topSpeed","bottomSpeed","animate","scrollBy","openTabsList","spaceContainerRect","spaceContainerLeft","spaceContainerRight","containerScrollTop","dropIndicatorContainer","sidebarRect","rect","listItems","children","isMinimized","indicatorLeft","difference","indicatorTop","rectTopScroll","lastItem","max","draggedTabs","targetTab","targetSubgroup","itemRect","itemHeight","middleThirdTop","middleThirdBottom","fixedTop","fixedBottom","draggedTabsFromSubgroup","firstSubgroup","every","targetInSubgroup","subgroupIndicatorTop","subgroupItems","subgroupDropPosition","subgroupRect","subgroupIndicatorLeft","subgroupWidth","lastSubItem","lastColumn","eventDropData","getData","droppedColumn","insertBefore","itemsToProcess","draggedTabIds","tabIdsToDelete","itemIdsToSave","itemsToInsert","deletedSubgroup","itemId","newColumn","columnIndex","col","targetIsSubgroup","subgroupId","subgroupIndex","targetIndex","_subgroup","draggedTabId","tabIndex","targetTabId","_draggedTabIds","generateGroupId","now","removeTabsFromSource","colIndex","sourceTabIds","sourceIndex","sourceSubgroupIndex","sourceSubgroup","tabIndexInSubgroup","targetTabIdIndex","sourceColumnIndex","tabsToAdd","draggedIsSubgroup","expanded","_tabIds$targetTabIdIn","_tabIds$targetTabIdIn2","originalDraggedTabId","earlyExit","isCollapsed","columnElement","move","_ref","handleDragEnd","_event$target$closest","outline","tabUrl","URL","hostname","toggleSubgroupExpandedState","expandButton","isExpanded","faviconsContainer","createDraggableListItem","_li$classList","_options$isSubgroup","isSubgroup","_options$classes","classes","getColorClass","createTabItem","colorClass","_calculateFormattedDa","note","dateDisplay","backgroundColor","handleFaviconClick","tabLink","location","href","moreOptionsButton","titleDisplay","handleKeydown","newTitle","renameTab","removeDate","colorMenu","colorOption","openColorMenu","_parseAndSaveDate","chrono","parsedNote","detectedDateText","remainingNote","parseAndSaveDate","saveTabNote","shiftKey","selectionStart","selectionEnd","blur","_calculateFormattedDa2","animation","createEditableTitle","initialText","groupClass","inputClass","spanClass","defaultText","onSave","emojiButton","emojiPicker","newEmoji","picker","_options$initialText","_options$groupClass","_options$inputClass","_options$spanClass","_options$onSave","_options$defaultText","_options$container","type","trimmedValue","allItems","currentIndex","ctrlKey","metaKey","fetchOpenTabs","excludedPrefixes","onUpdated","addListener","onRemoved","onMoved","onChanged","changes","areaName","mainContent","columnData","tabGroupContainer","tabInfoContainer","subgroupTabActions","subTabId","faviconWrapper","src","wrapper","expandedTab","_step","_iterator","_createForOfIteratorHelper","done","individualTabs","newColumnIcon","displaySavedTabs","bgTabs","oldBgTabs","newBgTabs","firstColumn","formattedIds","isMoreOptionsButton","isClickInside","emojiPickers","emojiButtons","btn","release","runtime","getManifest","previousRelease","whatsNewClicked","notification","settingsNotification","releaseNotesNotification","releaseNotesMenuItem"],"sourceRoot":""}