(()=>{var e={353:function(e){e.exports=function(){"use strict";var e=6e4,t=36e5,n="millisecond",r="second",i="minute",a="hour",o="day",s="week",c="month",l="quarter",d="year",u="date",m="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},p=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},y={s:p,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+p(r,2,"0")+":"+p(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(r,c),a=n-i<0,o=t.clone().add(r+(a?-1:1),c);return+(-(r+(n-i)/(a?i-o:o-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:s,d:o,D:u,h:a,m:i,s:r,ms:n,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},v="en",b={};b[v]=g;var w="$isDayjsObject",x=function(e){return e instanceof S||!(!e||!e[w])},T=function e(t,n,r){var i;if(!t)return v;if("string"==typeof t){var a=t.toLowerCase();b[a]&&(i=a),n&&(b[a]=n,i=a);var o=t.split("-");if(!i&&o.length>1)return e(o[0])}else{var s=t.name;b[s]=t,i=s}return!r&&i&&(v=i),i||!r&&v},k=function(e,t){if(x(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new S(n)},E=y;E.l=T,E.i=x,E.w=function(e,t){return k(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var S=function(){function g(e){this.$L=T(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[w]=!0}var p=g.prototype;return p.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(E.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(f);if(r){var i=r[2]-1||0,a=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)}}return new Date(t)}(e),this.init()},p.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},p.$utils=function(){return E},p.isValid=function(){return!(this.$d.toString()===m)},p.isSame=function(e,t){var n=k(e);return this.startOf(t)<=n&&n<=this.endOf(t)},p.isAfter=function(e,t){return k(e)<this.startOf(t)},p.isBefore=function(e,t){return this.endOf(t)<k(e)},p.$g=function(e,t,n){return E.u(e)?this[t]:this.set(n,e)},p.unix=function(){return Math.floor(this.valueOf()/1e3)},p.valueOf=function(){return this.$d.getTime()},p.startOf=function(e,t){var n=this,l=!!E.u(t)||t,m=E.p(e),f=function(e,t){var r=E.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return l?r:r.endOf(o)},h=function(e,t){return E.w(n.toDate()[e].apply(n.toDate("s"),(l?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},g=this.$W,p=this.$M,y=this.$D,v="set"+(this.$u?"UTC":"");switch(m){case d:return l?f(1,0):f(31,11);case c:return l?f(1,p):f(0,p+1);case s:var b=this.$locale().weekStart||0,w=(g<b?g+7:g)-b;return f(l?y-w:y+(6-w),p);case o:case u:return h(v+"Hours",0);case a:return h(v+"Minutes",1);case i:return h(v+"Seconds",2);case r:return h(v+"Milliseconds",3);default:return this.clone()}},p.endOf=function(e){return this.startOf(e,!1)},p.$set=function(e,t){var s,l=E.p(e),m="set"+(this.$u?"UTC":""),f=(s={},s[o]=m+"Date",s[u]=m+"Date",s[c]=m+"Month",s[d]=m+"FullYear",s[a]=m+"Hours",s[i]=m+"Minutes",s[r]=m+"Seconds",s[n]=m+"Milliseconds",s)[l],h=l===o?this.$D+(t-this.$W):t;if(l===c||l===d){var g=this.clone().set(u,1);g.$d[f](h),g.init(),this.$d=g.set(u,Math.min(this.$D,g.daysInMonth())).$d}else f&&this.$d[f](h);return this.init(),this},p.set=function(e,t){return this.clone().$set(e,t)},p.get=function(e){return this[E.p(e)]()},p.add=function(n,l){var u,m=this;n=Number(n);var f=E.p(l),h=function(e){var t=k(m);return E.w(t.date(t.date()+Math.round(e*n)),m)};if(f===c)return this.set(c,this.$M+n);if(f===d)return this.set(d,this.$y+n);if(f===o)return h(1);if(f===s)return h(7);var g=(u={},u[i]=e,u[a]=t,u[r]=1e3,u)[f]||1,p=this.$d.getTime()+n*g;return E.w(p,this)},p.subtract=function(e,t){return this.add(-1*e,t)},p.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||m;var r=e||"YYYY-MM-DDTHH:mm:ssZ",i=E.z(this),a=this.$H,o=this.$m,s=this.$M,c=n.weekdays,l=n.months,d=n.meridiem,u=function(e,n,i,a){return e&&(e[n]||e(t,r))||i[n].slice(0,a)},f=function(e){return E.s(a%12||12,e,"0")},g=d||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(h,(function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return E.s(t.$y,4,"0");case"M":return s+1;case"MM":return E.s(s+1,2,"0");case"MMM":return u(n.monthsShort,s,l,3);case"MMMM":return u(l,s);case"D":return t.$D;case"DD":return E.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return u(n.weekdaysMin,t.$W,c,2);case"ddd":return u(n.weekdaysShort,t.$W,c,3);case"dddd":return c[t.$W];case"H":return String(a);case"HH":return E.s(a,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return g(a,o,!0);case"A":return g(a,o,!1);case"m":return String(o);case"mm":return E.s(o,2,"0");case"s":return String(t.$s);case"ss":return E.s(t.$s,2,"0");case"SSS":return E.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},p.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},p.diff=function(n,u,m){var f,h=this,g=E.p(u),p=k(n),y=(p.utcOffset()-this.utcOffset())*e,v=this-p,b=function(){return E.m(h,p)};switch(g){case d:f=b()/12;break;case c:f=b();break;case l:f=b()/3;break;case s:f=(v-y)/6048e5;break;case o:f=(v-y)/864e5;break;case a:f=v/t;break;case i:f=v/e;break;case r:f=v/1e3;break;default:f=v}return m?f:E.a(f)},p.daysInMonth=function(){return this.endOf(c).$D},p.$locale=function(){return b[this.$L]},p.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=T(e,t,!0);return r&&(n.$L=r),n},p.clone=function(){return E.w(this.$d,this)},p.toDate=function(){return new Date(this.valueOf())},p.toJSON=function(){return this.isValid()?this.toISOString():null},p.toISOString=function(){return this.$d.toISOString()},p.toString=function(){return this.$d.toUTCString()},g}(),C=S.prototype;return k.prototype=C,[["$ms",n],["$s",r],["$m",i],["$H",a],["$W",o],["$M",c],["$y",d],["$D",u]].forEach((function(e){C[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),k.extend=function(e,t){return e.$i||(e(t,S,k),e.$i=!0),k},k.locale=T,k.isDayjs=x,k.unix=function(e){return k(1e3*e)},k.en=b[v],k.Ls=b,k.p={},k}()},816:function(e){e.exports=function(){"use strict";var e="month",t="quarter";return function(n,r){var i=r.prototype;i.quarter=function(e){return this.$utils().u(e)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(e-1))};var a=i.add;i.add=function(n,r){return n=Number(n),this.$utils().p(r)===t?this.add(3*n,e):a.bind(this)(n,r)};var o=i.startOf;i.startOf=function(n,r){var i=this.$utils(),a=!!i.u(r)||r;if(i.p(n)===t){var s=this.quarter()-1;return a?this.month(3*s).startOf(e).startOf("day"):this.month(3*s+2).endOf(e).endOf("day")}return o.bind(this)(n,r)}}}()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}(()=>{"use strict";var e,t,r,i,a=n(816),o=n(353);function s(e,t){e.assign("day",t.date()),e.assign("month",t.month()+1),e.assign("year",t.year())}function c(t,n){t.assign("hour",n.hour()),t.assign("minute",n.minute()),t.assign("second",n.second()),t.assign("millisecond",n.millisecond()),t.get("hour")<12?t.assign("meridiem",e.AM):t.assign("meridiem",e.PM)}function l(e,t){e.imply("day",t.date()),e.imply("month",t.month()+1),e.imply("year",t.year())}function d(e,t){e.imply("hour",t.hour()),e.imply("minute",t.minute()),e.imply("second",t.second()),e.imply("millisecond",t.millisecond())}(i=e||(e={}))[i.AM=0]="AM",i[i.PM=1]="PM",function(e){e[e.SUNDAY=0]="SUNDAY",e[e.MONDAY=1]="MONDAY",e[e.TUESDAY=2]="TUESDAY",e[e.WEDNESDAY=3]="WEDNESDAY",e[e.THURSDAY=4]="THURSDAY",e[e.FRIDAY=5]="FRIDAY",e[e.SATURDAY=6]="SATURDAY"}(t||(t={})),function(e){e[e.JANUARY=1]="JANUARY",e[e.FEBRUARY=2]="FEBRUARY",e[e.MARCH=3]="MARCH",e[e.APRIL=4]="APRIL",e[e.MAY=5]="MAY",e[e.JUNE=6]="JUNE",e[e.JULY=7]="JULY",e[e.AUGUST=8]="AUGUST",e[e.SEPTEMBER=9]="SEPTEMBER",e[e.OCTOBER=10]="OCTOBER",e[e.NOVEMBER=11]="NOVEMBER",e[e.DECEMBER=12]="DECEMBER"}(r||(r={}));const u={ACDT:630,ACST:570,ADT:-180,AEDT:660,AEST:600,AFT:270,AKDT:-480,AKST:-540,ALMT:360,AMST:-180,AMT:-240,ANAST:720,ANAT:720,AQTT:300,ART:-180,AST:-240,AWDT:540,AWST:480,AZOST:0,AZOT:-60,AZST:300,AZT:240,BNT:480,BOT:-240,BRST:-120,BRT:-180,BST:60,BTT:360,CAST:480,CAT:120,CCT:390,CDT:-300,CEST:120,CET:{timezoneOffsetDuringDst:120,timezoneOffsetNonDst:60,dstStart:e=>f(e,r.MARCH,t.SUNDAY,2),dstEnd:e=>f(e,r.OCTOBER,t.SUNDAY,3)},CHADT:825,CHAST:765,CKT:-600,CLST:-180,CLT:-240,COT:-300,CST:-360,CT:{timezoneOffsetDuringDst:-300,timezoneOffsetNonDst:-360,dstStart:e=>m(e,r.MARCH,t.SUNDAY,2,2),dstEnd:e=>m(e,r.NOVEMBER,t.SUNDAY,1,2)},CVT:-60,CXT:420,ChST:600,DAVT:420,EASST:-300,EAST:-360,EAT:180,ECT:-300,EDT:-240,EEST:180,EET:120,EGST:0,EGT:-60,EST:-300,ET:{timezoneOffsetDuringDst:-240,timezoneOffsetNonDst:-300,dstStart:e=>m(e,r.MARCH,t.SUNDAY,2,2),dstEnd:e=>m(e,r.NOVEMBER,t.SUNDAY,1,2)},FJST:780,FJT:720,FKST:-180,FKT:-240,FNT:-120,GALT:-360,GAMT:-540,GET:240,GFT:-180,GILT:720,GMT:0,GST:240,GYT:-240,HAA:-180,HAC:-300,HADT:-540,HAE:-240,HAP:-420,HAR:-360,HAST:-600,HAT:-90,HAY:-480,HKT:480,HLV:-210,HNA:-240,HNC:-360,HNE:-300,HNP:-480,HNR:-420,HNT:-150,HNY:-540,HOVT:420,ICT:420,IDT:180,IOT:360,IRDT:270,IRKST:540,IRKT:540,IRST:210,IST:330,JST:540,KGT:360,KRAST:480,KRAT:480,KST:540,KUYT:240,LHDT:660,LHST:630,LINT:840,MAGST:720,MAGT:720,MART:-510,MAWT:300,MDT:-360,MESZ:120,MEZ:60,MHT:720,MMT:390,MSD:240,MSK:180,MST:-420,MT:{timezoneOffsetDuringDst:-360,timezoneOffsetNonDst:-420,dstStart:e=>m(e,r.MARCH,t.SUNDAY,2,2),dstEnd:e=>m(e,r.NOVEMBER,t.SUNDAY,1,2)},MUT:240,MVT:300,MYT:480,NCT:660,NDT:-90,NFT:690,NOVST:420,NOVT:360,NPT:345,NST:-150,NUT:-660,NZDT:780,NZST:720,OMSST:420,OMST:420,PDT:-420,PET:-300,PETST:720,PETT:720,PGT:600,PHOT:780,PHT:480,PKT:300,PMDT:-120,PMST:-180,PONT:660,PST:-480,PT:{timezoneOffsetDuringDst:-420,timezoneOffsetNonDst:-480,dstStart:e=>m(e,r.MARCH,t.SUNDAY,2,2),dstEnd:e=>m(e,r.NOVEMBER,t.SUNDAY,1,2)},PWT:540,PYST:-180,PYT:-240,RET:240,SAMT:240,SAST:120,SBT:660,SCT:240,SGT:480,SRT:-180,SST:-660,TAHT:-600,TFT:300,TJT:300,TKT:780,TLT:540,TMT:300,TVT:720,ULAT:480,UTC:0,UYST:-120,UYT:-180,UZT:300,VET:-210,VLAST:660,VLAT:660,VUT:660,WAST:120,WAT:60,WEST:60,WESZ:60,WET:0,WEZ:0,WFT:720,WGST:-120,WGT:-180,WIB:420,WIT:540,WITA:480,WST:780,WT:0,YAKST:600,YAKT:600,YAPT:600,YEKST:360,YEKT:360};function m(e,t,n,r,i=0){let a=0,o=0;for(;o<r;)a++,new Date(e,t-1,a).getDay()===n&&o++;return new Date(e,t-1,a,i)}function f(e,t,n,r=0){const i=0===n?7:n,a=new Date(e,t-1+1,1,12),o=0===a.getDay()?7:a.getDay();let s;return s=o===i?7:o<i?7+o-i:o-i,a.setDate(a.getDate()-s),new Date(e,t-1,a.getDate(),r)}function h(e,t,n={}){if(null==e)return null;if("number"==typeof e)return e;const r=n[e]??u[e];return null==r?null:"number"==typeof r?r:null==t?null:o(t).isAfter(r.dstStart(t.getFullYear()))&&!o(t).isAfter(r.dstEnd(t.getFullYear()))?r.timezoneOffsetDuringDst:r.timezoneOffsetNonDst}o.extend(a);class g{constructor(e){(e=e??new Date)instanceof Date?this.instant=e:(this.instant=e.instant??new Date,this.timezoneOffset=h(e.timezone,this.instant))}getDateWithAdjustedTimezone(){return new Date(this.instant.getTime()+6e4*this.getSystemTimezoneAdjustmentMinute(this.instant))}getSystemTimezoneAdjustmentMinute(e,t){(!e||e.getTime()<0)&&(e=new Date);const n=-e.getTimezoneOffset();return n-(t??this.timezoneOffset??n)}}class p{constructor(e,t){if(this._tags=new Set,this.reference=e,this.knownValues={},this.impliedValues={},t)for(const e in t)this.knownValues[e]=t[e];const n=o(e.instant);this.imply("day",n.date()),this.imply("month",n.month()+1),this.imply("year",n.year()),this.imply("hour",12),this.imply("minute",0),this.imply("second",0),this.imply("millisecond",0)}get(e){return e in this.knownValues?this.knownValues[e]:e in this.impliedValues?this.impliedValues[e]:null}isCertain(e){return e in this.knownValues}getCertainComponents(){return Object.keys(this.knownValues)}imply(e,t){return e in this.knownValues||(this.impliedValues[e]=t),this}assign(e,t){return this.knownValues[e]=t,delete this.impliedValues[e],this}delete(e){delete this.knownValues[e],delete this.impliedValues[e]}clone(){const e=new p(this.reference);e.knownValues={},e.impliedValues={};for(const t in this.knownValues)e.knownValues[t]=this.knownValues[t];for(const t in this.impliedValues)e.impliedValues[t]=this.impliedValues[t];return e}isOnlyDate(){return!this.isCertain("hour")&&!this.isCertain("minute")&&!this.isCertain("second")}isOnlyTime(){return!(this.isCertain("weekday")||this.isCertain("day")||this.isCertain("month")||this.isCertain("year"))}isOnlyWeekdayComponent(){return this.isCertain("weekday")&&!this.isCertain("day")&&!this.isCertain("month")}isDateWithUnknownYear(){return this.isCertain("month")&&!this.isCertain("year")}isValidDate(){const e=this.dateWithoutTimezoneAdjustment();return!(e.getFullYear()!==this.get("year")||e.getMonth()!==this.get("month")-1||e.getDate()!==this.get("day")||null!=this.get("hour")&&e.getHours()!=this.get("hour")||null!=this.get("minute")&&e.getMinutes()!=this.get("minute"))}toString(){return`[ParsingComponents {\n            tags: ${JSON.stringify(Array.from(this._tags).sort())}, \n            knownValues: ${JSON.stringify(this.knownValues)}, \n            impliedValues: ${JSON.stringify(this.impliedValues)}}, \n            reference: ${JSON.stringify(this.reference)}]`}dayjs(){return o(this.date())}date(){const e=this.dateWithoutTimezoneAdjustment(),t=this.reference.getSystemTimezoneAdjustmentMinute(e,this.get("timezoneOffset"));return new Date(e.getTime()+6e4*t)}addTag(e){return this._tags.add(e),this}addTags(e){for(const t of e)this._tags.add(t);return this}tags(){return new Set(this._tags)}dateWithoutTimezoneAdjustment(){const e=new Date(this.get("year"),this.get("month")-1,this.get("day"),this.get("hour"),this.get("minute"),this.get("second"),this.get("millisecond"));return e.setFullYear(this.get("year")),e}static createRelativeFromReference(e,t){let n=o(e.instant);for(const e in t)n=n.add(t[e],e);const r=new p(e);return t.hour||t.minute||t.second?(c(r,n),s(r,n),null!==e.timezoneOffset&&r.assign("timezoneOffset",-e.instant.getTimezoneOffset())):(d(r,n),null!==e.timezoneOffset&&r.imply("timezoneOffset",-e.instant.getTimezoneOffset()),t.d?(r.assign("day",n.date()),r.assign("month",n.month()+1),r.assign("year",n.year())):t.week?(r.assign("day",n.date()),r.assign("month",n.month()+1),r.assign("year",n.year()),r.imply("weekday",n.day())):(r.imply("day",n.date()),t.month?(r.assign("month",n.month()+1),r.assign("year",n.year())):(r.imply("month",n.month()+1),t.year?r.assign("year",n.year()):r.imply("year",n.year())))),r}}class y{constructor(e,t,n,r,i){this.reference=e,this.refDate=e.instant,this.index=t,this.text=n,this.start=r||new p(e),this.end=i}clone(){const e=new y(this.reference,this.index,this.text);return e.start=this.start?this.start.clone():null,e.end=this.end?this.end.clone():null,e}date(){return this.start.date()}tags(){const e=new Set(this.start.tags());if(this.end)for(const t of this.end.tags())e.add(t);return e}toString(){const e=Array.from(this.tags()).sort();return`[ParsingResult {index: ${this.index}, text: '${this.text}', tags: ${JSON.stringify(e)} ...}]`}}function v(e,t,n="\\s{0,5},?\\s{0,5}"){const r=t.replace(/\((?!\?)/g,"(?:");return`${e}${r}(?:${n}${r}){0,10}`}function b(e){const t=function(e){let t;return t=e instanceof Array?[...e]:e instanceof Map?Array.from(e.keys()):Object.keys(e),t}(e).sort(((e,t)=>t.length-e.length)).join("|").replace(/\./g,"\\.");return`(?:${t})`}function w(e){return e<100&&(e+=e>50?1900:2e3),e}function x(e,t,n){const r=o(e);let i=r;i=i.month(n-1),i=i.date(t),i=i.year(r.year());const a=i.add(1,"y"),s=i.add(-1,"y");return Math.abs(a.diff(r))<Math.abs(i.diff(r))?i=a:Math.abs(s.diff(r))<Math.abs(i.diff(r))&&(i=s),i.year()}const T={sunday:0,sun:0,"sun.":0,monday:1,mon:1,"mon.":1,tuesday:2,tue:2,"tue.":2,wednesday:3,wed:3,"wed.":3,thursday:4,thurs:4,"thurs.":4,thur:4,"thur.":4,thu:4,"thu.":4,friday:5,fri:5,"fri.":5,saturday:6,sat:6,"sat.":6},k={january:1,february:2,march:3,april:4,may:5,june:6,july:7,august:8,september:9,october:10,november:11,december:12},E={...k,jan:1,"jan.":1,feb:2,"feb.":2,mar:3,"mar.":3,apr:4,"apr.":4,jun:6,"jun.":6,jul:7,"jul.":7,aug:8,"aug.":8,sep:9,"sep.":9,sept:9,"sept.":9,oct:10,"oct.":10,nov:11,"nov.":11,dec:12,"dec.":12},S={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12},C={first:1,second:2,third:3,fourth:4,fifth:5,sixth:6,seventh:7,eighth:8,ninth:9,tenth:10,eleventh:11,twelfth:12,thirteenth:13,fourteenth:14,fifteenth:15,sixteenth:16,seventeenth:17,eighteenth:18,nineteenth:19,twentieth:20,"twenty first":21,"twenty-first":21,"twenty second":22,"twenty-second":22,"twenty third":23,"twenty-third":23,"twenty fourth":24,"twenty-fourth":24,"twenty fifth":25,"twenty-fifth":25,"twenty sixth":26,"twenty-sixth":26,"twenty seventh":27,"twenty-seventh":27,"twenty eighth":28,"twenty-eighth":28,"twenty ninth":29,"twenty-ninth":29,thirtieth:30,"thirty first":31,"thirty-first":31},A={second:"second",seconds:"second",minute:"minute",minutes:"minute",hour:"hour",hours:"hour",day:"d",days:"d",week:"week",weeks:"week",month:"month",months:"month",quarter:"quarter",quarters:"quarter",year:"year",years:"year"},$={s:"second",sec:"second",second:"second",seconds:"second",m:"minute",min:"minute",mins:"minute",minute:"minute",minutes:"minute",h:"hour",hr:"hour",hrs:"hour",hour:"hour",hours:"hour",d:"d",day:"d",days:"d",w:"w",week:"week",weeks:"week",mo:"month",mon:"month",mos:"month",month:"month",months:"month",qtr:"quarter",quarter:"quarter",quarters:"quarter",y:"year",yr:"year",year:"year",years:"year",...A},L=`(?:${b(S)}|[0-9]+|[0-9]+\\.[0-9]+|half(?:\\s{0,2}an?)?|an?\\b(?:\\s{0,2}few)?|few|several|the|a?\\s{0,2}couple\\s{0,2}(?:of)?)`,j=`(?:${b(C)}|[0-9]{1,2}(?:st|nd|rd|th)?)`;function M(e){let t=e.toLowerCase();return void 0!==C[t]?C[t]:(t=t.replace(/(?:st|nd|rd|th)$/i,""),parseInt(t))}const D="(?:[1-9][0-9]{0,3}\\s{0,2}(?:BE|AD|BC|BCE|CE)|[1-2][0-9]{3}|[5-9][0-9]|2[0-5])";function I(e){return/BE/i.test(e)?(e=e.replace(/BE/i,""),parseInt(e)-543):/BCE?/i.test(e)?(e=e.replace(/BCE?/i,""),-parseInt(e)):/(AD|CE)/i.test(e)?(e=e.replace(/(AD|CE)/i,""),parseInt(e)):w(parseInt(e))}const P=`(${L})\\s{0,3}(${b($)})`,R=new RegExp(P,"i"),O=`(${L})\\s{0,3}(${b(A)})`,N="\\s{0,5},?(?:\\s*and)?\\s{0,5}",z=v("(?:(?:about|around)\\s{0,3})?",P,N),B=v("(?:(?:about|around)\\s{0,3})?",O,N);function W(e){const t={};let n=e,r=R.exec(n);for(;r;)q(t,r),n=n.substring(r[0].length).trim(),r=R.exec(n);return 0==Object.keys(t).length?null:t}function q(e,t){if(t[0].match(/^[a-zA-Z]+$/))return;const n=function(e){const t=e.toLowerCase();return void 0!==S[t]?S[t]:"a"===t||"an"===t||"the"==t?1:t.match(/few/)?3:t.match(/half/)?.5:t.match(/couple/)?2:t.match(/several/)?7:parseFloat(t)}(t[1]);e[$[t[2].toLowerCase()]]=n}class F{constructor(){this.cachedInnerPattern=null,this.cachedPattern=null}innerPatternHasChange(e,t){return this.innerPattern(e)!==t}patternLeftBoundary(){return"(\\W|^)"}pattern(e){return this.cachedInnerPattern&&!this.innerPatternHasChange(e,this.cachedInnerPattern)||(this.cachedInnerPattern=this.innerPattern(e),this.cachedPattern=new RegExp(`${this.patternLeftBoundary()}${this.cachedInnerPattern.source}`,this.cachedInnerPattern.flags)),this.cachedPattern}extract(e,t){const n=t[1]??"";t.index=t.index+n.length,t[0]=t[0].substring(n.length);for(let e=2;e<t.length;e++)t[e-1]=t[e];return this.innerExtract(e,t)}}const Y=new RegExp(`(?:(?:within|in|for)\\s*)?(?:(?:about|around|roughly|approximately|just)\\s*(?:~\\s*)?)?(${z})(?=\\W|$)`,"i"),_=new RegExp(`(?:within|in|for)\\s*(?:(?:about|around|roughly|approximately|just)\\s*(?:~\\s*)?)?(${z})(?=\\W|$)`,"i"),U=new RegExp(`(?:within|in|for)\\s*(?:(?:about|around|roughly|approximately|just)\\s*(?:~\\s*)?)?(${B})(?=\\W|$)`,"i");class V extends F{constructor(e){super(),this.strictMode=e}innerPattern(e){return this.strictMode?U:e.option.forwardDate?Y:_}innerExtract(e,t){if(t[0].match(/^for\s*the\s*\w+/))return null;const n=W(t[1]);return n?p.createRelativeFromReference(e.reference,n):null}}const H=new RegExp(`(?:on\\s{0,3})?(${j})(?:\\s{0,3}(?:to|\\-|\\–|until|through|till)?\\s{0,3}(${j}))?(?:-|/|\\s{0,3}(?:of)?\\s{0,3})(${b(E)})(?:(?:-|/|,?\\s{0,3})(${D}(?!\\w)))?(?=\\W|$)`,"i");class G extends F{innerPattern(){return H}innerExtract(e,t){const n=e.createParsingResult(t.index,t[0]),r=E[t[3].toLowerCase()],i=M(t[1]);if(i>31)return t.index=t.index+t[1].length,null;if(n.start.assign("month",r),n.start.assign("day",i),t[4]){const e=I(t[4]);n.start.assign("year",e)}else{const t=x(e.refDate,i,r);n.start.imply("year",t)}if(t[2]){const e=M(t[2]);n.end=n.start.clone(),n.end.assign("day",e)}return n}}const K=new RegExp(`(${b(E)})(?:-|/|\\s*,?\\s*)(${j})(?!\\s*(?:am|pm))\\s*(?:(?:to|\\-)\\s*(${j})\\s*)?(?:(?:-|/|\\s*,\\s*|\\s+)(${D}))?(?=\\W|$)(?!\\:\\d)`,"i");class J extends F{constructor(e){super(),this.shouldSkipYearLikeDate=e}innerPattern(){return K}innerExtract(e,t){const n=E[t[1].toLowerCase()],r=M(t[2]);if(r>31)return null;if(this.shouldSkipYearLikeDate&&!t[3]&&!t[4]&&t[2].match(/^2[0-5]$/))return null;const i=e.createParsingComponents({day:r,month:n}).addTag("parser/ENMonthNameMiddleEndianParser");if(t[4]){const e=I(t[4]);i.assign("year",e)}else{const t=x(e.refDate,r,n);i.imply("year",t)}if(!t[3])return i;const a=M(t[3]),o=e.createParsingResult(t.index,t[0]);return o.start=i,o.end=i.clone(),o.end.assign("day",a),o}}const Z=new RegExp(`((?:in)\\s*)?(${b(E)})\\s*(?:[,-]?\\s*(${D})?)?(?=[^\\s\\w]|\\s+[^0-9]|\\s+$|$)`,"i");class X extends F{innerPattern(){return Z}innerExtract(e,t){const n=t[2].toLowerCase();if(t[0].length<=3&&!k[n])return null;const r=e.createParsingResult(t.index+(t[1]||"").length,t.index+t[0].length);r.start.imply("day",1),r.start.addTag("parser/ENMonthNameParser");const i=E[n];if(r.start.assign("month",i),t[3]){const e=I(t[3]);r.start.assign("year",e)}else{const t=x(e.refDate,1,i);r.start.imply("year",t)}return r}}const Q=new RegExp(`([0-9]{4})[-\\.\\/\\s](?:(${b(E)})|([0-9]{1,2}))[-\\.\\/\\s]([0-9]{1,2})(?=\\W|$)`,"i");class ee extends F{constructor(e){super(),this.strictMonthDateOrder=e}innerPattern(){return Q}innerExtract(e,t){const n=parseInt(t[1]);let r=parseInt(t[4]),i=t[3]?parseInt(t[3]):E[t[2].toLowerCase()];if(i<1||i>12){if(this.strictMonthDateOrder)return null;r>=1&&r<=12&&([i,r]=[r,i])}return r<1||r>31?null:{day:r,month:i,year:n}}}const te=new RegExp("([0-9]|0[1-9]|1[012])/([0-9]{4})","i");class ne extends F{innerPattern(){return te}innerExtract(e,t){const n=parseInt(t[2]),r=parseInt(t[1]);return e.createParsingComponents().imply("day",1).assign("month",r).assign("year",n)}}class re{constructor(e=!1){this.cachedPrimaryPrefix=null,this.cachedPrimarySuffix=null,this.cachedPrimaryTimePattern=null,this.cachedFollowingPhase=null,this.cachedFollowingSuffix=null,this.cachedFollowingTimePatten=null,this.strictMode=e}patternFlags(){return"i"}primaryPatternLeftBoundary(){return"(^|\\s|T|\\b)"}primarySuffix(){return"(?!/)(?=\\W|$)"}followingSuffix(){return"(?!/)(?=\\W|$)"}pattern(e){return this.getPrimaryTimePatternThroughCache()}extract(e,t){const n=this.extractPrimaryTimeComponents(e,t);if(!n)return t[0].match(/^\d{4}/)?(t.index+=4,null):(t.index+=t[0].length,null);const r=t.index+t[1].length,i=t[0].substring(t[1].length),a=e.createParsingResult(r,i,n);t.index+=t[0].length;const o=e.text.substring(t.index),s=this.getFollowingTimePatternThroughCache().exec(o);if(i.match(/^\d{3,4}/)&&s){if(s[0].match(/^\s*([+-])\s*\d{2,4}$/))return null;if(s[0].match(/^\s*([+-])\s*\d{2}\W\d{2}/))return null}return!s||s[0].match(/^\s*([+-])\s*\d{3,4}$/)?this.checkAndReturnWithoutFollowingPattern(a):(a.end=this.extractFollowingTimeComponents(e,s,a),a.end&&(a.text+=s[0]),this.checkAndReturnWithFollowingPattern(a))}extractPrimaryTimeComponents(t,n,r=!1){const i=t.createParsingComponents();let a=0,o=null,s=parseInt(n[2]);if(s>100){if(this.strictMode||null!=n[3])return null;a=s%100,s=Math.floor(s/100)}if(s>24)return null;if(null!=n[3]){if(1==n[3].length&&!n[6])return null;a=parseInt(n[3])}if(a>=60)return null;if(s>12&&(o=e.PM),null!=n[6]){if(s>12)return null;const t=n[6][0].toLowerCase();"a"==t&&(o=e.AM,12==s&&(s=0)),"p"==t&&(o=e.PM,12!=s&&(s+=12))}if(i.assign("hour",s),i.assign("minute",a),null!==o?i.assign("meridiem",o):s<12?i.imply("meridiem",e.AM):i.imply("meridiem",e.PM),null!=n[5]){const e=parseInt(n[5].substring(0,3));if(e>=1e3)return null;i.assign("millisecond",e)}if(null!=n[4]){const e=parseInt(n[4]);if(e>=60)return null;i.assign("second",e)}return i}extractFollowingTimeComponents(t,n,r){const i=t.createParsingComponents();if(null!=n[5]){const e=parseInt(n[5].substring(0,3));if(e>=1e3)return null;i.assign("millisecond",e)}if(null!=n[4]){const e=parseInt(n[4]);if(e>=60)return null;i.assign("second",e)}let a=parseInt(n[2]),o=0,s=-1;if(null!=n[3]?o=parseInt(n[3]):a>100&&(o=a%100,a=Math.floor(a/100)),o>=60||a>24)return null;if(a>=12&&(s=e.PM),null!=n[6]){if(a>12)return null;const t=n[6][0].toLowerCase();"a"==t&&(s=e.AM,12==a&&(a=0,i.isCertain("day")||i.imply("day",i.get("day")+1))),"p"==t&&(s=e.PM,12!=a&&(a+=12)),r.start.isCertain("meridiem")||(s==e.AM?(r.start.imply("meridiem",e.AM),12==r.start.get("hour")&&r.start.assign("hour",0)):(r.start.imply("meridiem",e.PM),12!=r.start.get("hour")&&r.start.assign("hour",r.start.get("hour")+12)))}return i.assign("hour",a),i.assign("minute",o),s>=0?i.assign("meridiem",s):r.start.isCertain("meridiem")&&r.start.get("hour")>12?r.start.get("hour")-12>a?i.imply("meridiem",e.AM):a<=12&&(i.assign("hour",a+12),i.assign("meridiem",e.PM)):a>12?i.imply("meridiem",e.PM):a<=12&&i.imply("meridiem",e.AM),i.date().getTime()<r.start.date().getTime()&&i.imply("day",i.get("day")+1),i}checkAndReturnWithoutFollowingPattern(e){if(e.text.match(/^\d$/))return null;if(e.text.match(/^\d\d\d+$/))return null;if(e.text.match(/\d[apAP]$/))return null;const t=e.text.match(/[^\d:.](\d[\d.]+)$/);if(t){const e=t[1];if(this.strictMode)return null;if(e.includes(".")&&!e.match(/\d(\.\d{2})+$/))return null;if(parseInt(e)>24)return null}return e}checkAndReturnWithFollowingPattern(e){if(e.text.match(/^\d+-\d+$/))return null;const t=e.text.match(/[^\d:.](\d[\d.]+)\s*-\s*(\d[\d.]+)$/);if(t){if(this.strictMode)return null;const e=t[1],n=t[2];if(n.includes(".")&&!n.match(/\d(\.\d{2})+$/))return null;const r=parseInt(n),i=parseInt(e);if(r>24||i>24)return null}return e}getPrimaryTimePatternThroughCache(){const e=this.primaryPrefix(),t=this.primarySuffix();return this.cachedPrimaryPrefix===e&&this.cachedPrimarySuffix===t||(this.cachedPrimaryTimePattern=function(e,t,n,r){return new RegExp(`${e}${t}(\\d{1,4})(?:(?:\\.|:|：)(\\d{1,2})(?:(?::|：)(\\d{2})(?:\\.(\\d{1,6}))?)?)?(?:\\s*(a\\.m\\.|p\\.m\\.|am?|pm?))?${n}`,r)}(this.primaryPatternLeftBoundary(),e,t,this.patternFlags()),this.cachedPrimaryPrefix=e,this.cachedPrimarySuffix=t),this.cachedPrimaryTimePattern}getFollowingTimePatternThroughCache(){const e=this.followingPhase(),t=this.followingSuffix();return this.cachedFollowingPhase===e&&this.cachedFollowingSuffix===t||(this.cachedFollowingTimePatten=function(e,t){return new RegExp(`^(${e})(\\d{1,4})(?:(?:\\.|\\:|\\：)(\\d{1,2})(?:(?:\\.|\\:|\\：)(\\d{1,2})(?:\\.(\\d{1,6}))?)?)?(?:\\s*(a\\.m\\.|p\\.m\\.|am?|pm?))?${t}`,"i")}(e,t),this.cachedFollowingPhase=e,this.cachedFollowingSuffix=t),this.cachedFollowingTimePatten}}class ie extends re{constructor(e){super(e)}followingPhase(){return"\\s*(?:\\-|\\–|\\~|\\〜|to|until|through|till|\\?)\\s*"}primaryPrefix(){return"(?:(?:at|from)\\s*)??"}primarySuffix(){return"(?:\\s*(?:o\\W*clock|at\\s*night|in\\s*the\\s*(?:morning|afternoon)))?(?!/)(?=\\W|$)"}extractPrimaryTimeComponents(t,n){const r=super.extractPrimaryTimeComponents(t,n);if(!r)return r;if(n[0].endsWith("night")){const t=r.get("hour");t>=6&&t<12?(r.assign("hour",r.get("hour")+12),r.assign("meridiem",e.PM)):t<6&&r.assign("meridiem",e.AM)}if(n[0].endsWith("afternoon")){r.assign("meridiem",e.PM);const t=r.get("hour");t>=0&&t<=6&&r.assign("hour",r.get("hour")+12)}return n[0].endsWith("morning")&&(r.assign("meridiem",e.AM),r.get("hour")<12&&r.assign("hour",r.get("hour"))),r.addTag("parser/ENTimeExpressionParser")}}function ae(e){const t={};for(const n in e)t[n]=-e[n];return t}const oe=new RegExp(`(${z})\\s{0,5}(?:ago|before|earlier)(?=\\W|$)`,"i"),se=new RegExp(`(${B})\\s{0,5}(?:ago|before|earlier)(?=\\W|$)`,"i");class ce extends F{constructor(e){super(),this.strictMode=e}innerPattern(){return this.strictMode?se:oe}innerExtract(e,t){const n=W(t[1]);if(!n)return null;const r=ae(n);return p.createRelativeFromReference(e.reference,r)}}const le=new RegExp(`(${z})\\s{0,5}(?:later|after|from now|henceforth|forward|out)(?=(?:\\W|$))`,"i"),de=new RegExp(`(${B})\\s{0,5}(later|after|from now)(?=\\W|$)`,"i");class ue extends F{constructor(e){super(),this.strictMode=e}innerPattern(){return this.strictMode?de:le}innerExtract(e,t){const n=W(t[1]);return n?p.createRelativeFromReference(e.reference,n):null}}class me{refine(e,t){return t.filter((t=>this.isValid(e,t)))}}class fe{refine(e,t){if(t.length<2)return t;const n=[];let r=t[0],i=null;for(let a=1;a<t.length;a++){i=t[a];const o=e.text.substring(r.index+r.text.length,i.index);if(this.shouldMergeResults(o,r,i,e)){const t=r,n=i,a=this.mergeResults(o,t,n,e);e.debug((()=>{console.log(`${this.constructor.name} merged ${t} and ${n} into ${a}`)})),r=a}else n.push(r),r=i}return null!=r&&n.push(r),n}}class he extends fe{shouldMergeResults(e,t,n){return!t.end&&!n.end&&null!=e.match(this.patternBetween())}mergeResults(e,t,n){if(t.start.isOnlyWeekdayComponent()||n.start.isOnlyWeekdayComponent()||(n.start.getCertainComponents().forEach((e=>{t.start.isCertain(e)||t.start.imply(e,n.start.get(e))})),t.start.getCertainComponents().forEach((e=>{n.start.isCertain(e)||n.start.imply(e,t.start.get(e))}))),t.start.date().getTime()>n.start.date().getTime()){let e=t.start.dayjs(),r=n.start.dayjs();n.start.isOnlyWeekdayComponent()&&r.add(7,"days").isAfter(e)?(r=r.add(7,"days"),n.start.imply("day",r.date()),n.start.imply("month",r.month()+1),n.start.imply("year",r.year())):t.start.isOnlyWeekdayComponent()&&e.add(-7,"days").isBefore(r)?(e=e.add(-7,"days"),t.start.imply("day",e.date()),t.start.imply("month",e.month()+1),t.start.imply("year",e.year())):n.start.isDateWithUnknownYear()&&r.add(1,"years").isAfter(e)?(r=r.add(1,"years"),n.start.imply("year",r.year())):t.start.isDateWithUnknownYear()&&e.add(-1,"years").isBefore(r)?(e=e.add(-1,"years"),t.start.imply("year",e.year())):[n,t]=[t,n]}const r=t.clone();return r.start=t.start,r.end=n.start,r.index=Math.min(t.index,n.index),t.index<n.index?r.text=t.text+e+n.text:r.text=n.text+e+t.text,r}}class ge extends he{patternBetween(){return/^\s*(to|-|–|until|through|till)\s*$/i}}function pe(e,t){const n=e.clone(),r=e.start,i=t.start;if(n.start=ye(r,i),null!=e.end||null!=t.end){const r=ye(null==e.end?e.start:e.end,null==t.end?t.start:t.end);if(null==e.end&&r.date().getTime()<n.start.date().getTime()){const e=r.dayjs().add(1,"day");r.isCertain("day")?s(r,e):l(r,e)}n.end=r}return n}function ye(t,n){const r=t.clone();return n.isCertain("hour")?(r.assign("hour",n.get("hour")),r.assign("minute",n.get("minute")),n.isCertain("second")?(r.assign("second",n.get("second")),n.isCertain("millisecond")?r.assign("millisecond",n.get("millisecond")):r.imply("millisecond",n.get("millisecond"))):(r.imply("second",n.get("second")),r.imply("millisecond",n.get("millisecond")))):(r.imply("hour",n.get("hour")),r.imply("minute",n.get("minute")),r.imply("second",n.get("second")),r.imply("millisecond",n.get("millisecond"))),n.isCertain("timezoneOffset")&&r.assign("timezoneOffset",n.get("timezoneOffset")),n.isCertain("meridiem")?r.assign("meridiem",n.get("meridiem")):null!=n.get("meridiem")&&null==r.get("meridiem")&&r.imply("meridiem",n.get("meridiem")),r.get("meridiem")==e.PM&&r.get("hour")<12&&(n.isCertain("hour")?r.assign("hour",r.get("hour")+12):r.imply("hour",r.get("hour")+12)),r.addTags(t.tags()),r.addTags(n.tags()),r}class ve extends fe{shouldMergeResults(e,t,n){return(t.start.isOnlyDate()&&n.start.isOnlyTime()||n.start.isOnlyDate()&&t.start.isOnlyTime())&&null!=e.match(this.patternBetween())}mergeResults(e,t,n){const r=t.start.isOnlyDate()?pe(t,n):pe(n,t);return r.index=t.index,r.text=t.text+e+n.text,r}}class be extends ve{patternBetween(){return new RegExp("^\\s*(T|at|after|before|on|of|,|-|\\.|∙|:)?\\s*$")}}const we=new RegExp("^\\s*,?\\s*\\(?([A-Z]{2,4})\\)?(?=\\W|$)","i");class xe{constructor(e){this.timezoneOverrides=e}refine(e,t){const n=e.option.timezones??{};return t.forEach((t=>{const r=e.text.substring(t.index+t.text.length),i=we.exec(r);if(!i)return;const a=i[1].toUpperCase(),o=t.start.date()??t.refDate??new Date,s={...this.timezoneOverrides,...n},c=h(a,o,s);if(null==c)return;e.debug((()=>{console.log(`Extracting timezone: '${a}' into: ${c} for: ${t.start}`)}));const l=t.start.get("timezoneOffset");if(null!==l&&c!=l){if(t.start.isCertain("timezoneOffset"))return;if(a!=i[1])return}t.start.isOnlyDate()&&a!=i[1]||(t.text+=i[0],t.start.isCertain("timezoneOffset")||t.start.assign("timezoneOffset",c),null==t.end||t.end.isCertain("timezoneOffset")||t.end.assign("timezoneOffset",c))})),t}}const Te=new RegExp("^\\s*(?:\\(?(?:GMT|UTC)\\s?)?([+-])(\\d{1,2})(?::?(\\d{2}))?\\)?","i");class ke{refine(e,t){return t.forEach((function(t){if(t.start.isCertain("timezoneOffset"))return;const n=e.text.substring(t.index+t.text.length),r=Te.exec(n);if(!r)return;e.debug((()=>{console.log(`Extracting timezone: '${r[0]}' into : ${t}`)}));let i=60*parseInt(r[2])+parseInt(r[3]||"0");i>840||("-"===r[1]&&(i=-i),null!=t.end&&t.end.assign("timezoneOffset",i),t.start.assign("timezoneOffset",i),t.text+=r[0])})),t}}class Ee{refine(e,t){if(t.length<2)return t;const n=[];let r=t[0];for(let i=1;i<t.length;i++){const a=t[i];if(a.index>=r.index+r.text.length){n.push(r),r=a;continue}let o=null,s=null;a.text.length>r.text.length?(o=a,s=r):(o=r,s=a),e.debug((()=>{console.log(`${this.constructor.name} remove ${s} by ${o}`)})),r=o}return null!=r&&n.push(r),n}}class Se{refine(e,t){return e.option.forwardDate?(t.forEach((t=>{let n=o(e.refDate);if(t.start.isOnlyTime()&&n.isAfter(t.start.dayjs())&&(n=n.add(1,"day"),l(t.start,n),t.end&&t.end.isOnlyTime()&&(l(t.end,n),t.start.dayjs().isAfter(t.end.dayjs())&&(n=n.add(1,"day"),l(t.end,n))),e.debug((()=>{console.log(`${this.constructor.name} adjusted ${t} time result (${t.start})`)}))),t.start.isOnlyWeekdayComponent()&&n.isAfter(t.start.dayjs())&&(n=n.day()>=t.start.get("weekday")?n.day(t.start.get("weekday")+7):n.day(t.start.get("weekday")),t.start.imply("day",n.date()),t.start.imply("month",n.month()+1),t.start.imply("year",n.year()),e.debug((()=>{console.log(`${this.constructor.name} adjusted ${t} weekday (${t.start})`)})),t.end&&t.end.isOnlyWeekdayComponent()&&(n=n.day()>t.end.get("weekday")?n.day(t.end.get("weekday")+7):n.day(t.end.get("weekday")),t.end.imply("day",n.date()),t.end.imply("month",n.month()+1),t.end.imply("year",n.year()),e.debug((()=>{console.log(`${this.constructor.name} adjusted ${t} weekday (${t.end})`)})))),t.start.isDateWithUnknownYear()&&n.isAfter(t.start.dayjs()))for(let r=0;r<3&&n.isAfter(t.start.dayjs());r++)t.start.imply("year",t.start.get("year")+1),e.debug((()=>{console.log(`${this.constructor.name} adjusted ${t} year (${t.start})`)})),t.end&&!t.end.isCertain("year")&&(t.end.imply("year",t.end.get("year")+1),e.debug((()=>{console.log(`${this.constructor.name} adjusted ${t} month (${t.start})`)})))})),t):t}}class Ce extends me{constructor(e){super(),this.strictMode=e}isValid(e,t){return t.text.replace(" ","").match(/^\d*(\.\d*)?$/)?(e.debug((()=>{console.log(`Removing unlikely result '${t.text}'`)})),!1):t.start.isValidDate()?t.end&&!t.end.isValidDate()?(e.debug((()=>{console.log(`Removing invalid result: ${t} (${t.end})`)})),!1):!this.strictMode||this.isStrictModeValid(e,t):(e.debug((()=>{console.log(`Removing invalid result: ${t} (${t.start})`)})),!1)}isStrictModeValid(e,t){return t.start.isOnlyWeekdayComponent()?(e.debug((()=>{console.log(`(Strict) Removing weekday only component: ${t} (${t.end})`)})),!1):!!(!t.start.isOnlyTime()||t.start.isCertain("hour")&&t.start.isCertain("minute"))||(e.debug((()=>{console.log(`(Strict) Removing uncertain time component: ${t} (${t.end})`)})),!1)}}const Ae=new RegExp("([0-9]{4})\\-([0-9]{1,2})\\-([0-9]{1,2})(?:T([0-9]{1,2}):([0-9]{1,2})(?::([0-9]{1,2})(?:\\.(\\d{1,4}))?)?(Z|([+-]\\d{2}):?(\\d{2})?)?)?(?=\\W|$)","i");class $e extends F{innerPattern(){return Ae}innerExtract(e,t){const n=e.createParsingComponents({year:parseInt(t[1]),month:parseInt(t[2]),day:parseInt(t[3])});if(null!=t[4]&&(n.assign("hour",parseInt(t[4])),n.assign("minute",parseInt(t[5])),null!=t[6]&&n.assign("second",parseInt(t[6])),null!=t[7]&&n.assign("millisecond",parseInt(t[7])),null!=t[8])){let e=0;if(t[9]){const n=parseInt(t[9]);let r=0;null!=t[10]&&(r=parseInt(t[10])),e=60*n,e<0?e-=r:e+=r}n.assign("timezoneOffset",e)}return n.addTag("parser/ISOFormatParser")}}class Le extends fe{mergeResults(e,t,n){const r=n.clone();return r.index=t.index,r.text=t.text+e+r.text,r.start.assign("weekday",t.start.get("weekday")),r.end&&r.end.assign("weekday",t.start.get("weekday")),r}shouldMergeResults(e,t,n){return t.start.isOnlyWeekdayComponent()&&!t.start.isCertain("hour")&&n.start.isCertain("day")&&null!=e.match(/^,?\s*$/)}}function je(e,t){let n=o(e.instant);const r=new p(e,{});return n=n.add(t,"day"),s(r,n),d(r,n),r}const Me=/(now|today|tonight|tomorrow|tmr|tmrw|yesterday|last\s*night)(?=\W|$)/i;class De extends F{innerPattern(e){return Me}innerExtract(t,n){let r=o(t.refDate);const i=n[0].toLowerCase();let a=t.createParsingComponents();switch(i){case"now":a=function(e){const t=o(e.instant),n=new p(e,{});return s(n,t),c(n,t),null!==e.timezoneOffset&&n.assign("timezoneOffset",t.utcOffset()),n.addTag("casualReference/now"),n}(t.reference);break;case"today":a=function(e){const t=o(e.instant),n=new p(e,{});return s(n,t),d(n,t),n.addTag("casualReference/today"),n}(t.reference);break;case"yesterday":a=function(e){return je(e,-1)}(t.reference).addTag("casualReference/yesterday");break;case"tomorrow":case"tmr":case"tmrw":a=je(t.reference,1).addTag("casualReference/tomorrow");break;case"tonight":a=function(t,n=22){const r=o(t.instant),i=new p(t,{});return s(i,r),i.imply("hour",n),i.imply("meridiem",e.PM),i.addTag("casualReference/tonight"),i}(t.reference);break;default:i.match(/last\s*night/)&&(r.hour()>6&&(r=r.add(-1,"day")),s(a,r),a.imply("hour",0))}return a.addTag("parser/ENCasualDateParser"),a}}const Ie=/(?:this)?\s{0,3}(morning|afternoon|evening|night|midnight|midday|noon)(?=\W|$)/i;class Pe extends F{innerPattern(){return Ie}innerExtract(t,n){let r=null;switch(n[1].toLowerCase()){case"afternoon":r=function(t,n=15){const r=new p(t,{});return r.imply("meridiem",e.PM),r.imply("hour",n),r.imply("minute",0),r.imply("second",0),r.imply("millisecond",0),r.addTag("casualReference/afternoon"),r}(t.reference);break;case"evening":case"night":r=function(t,n=20){const r=new p(t,{});return r.imply("meridiem",e.PM),r.imply("hour",n),r.addTag("casualReference/evening"),r}(t.reference);break;case"midnight":r=function(e){const t=new p(e,{}),n=o(e.instant);return n.hour()>2&&function(e,t){l(e,t=t.add(1,"day")),d(e,t)}(t,n),t.assign("hour",0),t.imply("minute",0),t.imply("second",0),t.imply("millisecond",0),t.addTag("casualReference/midnight"),t}(t.reference);break;case"morning":r=function(t,n=6){const r=new p(t,{});return r.imply("meridiem",e.AM),r.imply("hour",n),r.imply("minute",0),r.imply("second",0),r.imply("millisecond",0),r.addTag("casualReference/morning"),r}(t.reference);break;case"noon":case"midday":r=function(t){const n=new p(t,{});return n.imply("meridiem",e.AM),n.imply("hour",12),n.imply("minute",0),n.imply("second",0),n.imply("millisecond",0),n.addTag("casualReference/noon"),n}(t.reference)}return r&&r.addTag("parser/ENCasualTimeParser"),r}}function Re(e,t){let n=t-e.getDay();return n<0&&(n+=7),n}function Oe(e,t){let n=t-e.getDay();return n>=0&&(n-=7),n}const Ne=new RegExp(`(?:(?:\\,|\\(|\\（)\\s*)?(?:on\\s*?)?(?:(this|last|past|next)\\s*)?(${b(T)})(?:\\s*(?:\\,|\\)|\\）))?(?:\\s*(this|last|past|next)\\s*week)?(?=\\W|$)`,"i");class ze extends F{innerPattern(){return Ne}innerExtract(e,n){const r=n[2].toLowerCase(),i=T[r],a=n[1],o=n[3];let s=a||o;s=s||"",s=s.toLowerCase();let c=null;return"last"==s||"past"==s?c="last":"next"==s?c="next":"this"==s&&(c="this"),function(e,n,r){const i=function(e,n,r){const i=e.getDay();switch(r){case"this":return Re(e,n);case"last":return Oe(e,n);case"next":return i==t.SUNDAY?n==t.SUNDAY?7:n:i==t.SATURDAY?n==t.SATURDAY?7:n==t.SUNDAY?8:1+n:n<i&&n!=t.SUNDAY?Re(e,n):Re(e,n)+7}return function(e,t){const n=Oe(e,t),r=Re(e,t);return r<-n?r:n}(e,n)}(e.getDateWithAdjustedTimezone(),n,r);let a=new p(e);return a=function(e,t){const n=e.clone();let r=e.dayjs();for(const e in t)r=r.add(t[e],e);return("day"in t||"d"in t||"week"in t||"month"in t||"year"in t)&&(n.imply("day",r.date()),n.imply("month",r.month()+1),n.imply("year",r.year())),("second"in t||"minute"in t||"hour"in t)&&(n.imply("second",r.second()),n.imply("minute",r.minute()),n.imply("hour",r.hour())),n}(a,{day:i}),a.assign("weekday",n),a}(e.reference,i,c)}}const Be=new RegExp(`(this|last|past|next|after\\s*this)\\s*(${b($)})(?=\\s*)(?=\\W|$)`,"i");class We extends F{innerPattern(){return Be}innerExtract(e,t){const n=t[1].toLowerCase(),r=t[2].toLowerCase(),i=$[r];if("next"==n||n.startsWith("after")){const t={};return t[i]=1,p.createRelativeFromReference(e.reference,t)}if("last"==n||"past"==n){const t={};return t[i]=-1,p.createRelativeFromReference(e.reference,t)}const a=e.createParsingComponents();let s=o(e.reference.instant);return r.match(/week/i)?(s=s.add(-s.get("d"),"d"),a.imply("day",s.date()),a.imply("month",s.month()+1),a.imply("year",s.year())):r.match(/month/i)?(s=s.add(1-s.date(),"d"),a.imply("day",s.date()),a.assign("year",s.year()),a.assign("month",s.month()+1)):r.match(/year/i)&&(s=s.add(1-s.date(),"d"),s=s.add(-s.month(),"month"),a.imply("day",s.date()),a.imply("month",s.month()+1),a.assign("year",s.year())),a}}const qe=new RegExp("([^\\d]|^)([0-3]{0,1}[0-9]{1})[\\/\\.\\-]([0-3]{0,1}[0-9]{1})(?:[\\/\\.\\-]([0-9]{4}|[0-9]{2}))?(\\W|$)","i");class Fe{constructor(e){this.groupNumberMonth=e?3:2,this.groupNumberDay=e?2:3}pattern(){return qe}extract(e,t){const n=t.index+t[1].length,r=t.index+t[0].length-t[5].length;if(n>0&&e.text.substring(0,n).match("\\d/?$"))return;if(r<e.text.length&&e.text.substring(r).match("^/?\\d"))return;const i=e.text.substring(n,r);if(i.match(/^\d\.\d$/)||i.match(/^\d\.\d{1,2}\.\d{1,2}\s*$/))return;if(!t[4]&&i.indexOf("/")<0)return;const a=e.createParsingResult(n,i);let o=parseInt(t[this.groupNumberMonth]),s=parseInt(t[this.groupNumberDay]);if((o<1||o>12)&&o>12){if(!(s>=1&&s<=12&&o<=31))return null;[s,o]=[o,s]}if(s<1||s>31)return null;if(a.start.assign("day",s),a.start.assign("month",o),t[4]){const e=w(parseInt(t[4]));a.start.assign("year",e)}else{const t=x(e.refDate,s,o);a.start.imply("year",t)}return a}}const Ye=new RegExp(`(this|last|past|next|after|\\+|-)\\s*(${z})(?=\\W|$)`,"i"),_e=new RegExp(`(this|last|past|next|after|\\+|-)\\s*(${B})(?=\\W|$)`,"i");class Ue extends F{constructor(e=!0){super(),this.allowAbbreviations=e}innerPattern(){return this.allowAbbreviations?Ye:_e}innerExtract(e,t){const n=t[1].toLowerCase();let r=W(t[2]);if(!r)return null;switch(n){case"last":case"past":case"-":r=ae(r)}return p.createRelativeFromReference(e.reference,r)}}function Ve(e){return null!=e.text.match(/^-/i)}class He extends fe{shouldMergeResults(e,t,n){return!!e.match(/^\s*$/i)&&(null!=n.text.match(/^[+-]/i)||Ve(n))}mergeResults(e,t,n,r){let i=W(n.text);Ve(n)&&(i=ae(i));const a=p.createRelativeFromReference(new g(t.start.date()),i);return new y(t.reference,t.index,`${t.text}${e}${n.text}`,a)}}function Ge(e){return null!=e.text.match(/\s+(before|from)$/i)}class Ke extends fe{patternBetween(){return/^\s*$/i}shouldMergeResults(e,t,n){return!(!e.match(this.patternBetween())||!Ge(t)&&(r=t,null==r.text.match(/\s+(after|since)$/i))||!n.start.get("day")||!n.start.get("month")||!n.start.get("year"));var r}mergeResults(e,t,n){let r=W(t.text);Ge(t)&&(r=ae(r));const i=p.createRelativeFromReference(new g(n.start.date()),r);return new y(n.reference,t.index,`${t.text}${e}${n.text}`,i)}}const Je=new RegExp(`^\\s*(${D})`,"i");class Ze{refine(e,t){return t.forEach((function(t){if(!t.start.isDateWithUnknownYear())return;const n=e.text.substring(t.index+t.text.length),r=Je.exec(n);if(!r)return;e.debug((()=>{console.log(`Extracting year: '${r[0]}' into : ${t}`)}));const i=I(r[1]);null!=t.end&&t.end.assign("year",i),t.start.assign("year",i),t.text+=r[0]})),t}}class Xe{createCasualConfiguration(e=!1){const t=this.createConfiguration(!1,e);return t.parsers.push(new De),t.parsers.push(new Pe),t.parsers.push(new X),t.parsers.push(new We),t.parsers.push(new Ue),t}createConfiguration(e=!0,t=!1){const n=function(e,t=!1){return e.parsers.unshift(new $e),e.refiners.unshift(new Le),e.refiners.unshift(new ke),e.refiners.unshift(new Ee),e.refiners.push(new xe),e.refiners.push(new Ee),e.refiners.push(new Se),e.refiners.push(new Ce(t)),e}({parsers:[new Fe(t),new V(e),new G,new J(t),new ze,new ne,new ie(e),new ce(e),new ue(e)],refiners:[new be]},e);return n.parsers.unshift(new ee(e)),n.refiners.unshift(new Ke),n.refiners.unshift(new He),n.refiners.unshift(new Ee),n.refiners.push(new be),n.refiners.push(new Ze),n.refiners.push(new ge),n}}class Qe{constructor(e){this.defaultConfig=new Xe,e=e||this.defaultConfig.createCasualConfiguration(),this.parsers=[...e.parsers],this.refiners=[...e.refiners]}clone(){return new Qe({parsers:[...this.parsers],refiners:[...this.refiners]})}parseDate(e,t,n){const r=this.parse(e,t,n);return r.length>0?r[0].start.date():null}parse(e,t,n){const r=new et(e,t,n);let i=[];return this.parsers.forEach((e=>{const t=Qe.executeParser(r,e);i=i.concat(t)})),i.sort(((e,t)=>e.index-t.index)),this.refiners.forEach((function(e){i=e.refine(r,i)})),i}static executeParser(e,t){const n=[],r=t.pattern(e),i=e.text;let a=e.text,o=r.exec(a);for(;o;){const s=o.index+i.length-a.length;o.index=s;const c=t.extract(e,o);if(!c){a=i.substring(o.index+1),o=r.exec(a);continue}let l=null;c instanceof y?l=c:c instanceof p?(l=e.createParsingResult(o.index,o[0]),l.start=c):l=e.createParsingResult(o.index,o[0],c);const d=l.index,u=l.text;e.debug((()=>console.log(`${t.constructor.name} extracted (at index=${d}) '${u}'`))),n.push(l),a=i.substring(d+u.length),o=r.exec(a)}return n}}class et{constructor(e,t,n){this.text=e,this.reference=new g(t),this.option=n??{},this.refDate=this.reference.instant}createParsingComponents(e){return e instanceof p?e:new p(this.reference,e)}createParsingResult(e,t,n,r){const i="string"==typeof t?t:this.text.substring(e,t),a=n?this.createParsingComponents(n):null,o=r?this.createParsingComponents(r):null;return new y(this.reference,e,i,a,o)}debug(e){this.option.debug&&(this.option.debug instanceof Function?this.option.debug(e):this.option.debug.debug(e))}}function tt(e){if("string"!=typeof e||!e)throw new Error("expected a non-empty string, got: "+e)}function nt(e){if("number"!=typeof e)throw new Error("expected a number, got: "+e)}const rt="emoji",it="keyvalue",at="favorites",ot="tokens",st="count",ct="group-order",lt="eTag",dt="url",ut="skinTone",mt="readonly",ft="readwrite",ht="skinUnicodes";function gt(e){return function(e){const t=new Set,n=[];for(const r of e){const e=r.unicode;t.has(e)||(t.add(e),n.push(r))}return n}(e)}const pt={},yt={},vt={};function bt(e,t,n){n.onerror=()=>t(n.error),n.onblocked=()=>t(new Error("IDB blocked")),n.onsuccess=()=>e(n.result)}function wt(e,t,n,r){return new Promise(((i,a)=>{const o=e.transaction(t,n,{durability:"relaxed"}),s="string"==typeof t?o.objectStore(t):t.map((e=>o.objectStore(e)));let c;r(s,o,(e=>{c=e})),o.oncomplete=()=>i(c),o.onerror=()=>a(o.error)}))}function xt(e){const t=pt[e],n=t&&t.result;if(n){n.close();const t=vt[e];if(t)for(const e of t)e()}delete pt[e],delete yt[e],delete vt[e]}const Tt=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function kt(e){return e.split(/[\s_]+/).map((e=>!e.match(/\w/)||Tt.has(e)?e.toLowerCase():e.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase())).filter(Boolean)}function Et(e){return e.filter(Boolean).map((e=>e.toLowerCase())).filter((e=>e.length>=2))}function St(e,t,n,r){e[t](n).onsuccess=e=>r&&r(e.target.result)}function Ct(e,t,n){St(e,"get",t,n)}function At(e,t,n){St(e,"getAll",t,n)}function $t(e){e.commit&&e.commit()}function Lt(e,t){const n=function(e,t){let n=e[0];for(let r=1;r<e.length;r++){const i=e[r];t(n)>t(i)&&(n=i)}return n}(e,(e=>e.length)),r=[];for(const i of n)e.some((e=>-1===e.findIndex((e=>t(e)===t(i)))))||r.push(i);return r}async function jt(e,t,n,r){try{const i=function(e){return e.map((({annotation:e,emoticon:t,group:n,order:r,shortcodes:i,skins:a,tags:o,emoji:s,version:c})=>{const l={annotation:e,group:n,order:r,tags:o,tokens:[...new Set(Et([...(i||[]).map(kt).flat(),...(o||[]).map(kt).flat(),...kt(e),t]))].sort(),unicode:s,version:c};if(t&&(l.emoticon=t),i&&(l.shortcodes=i),a){l.skinTones=[],l.skinUnicodes=[],l.skinVersions=[];for(const{tone:e,emoji:t,version:n}of a)l.skinTones.push(e),l.skinUnicodes.push(t),l.skinVersions.push(n)}return l}))}(t);await wt(e,[rt,it],ft,(([e,t],a)=>{let o,s,c=0;function l(){2==++c&&function(){if(o!==r||s!==n){e.clear();for(const t of i)e.put(t);t.put(r,lt),t.put(n,dt),$t(a)}}()}Ct(t,lt,(e=>{o=e,l()})),Ct(t,dt,(e=>{s=e,l()}))}))}finally{}}async function Mt(e,t){const n=Et(kt(t));return n.length?wt(e,rt,mt,((e,t,r)=>{const i=[],a=()=>{const e=Lt(i,(e=>e.unicode));r(e.sort(((e,t)=>e.order<t.order?-1:1)))};for(let t=0;t<n.length;t++){const r=n[t],o=t===n.length-1?IDBKeyRange.bound(r,r+"￿",!1,!0):IDBKeyRange.only(r);At(e.index(ot),o,(e=>{i.push(e),i.length===n.length&&a()}))}})):[]}function Dt(e,t,n){return wt(e,t,mt,((e,t,r)=>Ct(e,n,r)))}const It=["name","url"];function Pt(e){!function(e){const t=e&&Array.isArray(e),n=t&&e.length&&(!e[0]||It.some((t=>!(t in e[0]))));if(!t||n)throw new Error("Custom emojis are in the wrong format")}(e);const t=(e,t)=>e.name.toLowerCase()<t.name.toLowerCase()?-1:1,n=e.sort(t),r=function(e,t){const n=new Map;for(const r of e){const e=t(r);for(const t of e){let e=n;for(let n=0;n<t.length;n++){const r=t.charAt(n);let i=e.get(r);i||(i=new Map,e.set(r,i)),e=i}let i=e.get("");i||(i=[],e.set("",i)),i.push(r)}}return(e,t)=>{let r=n;for(let t=0;t<e.length;t++){const n=e.charAt(t),i=r.get(n);if(!i)return[];r=i}if(t)return r.get("")||[];const i=[],a=[r];for(;a.length;){const e=[...a.shift().entries()].sort(((e,t)=>e[0]<t[0]?-1:1));for(const[t,n]of e)""===t?i.push(...n):a.push(n)}return i}}(e,(e=>{const t=new Set;if(e.shortcodes)for(const n of e.shortcodes)for(const e of kt(n))t.add(e);return t})),i=e=>r(e,!0),a=e=>r(e,!1),o=new Map,s=new Map;for(const t of e){s.set(t.name.toLowerCase(),t);for(const e of t.shortcodes||[])o.set(e.toLowerCase(),t)}return{all:n,search:e=>{const n=kt(e);return Lt(n.map(((e,t)=>(t<n.length-1?i:a)(e))),(e=>e.name)).sort(t)},byShortcode:e=>o.get(e.toLowerCase()),byName:e=>s.get(e.toLowerCase())}}const Rt="undefined"!=typeof wrappedJSObject;function Ot(e){if(!e)return e;if(Rt&&(e=structuredClone(e)),delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let n=0;n<t;n++)e.skins[n]={tone:e.skinTones[n],unicode:e.skinUnicodes[n],version:e.skinVersions[n]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function Nt(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const zt=["annotation","emoji","group","order","version"];function Bt(e,t){if(2!==Math.floor(e.status/100))throw new Error("Failed to fetch: "+t+":  "+e.status)}async function Wt(e){const t=await fetch(e);Bt(t,e);const n=t.headers.get("etag");Nt(n);const r=await t.json();return function(e){if(!e||!Array.isArray(e)||!e[0]||"object"!=typeof e[0]||zt.some((t=>!(t in e[0]))))throw new Error("Emoji data is in the wrong format")}(r),[n,r]}async function qt(e){let t=function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=-1;++i<t;)r[i]=e.charCodeAt(i);return n}(JSON.stringify(e));const n=function(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,i=-1;++i<r;)t+=String.fromCharCode(n[i]);return t}(await crypto.subtle.digest("SHA-1",t));return btoa(n)}class Ft{constructor({dataSource:e="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",locale:t="en",customEmoji:n=[]}={}){this.dataSource=e,this.locale=t,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=Pt(n),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const e=this._db=await(t=this._dbName,yt[t]||(yt[t]=async function(e){const t=await new Promise(((t,n)=>{const r=indexedDB.open(e,1);pt[e]=r,r.onupgradeneeded=e=>{e.oldVersion<1&&function(e){function t(t,n,r){const i=n?e.createObjectStore(t,{keyPath:n}):e.createObjectStore(t);if(r)for(const[e,[t,n]]of Object.entries(r))i.createIndex(e,t,{multiEntry:n});return i}t(it),t(rt,"unicode",{[ot]:["tokens",!0],[ct]:[["group","order"]],[ht]:["skinUnicodes",!0]}),t(at,void 0,{[st]:[""]})}(r.result)},bt(t,n,r)}));return t.onclose=()=>xt(e),t}(t)),yt[t]);var t;!function(e,t){let n=vt[e];n||(n=vt[e]=[]),n.push(t)}(this._dbName,this._clear);const n=this.dataSource,r=await async function(e){return!await Dt(e,it,dt)}(e);r?await async function(e,t){let[n,r]=await Wt(t);n||(n=await qt(r)),await jt(e,r,t,n)}(e,n):this._lazyUpdate=async function(e,t){let n,r=await async function(e){const t=await fetch(e,{method:"HEAD"});Bt(t,e);const n=t.headers.get("etag");return Nt(n),n}(t);if(!r){const e=await Wt(t);r=e[0],n=e[1],r||(r=await qt(n))}await async function(e,t,n){const[r,i]=await Promise.all([lt,dt].map((t=>Dt(e,it,t))));return r===n&&i===t}(e,t,r)||(n||(n=(await Wt(t))[1]),await jt(e,n,t,r))}(e,n)}async ready(){const e=async()=>(this._ready||(this._ready=this._init()),this._ready);await e(),this._db||await e()}async getEmojiByGroup(e){return nt(e),await this.ready(),gt(await async function(e,t){return wt(e,rt,mt,((e,n,r)=>{const i=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);At(e.index(ct),i,r)}))}(this._db,e)).map(Ot)}async getEmojiBySearchQuery(e){return tt(e),await this.ready(),[...this._custom.search(e),...gt(await Mt(this._db,e)).map(Ot)]}async getEmojiByShortcode(e){tt(e),await this.ready();return this._custom.byShortcode(e)||Ot(await async function(e,t){const n=await Mt(e,t);if(!n.length){const n=e=>(e.shortcodes||[]).includes(t.toLowerCase());return await async function(e,t){return wt(e,rt,mt,((e,n,r)=>{let i;const a=()=>{e.getAll(i&&IDBKeyRange.lowerBound(i,!0),50).onsuccess=e=>{const n=e.target.result;for(const e of n)if(i=e.unicode,t(e))return r(e);if(n.length<50)return r();a()}};a()}))}(e,n)||null}return n.filter((e=>{const n=(e.shortcodes||[]).map((e=>e.toLowerCase()));return n.includes(t.toLowerCase())}))[0]||null}(this._db,e))}async getEmojiByUnicodeOrName(e){tt(e),await this.ready();return this._custom.byName(e)||Ot(await async function(e,t){return wt(e,rt,mt,((e,n,r)=>Ct(e,t,(n=>{if(n)return r(n);Ct(e.index(ht),t,(e=>r(e||null)))}))))}(this._db,e))}async getPreferredSkinTone(){return await this.ready(),await Dt(this._db,it,ut)||0}async setPreferredSkinTone(e){return nt(e),await this.ready(),t=this._db,n=ut,r=e,wt(t,it,ft,((e,t)=>{e.put(r,n),$t(t)}));var t,n,r}async incrementFavoriteEmojiCount(e){return tt(e),await this.ready(),t=this._db,n=e,wt(t,at,ft,((e,t)=>Ct(e,n,(r=>{e.put((r||0)+1,n),$t(t)}))));var t,n}async getTopFavoriteEmoji(e){return nt(e),await this.ready(),(await function(e,t,n){return 0===n?[]:wt(e,[at,rt],mt,(([e,r],i,a)=>{const o=[];e.index(st).openCursor(void 0,"prev").onsuccess=e=>{const i=e.target.result;if(!i)return a(o);function s(e){if(o.push(e),o.length===n)return a(o);i.continue()}const c=i.primaryKey,l=t.byName(c);if(l)return s(l);Ct(r,c,(e=>{if(e)return s(e);i.continue()}))}}))}(this._db,this._custom,e)).map(Ot)}set customEmoji(e){this._custom=Pt(e)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch(e){}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await xt(this._dbName)}async delete(){var e;await this._shutdown(),await(e=this._dbName,new Promise(((t,n)=>{xt(e),bt(t,n,indexedDB.deleteDatabase(e))})))}}const Yt=[[-1,"✨","custom"],[0,"😀","smileys-emotion"],[1,"👋","people-body"],[3,"🐱","animals-nature"],[4,"🍎","food-drink"],[5,"🏠️","travel-places"],[6,"⚽","activities"],[7,"📝","objects"],[8,"⛔️","symbols"],[9,"🏁","flags"]].map((([e,t,n])=>({id:e,emoji:t,name:n}))),_t=Yt.slice(1),Ut="function"==typeof requestIdleCallback?requestIdleCallback:setTimeout;function Vt(e){return e.unicode.includes("‍")}const Ht={"🫩":16,"🫨":15.1,"🫠":14,"🥲":13.1,"🥻":12.1,"🥰":11,"🤩":5,"👱‍♀️":4,"🤣":3,"👁️‍🗨️":2,"😀":1,"😐️":.7,"😃":.6},Gt=["😊","😒","❤️","👍️","😍","😂","😭","☺️","😔","😩","😏","💕","🙌","😘"],Kt='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',Jt=(e,t)=>e<t?-1:e>t?1:0,Zt=(e,t)=>{const n=document.createElement("canvas");n.width=n.height=1;const r=n.getContext("2d",{willReadFrequently:!0});return r.textBaseline="top",r.font=`100px ${Kt}`,r.fillStyle=t,r.scale(.01,.01),r.fillText(e,0,0),r.getImageData(0,0,1,1).data};function Xt(e){const t=Zt(e,"#000"),n=Zt(e,"#fff");return t&&n&&((e,t)=>{const n=[...e].join(",");return n===[...t].join(",")&&!n.startsWith("0,0,0,")})(t,n)}let Qt;const en=()=>(Qt||(Qt=new Promise((e=>Ut((()=>e(function(){const e=Object.entries(Ht);try{for(const[t,n]of e)if(Xt(t))return n}catch(e){}return e[0][1]}())))))),Qt),tn=new Map;function nn(e){e.preventDefault(),e.stopPropagation()}function rn(e,t,n){return(t+=e?-1:1)<0?t=n.length-1:t>=n.length&&(t=0),t}function an(e,t){const n=new Set,r=[];for(const i of e){const e=t(i);n.has(e)||(n.add(e),r.push(i))}return r}const on=requestAnimationFrame;let sn,cn="function"==typeof ResizeObserver;function ln(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}function dn(e,t,n){let r=e.get(t);return r||(r=n(),e.set(t,r)),r}function un(e){return""+e}const mn=new WeakMap,fn=new WeakMap,hn=Symbol("un-keyed"),gn="replaceChildren"in Element.prototype;function pn(e,t){const{targetNode:n}=t;let{targetParentNode:r}=t,i=!1;r?i=function(e,t){let n=e.firstChild,r=0;for(;n;){if(t[r]!==n)return!0;n=n.nextSibling,r++}return r!==t.length}(r,e):(i=!0,t.targetNode=void 0,t.targetParentNode=r=n.parentNode),i&&function(e,t){gn?e.replaceChildren(...t):(e.innerHTML="",e.append(...t))}(r,e)}function yn(e,t,n){for(let r=0;r<e.length;r++){const i=e[r],a={binding:i,targetNode:i.attributeName?t:t.firstChild,targetParentNode:void 0,currentExpression:void 0};n.push(a)}}function vn(e){const{template:t,elementsToBindings:n}=dn(mn,e,(()=>function(e){let t="",n=!1,r=!1,i=-1;const a=new Map,o=[];for(let s=0,c=e.length;s<c;s++){const l=e[s];if(t+=l,s===c-1)break;for(let e=0;e<l.length;e++)switch(l.charAt(e)){case"<":"/"===l.charAt(e+1)?o.pop():(n=!0,o.push(++i));break;case">":n=!1,r=!1;break;case"=":r=!0}const d=dn(a,o[o.length-1],(()=>[]));let u,m,f;if(r){const t=/(\S+)="?([^"=]*)$/.exec(l);u=t[1],m=t[2],f=/^[^">]*/.exec(e[s+1])[0]}const h={attributeName:u,attributeValuePre:m,attributeValuePost:f,expressionIndex:s};d.push(h),n||r||(t+=" ")}const s=function(e){const t=document.createElement("template");return t.innerHTML=e,t}(t);return{template:s,elementsToBindings:a}}(e))),r=t.cloneNode(!0).content.firstElementChild,i=function(e,t){const n=[];let r;if(1===t.size&&(r=t.get(0)))yn(r,e,n);else{const r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT);let i=e,a=-1;do{const e=t.get(++a);e&&yn(e,i,n)}while(i=r.nextNode())}return n}(r,n);return function(e){return function(e,t){for(const n of t){const{targetNode:t,currentExpression:r,binding:{expressionIndex:i,attributeName:a,attributeValuePre:o,attributeValuePost:s}}=n,c=e[i];if(r!==c)if(n.currentExpression=c,a)t.setAttribute(a,o+un(c)+s);else{let e;Array.isArray(c)?pn(c,n):c instanceof Element?(e=c,t.replaceWith(e)):t.nodeValue=un(c),e&&(n.targetNode=e)}}}(e,i),r}}const bn="function"==typeof queueMicrotask?queueMicrotask:e=>Promise.resolve().then(e);function wn(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1;return!0}const xn=new WeakMap,Tn=[],{assign:kn}=Object;function En(e,t){const n={},r=new AbortController,i=r.signal,{state:a,createEffect:o}=function(e){let t,n=!1;const r=new Map,i=new Set;let a;const o=()=>{if(n)return;const e=[...i];i.clear();try{for(const t of e)t()}finally{a=!1,i.size&&(a=!0,bn(o))}},s=new Proxy({},{get(e,n){if(t){let e=r.get(n);e||(e=new Set,r.set(n,e)),e.add(t)}return e[n]},set(e,t,n){if(e[t]!==n){e[t]=n;const s=r.get(t);if(s){for(const e of s)i.add(e);a||(a=!0,bn(o))}}return!0}});return e.addEventListener("abort",(()=>{n=!0})),{state:s,createEffect:e=>{const n=()=>{const r=t;t=n;try{return e()}finally{t=r}};return n()}}}(i),s=new Map;kn(a,{skinToneEmoji:void 0,i18n:void 0,database:void 0,customEmoji:void 0,customCategorySorting:void 0,emojiVersion:void 0}),kn(a,t),kn(a,{initialLoad:!0,currentEmojis:[],currentEmojisWithCategories:[],rawSearchText:"",searchText:"",searchMode:!1,activeSearchItem:-1,message:void 0,skinTonePickerExpanded:!1,skinTonePickerExpandedAfterAnimation:!1,currentSkinTone:0,activeSkinTone:0,skinToneButtonText:void 0,pickerStyle:void 0,skinToneButtonLabel:"",skinTones:[],currentFavorites:[],defaultFavoriteEmojis:void 0,numColumns:8,isRtl:!1,currentGroupIndex:0,groups:_t,databaseLoaded:!1,activeSearchItemId:void 0}),o((()=>{a.currentGroup!==a.groups[a.currentGroupIndex]&&(a.currentGroup=a.groups[a.currentGroupIndex])}));const c=t=>{e.getElementById(t).focus()},l=t=>e.getElementById(`emo-${t.id}`),d=(e,t)=>{n.rootElement.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))},u=(e,t)=>e.id===t.id,m=(e,t)=>{const{category:n,emojis:r}=e,{category:i,emojis:a}=t;return n===i&&wn(r,a,u)},f=e=>{wn(a.currentEmojis,e,u)||(a.currentEmojis=e)},h=e=>{a.searchMode!==e&&(a.searchMode=e)},g=(e,t)=>t&&e.skins&&e.skins[t]||e.unicode,p={labelWithSkin:(e,t)=>{return(n=[e.name||g(e,t),e.annotation,...e.shortcodes||Tn].filter(Boolean),an(n,(e=>e))).join(", ");var n},titleForEmoji:e=>e.annotation||(e.shortcodes||Tn).join(", "),unicodeWithSkin:g},y={onClickSkinToneButton:function(e){a.skinTonePickerExpanded=!a.skinTonePickerExpanded,a.activeSkinTone=a.currentSkinTone,a.skinTonePickerExpanded&&(nn(e),on((()=>c("skintone-list"))))},onEmojiClick:async function(e){const{target:t}=e;t.classList.contains("emoji")&&(nn(e),S(t.id.substring(4)))},onNavClick:function(e){const{target:t}=e,r=t.closest(".nav-button");if(!r)return;const i=parseInt(r.dataset.groupId,10);n.searchElement.value="",a.rawSearchText="",a.searchText="",a.activeSearchItem=-1,a.currentGroupIndex=a.groups.findIndex((e=>e.id===i))},onNavKeydown:function(e){const{target:t,key:n}=e,r=t=>{t&&(nn(e),t.focus())};switch(n){case"ArrowLeft":return r(t.previousElementSibling);case"ArrowRight":return r(t.nextElementSibling);case"Home":return r(t.parentElement.firstElementChild);case"End":return r(t.parentElement.lastElementChild)}},onSearchKeydown:function(e){if(!a.searchMode||!a.currentEmojis.length)return;const t=t=>{nn(e),a.activeSearchItem=rn(t,a.activeSearchItem,a.currentEmojis)};switch(e.key){case"ArrowDown":return t(!1);case"ArrowUp":return t(!0);case"Enter":if(-1!==a.activeSearchItem)return nn(e),S(a.currentEmojis[a.activeSearchItem].id);a.activeSearchItem=0}},onSkinToneOptionsClick:function(e){const{target:{id:t}}=e,n=t&&t.match(/^skintone-(\d)/);n&&(nn(e),C(parseInt(n[1],10)))},onSkinToneOptionsFocusOut:async function(e){const{relatedTarget:t}=e;t&&"skintone-list"===t.id||(a.skinTonePickerExpanded=!1)},onSkinToneOptionsKeydown:function(e){if(!a.skinTonePickerExpanded)return;const t=async t=>{nn(e),a.activeSkinTone=t};switch(e.key){case"ArrowUp":return t(rn(!0,a.activeSkinTone,a.skinTones));case"ArrowDown":return t(rn(!1,a.activeSkinTone,a.skinTones));case"Home":return t(0);case"End":return t(a.skinTones.length-1);case"Enter":return nn(e),C(a.activeSkinTone);case"Escape":return nn(e),a.skinTonePickerExpanded=!1,c("skintone-button")}},onSkinToneOptionsKeyup:function(e){if(a.skinTonePickerExpanded)return" "===e.key?(nn(e),C(a.activeSkinTone)):void 0},onSearchInput:function(e){a.rawSearchText=e.target.value}},v={calculateEmojiGridStyle:function(e){!function(e,t,n){let r;cn?(r=new ResizeObserver(n),r.observe(e)):on(n),t.addEventListener("abort",(()=>{r&&r.disconnect()}))}(e,i,(()=>{{const e=getComputedStyle(n.rootElement),t=parseInt(e.getPropertyValue("--num-columns"),10),r="rtl"===e.getPropertyValue("direction");a.numColumns=t,a.isRtl=r}}))},updateOnIntersection:function(e){!function(e,t){{const n=e.closest(".tabpanel");let r=xn.get(n);r||(r=new IntersectionObserver((e=>{for(const{target:t,isIntersecting:n}of e)t.classList.toggle("onscreen",n)}),{root:n,rootMargin:"50% 0px 50% 0px",threshold:0}),xn.set(n,r),t.addEventListener("abort",(()=>{r.disconnect()}))),r.observe(e)}}(e,i)}};let b=!0;function w(){const{customEmoji:e,database:t}=a,n=e||Tn;t.customEmoji!==n&&(t.customEmoji=n)}o((()=>{(function(e,t,n,r,i,a,o,s,c){const{labelWithSkin:l,titleForEmoji:d,unicodeWithSkin:u}=n,{html:m,map:f}=function(e){const t=dn(fn,e,(()=>new Map));let n=hn;return{map:function(e,t,r){return e.map(((e,i)=>{const a=n;n=r(e);try{return t(e,i)}finally{n=a}}))},html:function(e,...r){const i=dn(t,e,(()=>new Map));return dn(i,n,(()=>vn(e)))(r)}}}(t);function h(e,n,r){return f(e,((e,i)=>m`<button role="${n?"option":"menuitem"}" aria-selected="${n?i===t.activeSearchItem:""}" aria-label="${l(e,t.currentSkinTone)}" title="${d(e)}" class="${"emoji"+(n&&i===t.activeSearchItem?" active":"")+(e.unicode?"":" custom-emoji")}" id="${`${r}-${e.id}`}" style="${e.unicode?"":`--custom-emoji-background: url(${JSON.stringify(e.url)})`}">${e.unicode?u(e,t.currentSkinTone):""}</button>`),(e=>`${r}-${e.id}`))}const g=m`<section data-ref="rootElement" class="picker" aria-label="${t.i18n.regionLabel}" style="${t.pickerStyle||""}"><div class="pad-top"></div><div class="search-row"><div class="search-wrapper"><input id="search" class="search" type="search" role="combobox" enterkeyhint="search" placeholder="${t.i18n.searchLabel}" autocapitalize="none" autocomplete="off" spellcheck="true" aria-expanded="${!(!t.searchMode||!t.currentEmojis.length)}" aria-controls="search-results" aria-describedby="search-description" aria-autocomplete="list" aria-activedescendant="${t.activeSearchItemId?`emo-${t.activeSearchItemId}`:""}" data-ref="searchElement" data-on-input="onSearchInput" data-on-keydown="onSearchKeydown"><label class="sr-only" for="search">${t.i18n.searchLabel}</label> <span id="search-description" class="sr-only">${t.i18n.searchDescription}</span></div><div class="skintone-button-wrapper ${t.skinTonePickerExpandedAfterAnimation?"expanded":""}"><button id="skintone-button" class="emoji ${t.skinTonePickerExpanded?"hide-focus":""}" aria-label="${t.skinToneButtonLabel}" title="${t.skinToneButtonLabel}" aria-describedby="skintone-description" aria-haspopup="listbox" aria-expanded="${t.skinTonePickerExpanded}" aria-controls="skintone-list" data-on-click="onClickSkinToneButton">${t.skinToneButtonText||""}</button></div><span id="skintone-description" class="sr-only">${t.i18n.skinToneDescription}</span><div data-ref="skinToneDropdown" id="skintone-list" class="skintone-list hide-focus ${t.skinTonePickerExpanded?"":"hidden no-animate"}" style="transform:translateY(${t.skinTonePickerExpanded?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))"})" role="listbox" aria-label="${t.i18n.skinTonesLabel}" aria-activedescendant="skintone-${t.activeSkinTone}" aria-hidden="${!t.skinTonePickerExpanded}" tabIndex="-1" data-on-focusout="onSkinToneOptionsFocusOut" data-on-click="onSkinToneOptionsClick" data-on-keydown="onSkinToneOptionsKeydown" data-on-keyup="onSkinToneOptionsKeyup">${f(t.skinTones,((e,n)=>m`<div id="skintone-${n}" class="emoji ${n===t.activeSkinTone?"active":""}" aria-selected="${n===t.activeSkinTone}" role="option" title="${t.i18n.skinTones[n]}" aria-label="${t.i18n.skinTones[n]}">${e}</div>`),(e=>e))}</div></div><div class="nav" role="tablist" style="grid-template-columns:repeat(${t.groups.length},1fr)" aria-label="${t.i18n.categoriesLabel}" data-on-keydown="onNavKeydown" data-on-click="onNavClick">${f(t.groups,(e=>m`<button role="tab" class="nav-button" aria-controls="tab-${e.id}" aria-label="${t.i18n.categories[e.name]}" aria-selected="${!t.searchMode&&t.currentGroup.id===e.id}" title="${t.i18n.categories[e.name]}" data-group-id="${e.id}"><div class="nav-emoji emoji">${e.emoji}</div></button>`),(e=>e.id))}</div><div class="indicator-wrapper"><div class="indicator" style="transform:translateX(${(t.isRtl?-1:1)*t.currentGroupIndex*100}%)"></div></div><div class="message ${t.message?"":"gone"}" role="alert" aria-live="polite">${t.message||""}</div><div data-ref="tabpanelElement" class="tabpanel ${!t.databaseLoaded||t.message?"gone":""}" role="${t.searchMode?"region":"tabpanel"}" aria-label="${t.searchMode?t.i18n.searchResultsLabel:t.i18n.categories[t.currentGroup.name]}" id="${t.searchMode?"":`tab-${t.currentGroup.id}`}" tabIndex="0" data-on-click="onEmojiClick"><div data-action="calculateEmojiGridStyle">${f(t.currentEmojisWithCategories,((e,n)=>m`<div><div id="menu-label-${n}" class="category ${1===t.currentEmojisWithCategories.length&&""===t.currentEmojisWithCategories[0].category?"gone":""}" aria-hidden="true">${t.searchMode?t.i18n.searchResultsLabel:e.category?e.category:t.currentEmojisWithCategories.length>1?t.i18n.categories.custom:t.i18n.categories[t.currentGroup.name]}</div><div class="emoji-menu ${0===n||t.searchMode||-1!==t.currentGroup.id?"":"visibility-auto"}" style="${`--num-rows: ${Math.ceil(e.emojis.length/t.numColumns)}`}" data-action="updateOnIntersection" role="${t.searchMode?"listbox":"menu"}" aria-labelledby="menu-label-${n}" id="${t.searchMode?"search-results":""}">${h(e.emojis,t.searchMode,"emo")}</div></div>`),(e=>e.category))}</div></div><div class="favorites onscreen emoji-menu ${t.message?"gone":""}" role="menu" aria-label="${t.i18n.favoritesLabel}" data-on-click="onEmojiClick">${h(t.currentFavorites,!1,"fav")}</div><button data-ref="baselineEmoji" aria-hidden="true" tabindex="-1" class="abs-pos hidden emoji baseline-emoji">😀</button></section>`,p=(t,n)=>{for(const r of e.querySelectorAll(`[${t}]`))n(r,r.getAttribute(t))};if(c){e.appendChild(g);for(const e of["click","focusout","input","keydown","keyup"])p(`data-on-${e}`,((t,n)=>{t.addEventListener(e,r[n])}));p("data-ref",((e,t)=>{a[t]=e})),o.addEventListener("abort",(()=>{e.removeChild(g)}))}p("data-action",((e,t)=>{let n=s.get(t);n||s.set(t,n=new WeakSet),n.has(e)||(n.add(e),i[t](e))}))})(e,a,p,y,v,n,i,s,b),b=!1})),a.emojiVersion||en().then((e=>{e||(a.message=a.i18n.emojiUnsupportedMessage)})),o((()=>{a.database&&async function(){let e=!1;const t=setTimeout((()=>{e=!0,a.message=a.i18n.loadingMessage}),1e3);try{await a.database.ready(),a.databaseLoaded=!0}catch(e){console.error(e),a.message=a.i18n.networkErrorMessage}finally{clearTimeout(t),e&&(e=!1,a.message="")}}()})),o((()=>{a.pickerStyle=`\n      --num-groups: ${a.groups.length}; \n      --indicator-opacity: ${a.searchMode?0:1}; \n      --num-skintones: 6;`})),o((()=>{a.customEmoji&&a.database&&w()})),o((()=>{a.customEmoji&&a.customEmoji.length?a.groups!==Yt&&(a.groups=Yt):a.groups!==_t&&(a.currentGroupIndex&&a.currentGroupIndex--,a.groups=_t)})),o((()=>{!async function(){a.databaseLoaded&&(a.currentSkinTone=await a.database.getPreferredSkinTone())}()})),o((()=>{a.skinTones=Array(6).fill().map(((e,t)=>function(e,t){if(0===t)return e;const n=e.indexOf("‍");return-1!==n?e.substring(0,n)+String.fromCodePoint(127995+t-1)+e.substring(n):(e.endsWith("️")&&(e=e.substring(0,e.length-1)),e+"\ud83c"+String.fromCodePoint(57339+t-1))}(a.skinToneEmoji,t)))})),o((()=>{a.skinToneButtonText=a.skinTones[a.currentSkinTone]})),o((()=>{a.skinToneButtonLabel=a.i18n.skinToneLabel.replace("{skinTone}",a.i18n.skinTones[a.currentSkinTone])})),o((()=>{a.databaseLoaded&&async function(){const{database:e}=a,t=(await Promise.all(Gt.map((t=>e.getEmojiByUnicodeOrName(t))))).filter(Boolean);a.defaultFavoriteEmojis=t}()})),o((()=>{a.databaseLoaded&&a.defaultFavoriteEmojis&&async function(){w();const{database:e,defaultFavoriteEmojis:t,numColumns:n}=a,r=await e.getTopFavoriteEmoji(n),i=await E(an([...r,...t],(e=>e.unicode||e.name)).slice(0,n));a.currentFavorites=i}()})),o((()=>{!async function(){const{searchText:e,currentGroup:t,databaseLoaded:n,customEmoji:r}=a;if(n)if(e.length>=2){const t=await async function(e){return E(await k(await a.database.getEmojiBySearchQuery(e)))}(e);a.searchText===e&&(f(t),h(!0))}else{const{id:e}=t;if(-1!==e||r&&r.length){const t=await async function(e){const t=-1===e?a.customEmoji:await a.database.getEmojiByGroup(e);return E(await k(t))}(e);a.currentGroup.id===e&&(f(t),h(!1))}}else a.currentEmojis=[],a.searchMode=!1}()}));const x=()=>{on((()=>{var e;(e=n.tabpanelElement)&&(e.scrollTop=0)}))};function T(e){return!e.unicode||!Vt(e)||tn.get(e.unicode)}async function k(e){const t=a.emojiVersion||await en();return e.filter((({version:e})=>!e||e<=t))}async function E(e){return function(e,t){const n=e=>{const n={};for(const r of e)"number"==typeof r.tone&&r.version<=t&&(n[r.tone]=r.unicode);return n};return e.map((({unicode:e,skins:t,shortcodes:r,url:i,name:a,category:o,annotation:s})=>({unicode:e,name:a,shortcodes:r,url:i,category:o,annotation:s,id:e||a,skins:t&&n(t)})))}(e,a.emojiVersion||await en())}async function S(e){const t=await a.database.getEmojiByUnicodeOrName(e),n=[...a.currentEmojis,...a.currentFavorites].find((t=>t.id===e)),r=n.unicode&&g(n,a.currentSkinTone);await a.database.incrementFavoriteEmojiCount(e),d("emoji-click",{emoji:t,skinTone:a.currentSkinTone,...r&&{unicode:r},...n.name&&{name:n.name}})}function C(e){a.currentSkinTone=e,a.skinTonePickerExpanded=!1,c("skintone-button"),d("skin-tone-change",{skinTone:e}),a.database.setPreferredSkinTone(e)}return o((()=>{const{currentEmojis:e,emojiVersion:t}=a,r=e.filter((e=>e.unicode)).filter((e=>Vt(e)&&!tn.has(e.unicode)));if(!t&&r.length)f(e),on((()=>function(e){const t=function(e,t,n){let r=!0;for(const i of e){const e=ln(n(i));void 0===sn&&(sn=ln(t));const a=e/1.8<sn;tn.set(i.unicode,a),a||(r=!1)}return r}(e,n.baselineEmoji,l);t?x():a.currentEmojis=[...a.currentEmojis]}(r)));else{const n=t?e:e.filter(T);f(n),x()}})),o((()=>{})),o((()=>{var e;e=function(){const{searchMode:e,currentEmojis:t}=a;if(e)return[{category:"",emojis:t}];const n=new Map;for(const e of t){const t=e.category||"";let r=n.get(t);r||(r=[],n.set(t,r)),r.push(e)}return[...n.entries()].map((([e,t])=>({category:e,emojis:t}))).sort(((e,t)=>a.customCategorySorting(e.category,t.category)))}(),wn(a.currentEmojisWithCategories,e,m)||(a.currentEmojisWithCategories=e)})),o((()=>{a.activeSearchItemId=-1!==a.activeSearchItem&&a.currentEmojis[a.activeSearchItem].id})),o((()=>{const{rawSearchText:e}=a;Ut((()=>{a.searchText=(e||"").trim(),a.activeSearchItem=-1}))})),o((()=>{a.skinTonePickerExpanded?n.skinToneDropdown.addEventListener("transitionend",(()=>{a.skinTonePickerExpandedAfterAnimation=!0}),{once:!0}):a.skinTonePickerExpandedAfterAnimation=!1})),{$set(e){kn(a,e)},$destroy(){r.abort()}}}var Sn={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading…",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const Cn=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji","emojiVersion"],An=`:host{--emoji-font-family:${Kt}}`;class $n extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"});const t=document.createElement("style");t.textContent=':host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--border-radius:0;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){color-scheme:light;--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);border-radius:var(--border-radius);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;scrollbar-gutter:stable;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.emoji-menu.visibility-auto{content-visibility:auto;contain-intrinsic-size:calc(var(--num-columns)*var(--total-emoji-size)) calc(var(--num-rows)*var(--total-emoji-size))}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;height:var(--total-emoji-size);width:var(--total-emoji-size);line-height:1;overflow:hidden;font-family:var(--emoji-font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.onscreen .custom-emoji::after{content:"";width:var(--emoji-size);height:var(--emoji-size);background-repeat:no-repeat;background-position:center center;background-size:contain;background-image:var(--custom-emoji-background)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{overflow-y:auto;scrollbar-gutter:stable;display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}'+An,this.shadowRoot.appendChild(t),this._ctx={locale:"en",dataSource:"https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",skinToneEmoji:"🖐️",customCategorySorting:Jt,customEmoji:null,i18n:Sn,emojiVersion:null,...e};for(const e of Cn)"database"!==e&&Object.prototype.hasOwnProperty.call(this,e)&&(this._ctx[e]=this[e],delete this[e]);this._dbFlush()}connectedCallback(){this._cmp||(this._cmp=En(this.shadowRoot,this._ctx))}disconnectedCallback(){bn((()=>{if(!this.isConnected&&this._cmp){this._cmp.$destroy(),this._cmp=void 0;const{database:e}=this._ctx;e.close().catch((e=>console.error(e)))}}))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji","emoji-version"]}attributeChangedCallback(e,t,n){this._set(e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase())),"emoji-version"===e?parseFloat(n):n)}_set(e,t){this._ctx[e]=t,this._cmp&&this._cmp.$set({[e]:t}),["locale","dataSource"].includes(e)&&this._dbFlush()}_dbCreate(){const{locale:e,dataSource:t,database:n}=this._ctx;n&&n.locale===e&&n.dataSource===t||this._set("database",new Ft({locale:e,dataSource:t}))}_dbFlush(){bn((()=>this._dbCreate()))}}const Ln={};for(const e of Cn)Ln[e]={get(){return"database"===e&&this._dbCreate(),this._ctx[e]},set(t){if("database"===e)throw new Error("database is read-only");this._set(e,t)}};function jn(e){return function(e){if(Array.isArray(e))return Dn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Mn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mn(e,t){if(e){if("string"==typeof e)return Dn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dn(e,t):void 0}}function Dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperties($n.prototype,Ln),customElements.get("emoji-picker")||customElements.define("emoji-picker",$n);var In="light";browser.storage.local.get(["sidebarCollapsed","theme"],(function(e){try{var t=document.getElementById("sidebar");t.classList.add("no-transition"),e.sidebarCollapsed&&t.classList.add("collapsed"),e.theme&&(In=e.theme,document.body.className=e.theme),setTimeout((function(){t.classList.remove("no-transition")}),100)}catch(e){console.error("Error updating sidebar:",e)}}));var Pn={isScrolling:!1,scrollX:0,scrollY:0,animationFrameId:null},Rn=document.querySelector(".settings-button"),On=document.getElementById("columns-container"),Nn=["tab-default","tab-pink","tab-yellow","tab-blue","tab-purple"],zn=null,Bn=null,Wn=null,qn=null,Fn=null,Yn=null,_n=null,Un=null,Vn=null,Hn=[],Gn=function(){var e=[127823,127871],t=Math.floor(Math.random()*(e[1]-e[0]+1))+e[0];return String.fromCodePoint(t)};function Kn(){[_n,Un,Yn,Vn].forEach((function(e){e&&e.remove()})),_n=Un=Yn=Vn=null}document.getElementById("add-column").addEventListener("click",(function(){Tr(),or()})),function(){(Wn=document.createElement("div")).id="deletion-area";var e=document.createElement("div");e.innerHTML='\n    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="40" height="40" class="main-grid-item-icon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">\n      <polyline points="3 6 5 6 21 6" />\n      <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />\n      <line x1="10" x2="10" y1="11" y2="17" />\n      <line x1="14" x2="14" y1="11" y2="17" />\n    </svg>',e.alt="Delete Icon",e.classList.add("delete-icon"),Wn.appendChild(e),Wn.addEventListener("dragover",hr),Wn.addEventListener("drop",gr),Wn.addEventListener("dragleave",(function(e){Wn.contains(e.relatedTarget)||Wn.classList.remove("deletion-area-active")})),document.body.appendChild(Wn)}();var Jn,Zn=(Jn=navigator.userAgent.toLowerCase()).indexOf("firefox")>-1?"firefox":Jn.indexOf("safari")>-1?"safari":"chrome";function Xn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)||(e=[e]),browser.storage.local.get("savedTabs",(function(r){var i=r.savedTabs||[];e.forEach((function(e){var t=i.findIndex((function(t){return t.id===e}));-1!==t&&i.splice(t,1)})),t?t.remove():n&&n.remove(),browser.storage.local.set({savedTabs:i,columnState:or(!0)},(function(){}))}))}function Qn(e){var t=document.getElementById(e),n=Array.from(t.querySelectorAll(".subgroup-favicon")).map((function(e){return parseInt(e.id.split("-")[1])}));t.remove(),Xn(n)}function er(e){var t=Array.isArray(e)?e:[e],n=[];t.forEach((function(e){var r=parseInt(e.replace("tab-",""));browser.tabs.get(r,(function(e){var i={title:e.title,url:e.url,favIconUrl:e.favIconUrl||yr(e.url),id:r,color:"#FFFFFF"};n.push(i),n.length===t.length&&browser.storage.local.get("savedTabs",(function(e){var r=e.savedTabs||[],i=[].concat(jn(r),n);browser.storage.local.set({savedTabs:i,columnState:or(!0)},(function(){browser.tabs.query({active:!0,currentWindow:!0},(function(e){var n=e[0];browser.tabs.remove(t.map((function(e){return parseInt(e.replace("tab-",""))})),(function(){browser.tabs.update(n.id,{active:!0})}))}))}))}))}))}))}function tr(e,t){var n=document.createElement("div");n.className="options-menu",e.forEach((function(e){if(!e.hidden){var t=document.createElement("button");t.classList.add("menu-option"),t.innerHTML="\n            <span>".concat(e.text,"</span>\n        "),t.addEventListener("click",(function(t){t.stopPropagation(),e.action(t),n.style.display="none"})),n.appendChild(t)}}));var r=t.getBoundingClientRect();return n.style.position="fixed",n.style.top="".concat(r.bottom+5,"px"),n.style.right="".concat(window.innerWidth-r.right,"px"),document.body.appendChild(n),n}function nr(e,t){t.removeEventListener("dragstart",lr);var n=t.querySelector("#note-display-".concat(e.id)),r=t.querySelector("#note-input-".concat(e.id)),i=t.closest(".column");t.draggable=!1,i.draggable=!1,r.classList.remove("hidden"),n.classList.add("hidden"),r.focus(),r.style.height="auto",r.style.height=r.scrollHeight+"px";var a=r.value.length;r.setSelectionRange(a,a)}function rr(e){if(!e)return{formattedDate:"",dateDisplayColor:"#e63c30"};var t=function(e){var t=new Date;t.setHours(0,0,0,0);var n=new Date(e);n.setHours(0,0,0,0);var r=n.getTime()-t.getTime();return Math.floor(r/864e5)}(e=new Date(e)),n="",r="#ababab";if(0===t)n="Today",r="#058527";else if(1===t)n="Tomorrow",r="#C76E00";else if(t>=2&&t<=7)n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()];else{var i=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),o=String(e.getFullYear()).slice(-2);n="".concat(i,"/").concat(a,"/").concat(o)}return t<0&&(r="#e63c30"),{formattedDate:n,dateDisplayColor:r}}function ir(e){Kn();var t=e;e instanceof Event&&(t=e.target.closest(".column"));var n=t.querySelectorAll(".tab-item");Xn(Array.from(n).map((function(e){return e.id})).map((function(e){return parseInt(e.replace("tab-",""))})),t)}function ar(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(Kn(),n)t=Array.from(e.querySelectorAll("#".concat(n[0]," .subgroup-favicon"))).map((function(e){return e.dataset.url}));else{var r=e.querySelectorAll(".tab-item:not(.subgroup-item .tab-item)");t=Array.from(r).flatMap((function(e){if(e.classList.contains("subgroup-item")){var t=e.querySelectorAll(".subgroup-favicon");return Array.from(t).map((function(e){return e.dataset.url}))}return e.dataset.url}))}if("chrome"!==Zn)t.forEach((function(e){browser.tabs.create({url:e,active:!1})}));else{var i=t.map((function(e){return new Promise((function(t){browser.tabs.create({url:e,active:!1},t)}))}));Promise.all(i).then((function(t){var r=t.map((function(e){return e.id}));browser.tabs.group({tabIds:r},(function(t){var r;r=n?n[n.length-2]:e.querySelector(".column-title-text").textContent,browser.tabGroups.update(t,{title:r})}))}))}}function or(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=On.querySelectorAll(".column"),n=[];if(t.forEach((function(e){var t=e.id,r=Array.from(e.querySelectorAll(".tab-item")).filter((function(e){return e.classList.contains("tab-item")&&!e.closest(".expanded-tabs")})),i=Array.from(r).map((function(e){if(e.classList.contains("subgroup-item")){var t=e.querySelector(".expanded-tabs"),n=Array.from(t.querySelectorAll("li")),r=[e.id].concat(jn(n.map((function(e){return e.id}))),[e.querySelector(".subgroup-title-text").textContent,e.querySelector(".expand-button").classList.contains("expanded")]);return r.length>3?r:null}return e.id})).filter((function(e){return null!==e}));n.push({id:t,tabIds:i,title:e.querySelector(".column-title-text").textContent,minimized:e.classList.contains("minimized"),emoji:e.dataset.emoji})})),e)return n;browser.storage.local.set({columnState:n},(function(){}))}function sr(e){var t=e.querySelector(".column-title-text"),n=e.querySelector(".column-title-input"),r=e.querySelector(".maximize-column"),i=e.querySelector(".minimize-column"),a=e.querySelector(".title-group"),o=e.querySelector(".menu-container"),s=e.querySelector(".more-options"),c=e.querySelector(".header-container");e.classList.add("minimized"),t.classList.add("vertical-text"),n.classList.add("vertical-text"),a.classList.add("vertical"),r.style.display="inline",i.style.display="none",o.classList.add("vertical"),s.classList.add("vertical"),c.classList.add("vertical"),e.querySelectorAll(".tab-item").forEach((function(e){e.style.display="none"}))}function cr(e){var t=e.querySelector(".column-title-text"),n=e.querySelector(".column-title-input"),r=e.querySelector(".title-group"),i=e.querySelector(".maximize-column"),a=e.querySelector(".minimize-column"),o=e.querySelector(".menu-container"),s=e.querySelector(".more-options"),c=e.querySelector(".header-container");e.classList.remove("minimized"),t.classList.remove("vertical-text"),n.classList.remove("vertical-text"),r.classList.remove("vertical"),i.style.display="none",a.style.display="inline",o.classList.remove("vertical"),s.classList.remove("vertical"),c.classList.remove("vertical"),e.querySelectorAll(".tab-item").forEach((function(e){e.style.display="flex"}))}function lr(e){e.stopPropagation(),Kn();var t=e.target.closest(".tab-item");if(t){var n=document.querySelectorAll(".selected");t.classList.contains("selected")&&n.length>1?n.forEach((function(e){return e.classList.add("dragging")})):(n.forEach((function(e){return e.classList.remove("selected")})),t.classList.add("dragging")),e.dataTransfer.setData("text/plain",t.id),e.dataTransfer.setDragImage(t,0,0),Bn="list-item"}}function dr(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t.length;var n=document.querySelector(".dragging");n&&n.classList.contains("subgroup-item")&&(t=t.filter((function(e){return!e.closest(".expanded-tabs")})));for(var r=t.length,i=0;i<t.length;i++){var a=t[i].getBoundingClientRect();if(e.clientY<a.top+a.height/2){r=i;break}}return r}function ur(e){if(Kn(),e.target.closest(".tab-item"))e.preventDefault();else{var t=e.target.closest(".column");t&&(document.querySelectorAll(".selected").forEach((function(e){return e.classList.remove("selected")})),e.dataTransfer.setData("text/plain",t.id),e.dataTransfer.setDragImage(t,0,0),Bn="column",t.classList.add("dragging"))}}function mr(e,t){for(var n=t.length,r=0;r<t.length;r++){var i=t[r].getBoundingClientRect();if(e.clientX<i.left+i.width/2){n=r;break}}return n}function fr(){Pn.isScrolling=!1,Pn.scrollX=0,Pn.scrollY=0,Pn.animationFrameId&&(cancelAnimationFrame(Pn.animationFrameId),Pn.animationFrameId=null)}function hr(e){e.preventDefault(),e.dataTransfer.dropEffect="move";var t=On.getBoundingClientRect();function n(e){if(e<=0)return 0;if(e>=240)return 0;var t=1-e/240;return 15*Math.pow(t,2)}var r,i=n(e.clientX-t.left),a=n(t.right-e.clientX),o=n(e.clientY-t.top),s=n(t.bottom-e.clientY);if(Pn.scrollX=-i+a,Pn.scrollY=-o+s,Pn.isScrolling||0===Pn.scrollX&&0===Pn.scrollY?0===Pn.scrollX&&0===Pn.scrollY&&fr():(Pn.isScrolling=!0,r=On,Pn.animationFrameId=requestAnimationFrame((function e(){Pn.isScrolling&&(0!==Pn.scrollX||0!==Pn.scrollY?(r.scrollBy(Pn.scrollX,Pn.scrollY),Pn.animationFrameId=requestAnimationFrame(e)):fr())}))),Wn.style.display="flex",Wn.contains(e.target))return Wn.classList.add("deletion-area-active"),void(zn.style.display="none");if(qn.contains(e.target))return qn.classList.add("new-column-indicator-active"),void(zn.style.display="none");var c=e.target.closest(".column"),l=e.target.closest("#open-tabs-list"),d=document.getElementById("space-container").getBoundingClientRect(),u=d.left,m=d.right,f=l?sidebar.scrollTop:On.scrollTop;if(!zn){(zn=document.createElement("div")).className="drop-indicator";var h=document.createElement("div");h.className="drop-indicator-container",h.appendChild(zn),document.body.appendChild(h)}if("list-item"===Bn){qn.style.display="flex";var g=document.getElementById("sidebar").getBoundingClientRect(),p=l||c;if(!p)return;var y=p.getBoundingClientRect(),v=Array.from(p.children).filter((function(e){return e.classList.contains("tab-item")&&!e.closest(".expanded-tabs")})),b=c&&c.classList.contains("minimized"),w=dr(e,v,b),x=y.left,T=y.width;if(l)x=g.left,T=g.width;else{if(x<u){var k=u-x;x=u,T-=k}x+T>m&&(T=m-x)}zn.style.width="".concat(T,"px"),zn.style.height="2px",zn.style.left="".concat(x,"px");var E,S=y.top+f,C=l?g:d;if(w===v.length){var A=v[v.length-1];E=b||!A?S:A.getBoundingClientRect().bottom+f}else E=v[w].getBoundingClientRect().top+f;E=Math.max(E,C.top),E=Math.min(E,C.bottom-2),zn.style.top="".concat(E,"px");var $=Array.from(document.querySelectorAll(".dragging")),L=v.find((function(t){if(t.closest("#open-tabs-list")||t.classList.contains("dragging")||t.closest(".expanded-tabs"))return!1;var n=t.closest(".subgroup-item");if(n&&$.some((function(e){return n.contains(e)})))return!1;var r=t.getBoundingClientRect(),i=r.bottom-r.top,a=r.top+i/3,o=r.bottom-i/3,s=r.top+32,c=r.bottom-32;return c-s>o-a?e.clientY>=s&&e.clientY<=c:e.clientY>=a&&e.clientY<=o}));document.querySelectorAll(".tab-item").forEach((function(e){e.classList.remove("targeted")})),L?(L.classList.add("targeted"),zn.style.display="none"):zn.style.display="block";var j=null;if($.length>0){var M=$[0].closest(".subgroup-item");$.every((function(e){return e.closest(".subgroup-item")===M}))&&!$[0].classList.contains("subgroup-item")&&(j=M)}var D=e.target.closest(".subgroup-item");if(j&&D&&D===j){var I,P=Array.from(j.querySelectorAll(".tab-item")).filter((function(e){return e.closest(".expanded-tabs")})),R=dr(e,P,b),O=j.getBoundingClientRect(),N=O.left,z=O.width;if(zn.style.width="".concat(z,"px"),zn.style.height="2px",zn.style.left="".concat(N,"px"),R===P.length){var B=P[R-1];I=B?B.getBoundingClientRect().bottom+f:O.top+f}else I=P[R].getBoundingClientRect().top+f;zn.style.top="".concat(I,"px")}}else if("column"===Bn){qn.style.display="none",zn.style.display="block";var W,q=Array.from(On.querySelectorAll(".column")),F=mr(e,q),Y=t.height;if(W<u&&(W=u),W>m-2&&(W=m-2),F===q.length){var _=q[q.length-1];W=_?_.getBoundingClientRect().right:t.left}else W=q[F].getBoundingClientRect().left;zn.style.width="".concat(2,"px"),zn.style.height="".concat(Y,"px"),zn.style.left="".concat(W,"px"),zn.style.top="".concat(t.top+f,"px")}}function gr(e){e.preventDefault();var t=e.dataTransfer.getData("text/plain"),n=document.getElementById(t);if(n&&n.classList.contains("column")){if(Wn.contains(e.target))return void ir(n);var r=Array.from(On.querySelectorAll(".column")),i=mr(e,r);return i===r.length?On.appendChild(n):On.insertBefore(n,r[i]),On.appendChild(qn),void or()}var a=e.target.closest(".column")||e.target.closest("#open-tabs-list"),o=or(!0),s=a&&a.classList.contains("minimized");if(a||Wn.contains(e.target)||qn.contains(e.target)){var c=t,l=document.querySelector("li#".concat(c));if(l&&l.classList.contains("tab-item")){var d=Array.from(document.querySelectorAll(".dragging")),u=d.length>1?d:[l],m=Array.from(u).map((function(e){return e.id})),f=[],h=[],g=[];if(Wn.contains(e.target)){var p=!1;return u.forEach((function(e){var t=e.id;t.startsWith("tab-")?(f.push(parseInt(t.replace("tab-",""))),e.remove()):t.startsWith("opentab")?(browser.tabs.remove(parseInt(t.replace("opentab-","")),(function(){})),e.remove()):t.startsWith("group")&&(Qn(t),p=!0)})),void(p||Xn(f))}if(qn.contains(e.target)){var y=Tr();return u.forEach((function(e){e.id.startsWith("opentab-")&&h.push(e.id.replace("opentab-","")),y.appendChild(e)})),void(h.length>0?er(h):or())}var v=o.findIndex((function(e){return e.id===a.id})),b=Array.from(a.querySelectorAll(".tab-item")).filter((function(e){return!e.closest(".expanded-tabs")})),w=dr(e,b,s),x=u[0].closest(".subgroup-item"),T=u.every((function(e){return e.closest(".subgroup-item")===x}))?x:null,k=e.target.closest(".subgroup-item");if(k&&T&&k===T){var E=o[v].tabIds,S=k.id,C=E.findIndex((function(e){return Array.isArray(e)&&e[0]===S})),A=Array.from(k.querySelectorAll(".tab-item")).filter((function(e){return e.closest(".expanded-tabs")})),$=dr(e,A,s)+1;if(-1!==C){var L,j=E[C];m.forEach((function(e){var t=j.indexOf(e);-1!==t&&t<$&&$--})),j=j.filter((function(e){return!m.includes(e)})),(L=j).splice.apply(L,[$,0].concat(jn(m))),o[v].tabIds[C]=j,browser.storage.local.set({columnState:o},(function(){}))}}else{var M=b.find((function(t){if(t.closest("#open-tabs-list")||t.classList.contains("dragging")||t.closest(".expanded-tabs"))return!1;var n=t.closest(".subgroup-item");if(n&&d.some((function(e){return n.contains(e)})))return!1;var r=t.getBoundingClientRect(),i=r.bottom-r.top,a=r.top+i/3,o=r.bottom-i/3,s=r.top+32,c=r.bottom-32;return c-s>o-a?e.clientY>=s&&e.clientY<=c:e.clientY>=a&&e.clientY<=o}));if(M){var D=M.id,I=m.slice().map((function(e){return e.replace("opentab-","tab-")})),P=function(){return"group-".concat(Date.now())},R=function(e){e.forEach((function(e){for(var t=0;t<o.length;t++){var n=o[t].tabIds,r=n.findIndex((function(t){return t===e}));if(-1!==r){n.splice(r,1);break}var i=n.findIndex((function(t){return Array.isArray(t)&&t.includes(e)}));if(-1!==i){var a=n[i],s=a.indexOf(e);if(-1!==s){a.splice(s,1),a.length<=3&&n.splice(i,1);break}}}}))};if(-1!==v){var O=o[v].tabIds,N=O.findIndex((function(e){return e===D||Array.isArray(e)&&e[0]===D}));if(-1!==N){for(var z=null,B=-1,W=[],q=0;q<o.length;q++){var F=o[q].tabIds.find((function(e){return Array.isArray(e)&&e[0]===I[0]}));if(F){W=(z=F).slice(1,-2),B=q;break}}var Y=l.classList.contains("subgroup-item");if(Y&&!Array.isArray(O[N])){var _=z[z.length-2],U=z[z.length-1];if(O[N]=[P(),O[N]].concat(jn(W),[_,U]),-1!==B){var V=o[B].tabIds,H=V.findIndex((function(e){return Array.isArray(e)&&e[0]===I[0]}));-1!==H&&V.splice(H,1)}}else if(Y&&Array.isArray(O[N])){var G;if((G=O[N]).splice.apply(G,[O[N].length-2,0].concat(jn(W))),-1!==B){var K=o[B].tabIds,J=K.findIndex((function(e){return Array.isArray(e)&&e[0]===I[0]}));-1!==J&&K.splice(J,1)}}else if(Array.isArray(O[N])){var Z;R(I),N=O.findIndex((function(e){return e===D||Array.isArray(e)&&e[0]===D})),(Z=O[N]).splice.apply(Z,[O[N].length-2,0].concat(jn(I)))}else R(I),N=O.findIndex((function(e){return e===D||Array.isArray(e)&&e[0]===D})),O[N]=[P(),O[N]].concat(jn(I),["New Group",!0])}if(o[v].tabIds=O,m.some((function(e){return e.startsWith("opentab-")}))){var X=[];m.filter((function(e){return e.startsWith("opentab-")})).forEach((function(e){var t=e;e=e.replace("opentab-","tab-");var n=parseInt(e.replace("tab-",""));browser.tabs.get(n,(function(e){if(t.startsWith("opentab-")){var r={title:e.title,url:e.url,favIconUrl:e.favIconUrl||yr(e.url),id:n,color:"#FFFFFF"};X.push(r)}}))})),browser.storage.local.get("savedTabs",(function(e){var t=e.savedTabs||[];X=t.concat(X),browser.tabs.query({active:!0,currentWindow:!0},(function(e){var t=e[0];I.forEach((function(e){var n=parseInt(e.replace("tab-",""));browser.tabs.remove(n,(function(){browser.tabs.update(t.id,{active:!0})}))})),browser.storage.local.set({columnState:o,savedTabs:X},(function(){}))}))}))}else browser.storage.local.set({columnState:o},(function(){}))}}else{var Q=!1,ee=document.getElementById("sidebar").classList.contains("collapsed");u.forEach((function(e){var t=a.id,n=e.id;if("open-tabs-list"!==t&&n.startsWith("opentab"))n=n.replace("opentab-","tab-"),e.id=n,h.push(n);else if("open-tabs-list"===t&&n.startsWith("tab"))console.log("HI"),browser.tabs.create({url:e.dataset.url,active:!1}),f.push(parseInt(n.replace("tab-",""))),ee&&e.classList.add("collapsed");else if("open-tabs-list"===t&&n.startsWith("group")){var r=o.find((function(e){return e.tabIds.some((function(e){return Array.isArray(e)&&e[0]===n}))}));if(r){var i=document.getElementById(r.id),s=r.tabIds.find((function(e){return Array.isArray(e)&&e[0]===n}));if(s)return ar(i,s),Qn(n),void(Q=!0)}}g.push({item:e,dropPosition:w}),"open-tabs-list"===t&&n.startsWith("opentab")&&browser.tabs.move(parseInt(n.split("-")[1]),{index:w},(function(){}))})),Q||(g.forEach((function(e){var t=e.item,n=e.dropPosition;n===b.length?a.appendChild(t):a.insertBefore(t,b[n])})),h.length>0&&er(h),f.length>0&&Xn(f),0===h.length&&0===f.length&&or(),s&&a.querySelectorAll(".tab-item").forEach((function(e){e.style.display="none"})))}}}}}function pr(e){var t;fr(),document.querySelectorAll(".tab-item.dragging").forEach((function(e){e.classList.remove("dragging")})),null===(t=e.target.closest(".column"))||void 0===t||t.classList.remove("dragging"),Wn&&(Wn.style.display="none",Wn.classList.remove("deletion-area-active")),qn&&(qn.style.display="none",qn.classList.remove("new-column-indicator-active")),zn&&(zn.style.display="none"),document.querySelectorAll(".tab-item").forEach((function(e){e.style.outline="none"}))}function yr(e){try{var t=new URL(e);return"https://www.google.com/s2/favicons?domain=".concat(t.hostname,"&sz=32")}catch(t){return console.error("Invalid favicon URL:",e,t),""}}function vr(e){var t=e.classList.toggle("expanded"),n=e.closest(".tab-group-container").querySelector(".favicons-container"),r=e.closest(".tab-group-container").querySelector(".expanded-tabs");return e.innerHTML=t?'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-up"><path d="m18 15-6-6-6 6"/></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg>',t?(n.style.display="none",r.style.display="flex"):(n.style.display="flex",r.style.display="none"),t}function br(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.id,r=t.isSubgroup,i=void 0!==r&&r,a=t.classes,o=void 0===a?[]:a,s=document.createElement("li");return(e=s.classList).add.apply(e,["tab-item"].concat(jn(o))),i&&s.classList.add("subgroup-item"),s.draggable=!0,s.id=n,s.addEventListener("dragstart",lr),s.addEventListener("dragend",pr),s}function wr(e){switch(e){case"#FFFFFF":default:return"tab-default";case"#ffc4c4":case"#f7c2d6":return"tab-pink";case"#fffdc4":case"#f9ffc4":return"tab-yellow";case"#b0e5ff":case"#c6e2e9":return"tab-blue";case"#ebc4ff":case"#e9c8fa":return"tab-purple"}}function xr(e){var t=br({id:"tab-".concat(e.id)});t.dataset.url=e.url;var n=e.color;Nn.includes(n)||(n=wr(e.color)),t.classList.add(n);var r=rr(e.parsedDate),i=r.formattedDate,a=r.dateDisplayColor;t.innerHTML+='\n        <div class="tab-info-container">\n            <div class="tab-info-left">\n                <img src="'.concat(e.favIconUrl,'" draggable="false">\n            </div>\n            <div class="tab-info-right">\n                <span class="tab-title" data-url="').concat(e.url,'" id="title-display-').concat(e.id,'">').concat(e.title,'</span>\n                <input type="text" class="hidden" id="title-input-').concat(e.id,'" value="').concat(e.title,'">\n                <div class="note-display fixed-width" id="note-display-').concat(e.id,'">').concat(e.note?e.note.replace(/\\/g,"").replace(/\n/g,"<br>"):"",'</div>\n                <textarea class="tab-note hidden" id="note-input-').concat(e.id,'">').concat(e.note?e.note.replace(/<br>/g,"\n"):"",'</textarea>\n                <div class="date-display ').concat(i?"":"hidden",'" id="date-display-').concat(e.id,'">').concat(i||"",'</div>\n            </div>\n            <div class="tab-actions">\n                <button class="more-options" data-index="').concat(e.id,'">\n                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" class="main-grid-item-icon" fill="currentColor" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">\n                      <circle cx="12" cy="12" r="1" />\n                      <circle cx="12" cy="5" r="1" />\n                      <circle cx="12" cy="19" r="1" />\n                    </svg>                \n                </button>\n            </div>\n        </div>\n    ');var o=t.querySelector("#date-display-".concat(e.id));o.style.backgroundColor=a,t.querySelector(".tab-info-left").addEventListener("click",(function(e){return Er(t,e)}));var s=t.querySelector(".tab-title");s.addEventListener("click",(function(){window.location.href=s.dataset.url}));var c=t.querySelector(".more-options");c.addEventListener("click",(function(n){if(n.stopPropagation(),document.querySelectorAll(".selected").forEach((function(e){e.classList.remove("selected")})),_n&&_n.dataset.tabId===e.id.toString())Kn();else{Kn();var r=[{text:"Rename",action:function(){!function(e,t){t.removeEventListener("dragstart",lr),t.draggable=!1;var n=t.closest(".column");n.draggable=!1;var r=t.closest(".subgroup-item");r&&(r.draggable=!1);var i=t.querySelector("#title-display-".concat(e.id)),a=t.querySelector("#title-input-".concat(e.id));a.classList.remove("hidden"),i.classList.add("hidden"),a.focus();var o=a.value.length;a.setSelectionRange(o,o),a.addEventListener("keydown",(function e(t){"Enter"===t.key&&(i.textContent=a.value,a.classList.add("hidden"),i.classList.remove("hidden"),a.removeEventListener("keydown",e))})),a.addEventListener("blur",(function(){var o=a.value;t.draggable=!0,n.draggable=!0,r&&(r.draggable=!0),browser.storage.local.get("savedTabs",(function(n){var r=n.savedTabs||[],s=r.findIndex((function(t){return t.id===e.id}));r[s].title=o,i.textContent=o,a.classList.add("hidden"),i.classList.remove("hidden"),t.addEventListener("dragstart",lr),browser.storage.local.set({savedTabs:r},(function(){}))}))}))}(e,t),Kn()}},{text:e.note&&""!==e.note.trim()?"Edit Note":"Add Note",action:function(){nr(e,t),Kn()}},{text:"Clear Date",action:function(){!function(e,t){e.parsedDate=null,t.textContent="",t.classList.add("hidden"),browser.storage.local.set({savedTabs:Hn},(function(){console.log("Tab date removed:",e.id)}))}(e,o),Kn()},hidden:!i},{text:"Color",action:function(){return function(e,t){if(Un)return Un.remove(),void(Un=null);var n=document.createElement("div");n.classList.add("color-menu"),Nn.forEach((function(t){var r=document.createElement("div");r.classList.add("color-option",t),r.addEventListener("click",(function(){e.color=t,browser.storage.local.set({savedTabs:Hn},(function(){})),Kn()})),n.appendChild(r)})),document.body.appendChild(n);var r=t.getBoundingClientRect();n.style.top="".concat(r.bottom+5,"px"),n.style.right="".concat(window.innerWidth-r.right,"px"),Un=n}(e,c)}},{text:"Delete",action:function(){return Xn(e.id,null,t)}}];(_n=tr(r,c)).dataset.tabId=e.id.toString()}}));var l=t.querySelector("#note-display-".concat(e.id)),d=t.querySelector("#note-input-".concat(e.id));return l.addEventListener("click",(function(){nr(e,t)})),d.addEventListener("blur",(function(){var n=d.value;(function(e,t){browser.storage.local.get("savedTabs",(function(n){var r=n.savedTabs||[],i=r.findIndex((function(t){return t.id===e})),a=function(e){var t=new Qe,n=e.replace(/\\\w+/g,""),r=t.parseDate(n),i=r?t.parse(e)[0].text:"";return{parsedDate:r,remainingNote:r?e.replace(i,"").trim():e,detectedDateText:i}}(t),o=a.parsedDate,s=a.remainingNote;r[i].note=s.replace(/\n/g,"<br>"),o&&(r[i].parsedDate=o.getTime()),browser.storage.local.set({savedTabs:r},(function(){}))}))})(e.id,n),l.innerHTML=n?n.replace(/\\/g,"").replace(/\n/g,"<br>"):"",d.classList.add("hidden"),l.classList.remove("hidden"),t.addEventListener("dragstart",lr)})),d.addEventListener("keydown",(function(e){if("Enter"!==e.key||e.shiftKey){if("Enter"===e.key&&e.shiftKey){var t=d.selectionStart,n=d.selectionEnd;d.value=d.value.substring(0,t)+"\n"+d.value.substring(n),d.selectionStart=d.selectionEnd=t+1,e.preventDefault()}}else d.blur()})),d.addEventListener("input",(function(){d.style.height="auto",d.style.height=d.scrollHeight+"px";var n=d.value,r=t.querySelector("#date-display-".concat(e.id)),o=new Qe,s=n.replace(/\\\w+/g,""),c=o.parseDate(s);if(c){var l=rr(c),u=l.formattedDate,m=l.dateDisplayColor;r.textContent=u,r.classList.remove("hidden"),r.style.backgroundColor=m}else i?(r.textContent=i,r.classList.remove("hidden"),r.style.backgroundColor=a):r.classList.add("hidden")})),t}function Tr(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=document.getElementById("columns-container"),a=document.createElement("div");a.classList.add("column"),n&&a.classList.add("minimized"),a.id=t||"column-".concat(Date.now()),a.draggable=!0,a.addEventListener("dragstart",ur),a.addEventListener("dragend",pr);var o=document.createElement("div");o.classList.add("header-container");var s=document.createElement("button");s.classList.add("minimize-column"),s.title="Minimize Column",s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left-to-line"> <path d="M3 19V5"/><path d="m13 6-6 6 6 6"/><path d="M7 12h14"/></svg>',s.addEventListener("click",(function(){sr(a),browser.storage.local.set({columnState:or(!0),animation:{columnId:a.id,minimized:!0}},(function(){}))}));var c=document.createElement("button");c.classList.add("maximize-column"),c.title="Maximize Column",c.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize-2"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/></svg>',c.addEventListener("click",(function(){cr(a),browser.storage.local.set({columnState:or(!0),animation:{columnId:a.id,minimized:!1}},(function(){}))}));var l=kr({initialText:e,groupClass:"title-group",inputClass:"column-title-input",spanClass:"column-title-text",container:"h2",defaultText:"New Column",onSave:function(e){a.dataset.title=e,or()}}).titleGroup,d=document.createElement("div");d.classList.add("menu-container");var u=document.createElement("button");u.classList.add("more-options"),u.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" class="main-grid-item-icon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><circle cx="12" cy="12" r="1" /><circle cx="12" cy="5" r="1" /><circle cx="12" cy="19" r="1" /></svg>',d.appendChild(u),u.addEventListener("click",(function(e){e.stopPropagation(),document.querySelectorAll(".selected").forEach((function(e){e.classList.remove("selected")})),Yn&&Yn.dataset.columnId===a.id?Kn():(Kn(),(Yn=tr([{text:"Open All",action:function(){return ar(a)}},{text:"Delete Column",action:function(){return ir(a)}}],u)).dataset.columnId=a.id)}));var m=document.createElement("button");m.classList.add("emoji-button"),m.textContent=r||Gn(),a.dataset.emoji=m.textContent;var f=document.createElement("emoji-picker");return f.classList.add("emoji-picker-on-top",In),f.style.display="none",f.addEventListener("emoji-click",(function(e){var t=e.detail.unicode;m.textContent=t,a.dataset.emoji=t,f.style.display="none",or()})),m.addEventListener("click",(function(){if(document.querySelectorAll(".emoji-picker-on-top").forEach((function(e){e!==f&&(e.style.display="none")})),"none"===f.style.display){var e=m.getBoundingClientRect();f.style.top="".concat(e.bottom+4,"px"),f.style.left="".concat(e.left,"px"),f.style.display="block"}else f.style.display="none"})),o.appendChild(s),o.appendChild(c),l.insertBefore(f,l.firstChild),l.insertBefore(m,l.firstChild),o.appendChild(l),o.appendChild(d),a.appendChild(o),i.appendChild(a),a}function kr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.initialText,n=void 0===t?"":t,r=e.groupClass,i=void 0===r?"":r,a=e.inputClass,o=void 0===a?"":a,s=e.spanClass,c=void 0===s?"":s,l=e.onSave,d=void 0===l?function(){}:l,u=e.defaultText,m=void 0===u?"New Title":u,f=e.container,h=void 0===f?"span":f,g=document.createElement("div");g.classList.add(i);var p=document.createElement(h);p.classList.add(c),p.textContent=n||m;var y=document.createElement("input");return y.type="text",y.classList.add(o),y.style.display="none",p.addEventListener("click",(function(){y.value=p.textContent,y.style.display="inline",p.style.display="none",y.focus();var e=y.value.length;y.setSelectionRange(e,e),p.closest(".column").draggable=!1,"subgroup-title-group"===i&&(p.closest(".subgroup-item").draggable=!1)})),y.addEventListener("blur",(function(){y.closest(".column").draggable=!0,"subgroup-title-group"===i&&(p.closest(".subgroup-item").draggable=!0);var e=y.value.trim();p.textContent=e||m,y.style.display="none",p.style.display="inline",d(e)})),y.addEventListener("keydown",(function(e){"Enter"===e.key&&y.blur()})),g.appendChild(y),g.appendChild(p),{titleGroup:g,titleInput:y,titleSpan:p}}function Er(e,t){t.stopPropagation(),Kn();var n=document.querySelectorAll(".selected"),r=Array.from(document.querySelectorAll("li")),i=r.indexOf(e);if(t.ctrlKey||t.metaKey)e.classList.toggle("selected");else if(t.shiftKey&&null!==Fn)for(var a=Math.min(Fn,i),o=Math.max(Fn,i),s=a;s<=o;s++)r[s].classList.add("selected");else 1===n.length&&n[0]===e?e.classList.remove("selected"):(n.forEach((function(e){return e.classList.remove("selected")})),e.classList.add("selected"));Fn=i}function Sr(){browser.tabs.query({currentWindow:!0},(function(e){var t=["chrome://","edge://","opera://","vivaldi://","brave://","moz-extension://","about:","file://","safari-web-extension://"];e=e.filter((function(e){return!t.some((function(t){return e.url.startsWith(t)}))&&""!==e.url}));var n=document.getElementById("sidebar").classList.contains("collapsed"),r=["tab-item"];n&&r.push("collapsed");var i=document.getElementById("open-tabs-list");i.addEventListener("dragover",hr),i.addEventListener("drop",gr),i.innerHTML="",e.forEach((function(e,t){var n=br({id:"opentab-".concat(e.id),isSubgroup:!1,classes:r});n.innerHTML+='\n                <div class="tab-info-container">\n                    <div class="tab-info-left">\n                        <img src="'.concat(e.favIconUrl||yr(e.url),'">\n                    </div>\n                    <div class="tab-info-right">\n                        <span class="tab-title">').concat(e.title,'</span>\n                    </div>\n                    <div class="tab-actions">\n                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" class="close-button" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">\n                            <line x1="18" x2="6" y1="6" y2="18" />\n                            <line x1="6" x2="18" y1="6" y2="18" />\n                        </svg>\n                    </div>\n                </div>\n            '),n.querySelector(".close-button").addEventListener("click",(function(){browser.tabs.query({active:!0,currentWindow:!0},(function(t){var n=t[0];browser.tabs.remove(e.id,(function(){browser.tabs.update(n.id,{active:!0})}))}))})),n.setAttribute("data-tab-id",e.id),n.setAttribute("data-index",t),n.querySelector(".tab-info-left").addEventListener("click",(function(e){return Er(n,e)})),n.querySelector(".tab-title").addEventListener("click",(function(){document.querySelectorAll("li").forEach((function(e){return e.classList.remove("selected")})),browser.tabs.update(e.id,{active:!0})})),i.appendChild(n)}))}))}browser.tabs.onUpdated.addListener(Sr),browser.tabs.onRemoved.addListener((function(){"firefox"===Zn?setTimeout(Sr,150):Sr()})),browser.tabs.onMoved.addListener(Sr),browser.storage.onChanged.addListener((function(e,t){if("safari"===Zn||"local"===t)if(e.savedTabs||e.columnState){if(console.log("Changes detected",e),e.savedTabs&&(Hn=e.savedTabs.newValue.filter((function(e){return!("temp"in e)}))),e.columnState&&e.animation){var n=document.getElementById(e.animation.newValue.columnId);return void(!0===e.animation.newValue.minimized?sr(n):cr(n))}!function(e){var t=document.getElementById("columns-container"),n=document.getElementById("main-content");n.addEventListener("dragover",hr),n.addEventListener("drop",gr),t.innerHTML="",browser.storage.local.get("columnState",(function(n){(n.columnState||[]).forEach((function(t){var n=Tr(t.title,t.id,t.minimized,t.emoji);t.tabIds.forEach((function(t){if(Array.isArray(t)){var r=br({id:t[0],isSubgroup:!0}),i=document.createElement("div");i.classList.add("tab-group-container");var a=document.createElement("div");a.classList.add("tab-info-container");var o=document.createElement("div");o.classList.add("favicons-container");var s=document.createElement("div");s.classList.add("expanded-tabs"),s.style.display="none";var c=kr({initialText:t[t.length-2],groupClass:"subgroup-title-group",inputClass:"subgroup-title",spanClass:"subgroup-title-text",defaultText:"New Group",onSave:function(){return or()}}).titleGroup;i.appendChild(c);var l=document.createElement("div");l.classList.add("subgroup-tab-actions");var d=document.createElement("button");d.classList.add("expand-button"),d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg>',l.appendChild(d),t.forEach((function(n,r){if(0!==r&&r!==t.length-2&&r!==t.length-1){var i=e.find((function(e){return"".concat(e.id)===n.split("-")[1]}));if(i){var a=document.createElement("div");a.classList.add("favicon-wrapper");var s=i.color;Nn.includes(s)||(s=wr(i.color)),a.classList.add(s);var c=document.createElement("img");c.src=i.favIconUrl,c.id="tab-".concat(i.id),c.classList.add("subgroup-favicon"),c.dataset.url=i.url,c.draggable=!1;var l=document.createElement("div");l.classList.add("favicon-title"),l.textContent=i.title,l.title=i.title,a.appendChild(c),a.appendChild(l),a.addEventListener("click",(function(){window.location.href=i.url})),o.appendChild(a)}}})),o.querySelectorAll(".favicon-wrapper").forEach((function(t){var n=t.querySelector(".subgroup-favicon"),r=parseInt(n.id.split("-")[1]),i=xr(e.find((function(e){return e.id===r})));s.appendChild(i)}));var u=document.createElement("button");return u.classList.add("more-options"),u.innerHTML='\n                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" class="main-grid-item-icon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">\n                        <circle cx="12" cy="12" r="1" />\n                        <circle cx="12" cy="5" r="1" />\n                        <circle cx="12" cy="19" r="1" />\n                      </svg>\n                    ',l.appendChild(u),u.addEventListener("click",(function(e){e.stopPropagation(),document.querySelectorAll(".selected").forEach((function(e){e.classList.remove("selected")})),_n&&_n.dataset.tabId===t[0]?Kn():(Kn(),(_n=tr([{text:"Open All",action:function(){ar(n,t),Kn()}},{text:"Ungroup",action:function(){var e;e=t[0],browser.storage.local.get(["columnState","savedTabs"],(function(t){var n,r=t.columnState||[],i=t.savedTabs||[],a=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Mn(e))){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,o=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(o)throw i}}}}(r);try{for(a.s();!(n=a.n()).done;){var o=n.value.tabIds,s=o.findIndex((function(t){return Array.isArray(t)&&t[0]===e}));if(-1!==s){var c=o[s];o.splice(s,1);var l=c.slice(1,-2);o.splice.apply(o,[s,0].concat(jn(l))),browser.storage.local.set({columnState:r,savedTabs:i},(function(){console.log("Subgroup ungrouped:",e)}));break}}}catch(e){a.e(e)}finally{a.f()}})),Kn()}},{text:"Delete",action:function(){Qn(t[0]),Kn()}}],u)).dataset.tabId=t[0])})),c.appendChild(l),a.appendChild(o),a.appendChild(s),i.appendChild(a),r.appendChild(i),n.appendChild(r),d.addEventListener("click",(function(){vr(d),or()})),void(t[t.length-1]&&vr(d))}var m=e.find((function(e){return"".concat(e.id)===t.split("-")[1]}));if(m){var f=xr(m);n.appendChild(f)}})),t.minimized&&sr(n)})),(qn=document.createElement("div")).classList.add("new-column-indicator");var r=document.createElement("div");r.innerHTML='\n            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="40" height="40" class="main-grid-item-icon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">\n            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" />\n            <line x1="12" x2="12" y1="11" y2="17" />\n            <line x1="9" x2="15" y1="14" y2="14" />\n            </svg>\n        ',r.classList.add("new-column-icon"),qn.appendChild(r),qn.addEventListener("dragleave",(function(e){qn.contains(e.relatedTarget)||qn.classList.remove("new-column-indicator-active")})),t.appendChild(qn)}))}(Hn)}else if(e.bgTabs){var r=e.bgTabs.oldValue||[],i=e.bgTabs.newValue||[];JSON.stringify(r)!==JSON.stringify(i)&&browser.storage.local.get(["columnState","bgTabs","savedTabs"],(function(e){var t=e.columnState||[],n=e.bgTabs||[],r=e.savedTabs||[],i=n.map((function(e){return e.id}));0===t.length&&t.push({id:"defaultColumn",tabIds:[],title:"New Column"});var a=t[0],o=i.map((function(e){return"tab-".concat(e)}));a.tabIds=a.tabIds.concat(o),r=r.concat(n),browser.storage.local.set({columnState:t,bgTabs:[],savedTabs:r},(function(){console.log("Migrated bgTabs")}))}))}else e.sidebarCollapsed&&(e.sidebarCollapsed.newValue?document.getElementById("sidebar").classList.add("collapsed"):document.getElementById("sidebar").classList.remove("collapsed"))})),Sr(),browser.storage.local.get(["columnState","bgTabs","savedTabs"],(function(e){var t=e.columnState||[],n=e.bgTabs||[],r=e.savedTabs||[];if(n.length>0){var i=n.map((function(e){return e.id}));0===t.length&&t.push({id:"defaultColumn",tabIds:[],title:"New Column",emoji:Gn()});var a=t[0],o=i.map((function(e){return"tab-".concat(e)}));a.tabIds=a.tabIds.concat(o),r=r.concat(n)}(r=r.filter((function(e){return!("temp"in e)}))).push({temp:Date.now()}),browser.storage.local.set({columnState:t,bgTabs:[],savedTabs:r},(function(){}))})),document.querySelector(".minimize-sidebar").addEventListener("click",(function(){browser.storage.local.set({sidebarCollapsed:!0},(function(){document.querySelectorAll("#open-tabs-list .tab-item").forEach((function(e){e.classList.add("collapsed")}))}))})),document.querySelector(".maximize-sidebar").addEventListener("click",(function(){browser.storage.local.set({sidebarCollapsed:!1},(function(){document.querySelectorAll("#open-tabs-list .tab-item").forEach((function(e){e.classList.remove("collapsed")}))}))})),document.addEventListener("dragover",(function(e){e.preventDefault()})),document.addEventListener("click",(function(e){var t=null!==e.target.closest(".more-options, .menu-option, .settings-button"),n=Array.from(document.querySelectorAll("li")).filter((function(e){return!e.classList.contains("subgroup-item")})),r=n.some((function(t){return t.contains(e.target)}));t||Kn(),r||n.forEach((function(e){return e.classList.remove("selected")}));var i=document.querySelectorAll("emoji-picker"),a=document.querySelectorAll(".emoji-button");Array.from(a).some((function(t){return t.contains(e.target)}))||Array.from(i).some((function(t){return t.contains(e.target)}))||i.forEach((function(e){return e.style.display="none"}))})),browser.storage.local.get(["release","whatsNewClicked"],(function(e){var t=browser.runtime.getManifest().version,n=e.release,r=e.whatsNewClicked||!1;if(n!==t){var i=document.createElement("div");i.classList.add("notification-circle"),Rn.appendChild(i),r=!1,browser.storage.local.set({whatsNewClicked:!1})}Rn.addEventListener("click",(function(){if(Vn)Kn();else{Kn();var e=document.querySelector(".notification-circle:not(.inline-notification)");e&&(e.remove(),browser.storage.local.set({release:t}));var n=document.querySelector(".inline-notification");if(Vn=tr([{text:"dark"===In?"Toggle Light Theme":"Toggle Dark Theme",action:function(){In="light"===In?"dark":"light",document.body.className=In,document.querySelectorAll("emoji-picker").forEach((function(e){e.className=e.className.replace(/light|dark/g,In)})),browser.storage.local.set({theme:In}),Kn()}},{text:"What's New",action:function(){n&&n.remove(),window.open("https://tabsmagic.com/releasenotes","_blank"),Kn(),r=!0,browser.storage.local.set({whatsNewClicked:!0})}},{text:"Feedback",action:function(){window.open("https://tabsmagic.com/contact","_blank"),Kn()}}],Rn),!r){var i=Vn.querySelector("button:nth-child(2)");(n=document.createElement("div")).classList.add("notification-circle","inline-notification"),i.insertBefore(n,i.firstChild)}}}))}))})()})();
//# sourceMappingURL=bundle.js.map